{
  final IncrementalIndex empty=new IncrementalIndex(0,QueryGranularity.NONE,new AggregatorFactory[0]);
  final IndexableAdapter emptyAdapter=new IncrementalIndexAdapter(this.getInterval(),empty);
  final DataSegment segment=DataSegment.builder().dataSource(this.getDataSource()).interval(this.getInterval()).version(context.getVersion()).shardSpec(new NoneShardSpec()).build();
  final File outDir=new File(toolbox.getConfig().getTaskDir(this),segment.getIdentifier());
  final File fileToUpload=IndexMerger.merge(Lists.newArrayList(emptyAdapter),new AggregatorFactory[0],outDir);
  final DataSegment uploadedSegment=toolbox.getSegmentPusher().push(fileToUpload,segment);
  log.info("Uploaded tombstone segment for[%s] interval[%s] with version[%s]",segment.getDataSource(),segment.getInterval(),segment.getVersion());
  return TaskStatus.success(getId(),Lists.newArrayList(uploadedSegment)).withAction(TaskStatus.Action.ANNOUNCE_SEGMENTS);
}
