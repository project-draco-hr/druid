{
  final long startTime=System.currentTimeMillis();
  tq.add(task);
  TaskStatus status;
  try {
    while ((status=tsqa.getSameGroupMergedStatus(task.getId()).get()).isRunnable()) {
      if (System.currentTimeMillis() > startTime + 10 * 1000) {
        throw new ISE("Where did the task go?!: %s",task.getId());
      }
      Thread.sleep(100);
    }
  }
 catch (  Exception e) {
    throw Throwables.propagate(e);
  }
  return status;
}
