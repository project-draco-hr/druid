{
  final TestHllComplexMetricSelector selector=new TestHllComplexMetricSelector();
  final HyperloglogAggregatorFactory aggFactory=new HyperloglogAggregatorFactory("billy","billyG");
  final HyperloglogAggregator agg=new HyperloglogAggregator("billy",selector);
  Assert.assertEquals("billy",agg.getName());
  Assert.assertEquals(0L,aggFactory.finalizeComputation(agg.get()));
  Assert.assertEquals(0L,aggFactory.finalizeComputation(agg.get()));
  Assert.assertEquals(0L,aggFactory.finalizeComputation(agg.get()));
  aggregate(selector,agg);
  aggregate(selector,agg);
  aggregate(selector,agg);
  Assert.assertEquals(3L,aggFactory.finalizeComputation(agg.get()));
  Assert.assertEquals(3L,aggFactory.finalizeComputation(agg.get()));
  Assert.assertEquals(3L,aggFactory.finalizeComputation(agg.get()));
  aggregate(selector,agg);
  aggregate(selector,agg);
  Assert.assertEquals(5L,aggFactory.finalizeComputation(agg.get()));
  Assert.assertEquals(5L,aggFactory.finalizeComputation(agg.get()));
}
