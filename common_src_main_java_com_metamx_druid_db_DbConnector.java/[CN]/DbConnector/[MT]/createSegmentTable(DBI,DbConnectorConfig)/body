{
  try {
    dbi.withHandle(new HandleCallback<Void>(){
      @Override public Void withHandle(      Handle handle) throws Exception {
        List<Map<String,Object>> table=handle.select(String.format("SHOW tables LIKE '%s'",config.getSegmentTable()));
        if (table.isEmpty()) {
          log.info("Creating table[%s]",config.getSegmentTable());
          handle.createStatement(String.format("CREATE table %s (id VARCHAR(255) NOT NULL, dataSource VARCHAR(255) NOT NULL, created_date TINYTEXT NOT NULL, start TINYTEXT NOT NULL, end TINYTEXT NOT NULL, partitioned BOOLEAN NOT NULL, version TINYTEXT NOT NULL, used BOOLEAN NOT NULL, payload LONGTEXT NOT NULL, INDEX(dataSource), INDEX(used), PRIMARY KEY (id))",config.getSegmentTable())).execute();
        }
 else {
          log.info("Table[%s] existed: [%s]",config.getSegmentTable(),table);
        }
        return null;
      }
    }
);
  }
 catch (  Exception e) {
    log.warn(e.toString());
  }
}
