{
  List<Interval> unusedSegmentIntervals=segmentManager.getUnusedSegmentIntervals(dataSource,new Interval(0,System.currentTimeMillis() - retainDuration),limit);
  if (unusedSegmentIntervals != null && unusedSegmentIntervals.size() > 0) {
    long start=Long.MIN_VALUE;
    long end=Long.MAX_VALUE;
    for (    Interval interval : unusedSegmentIntervals) {
      if (start < interval.getStartMillis()) {
        start=interval.getStartMillis();
      }
      if (end > interval.getEndMillis()) {
        end=interval.getEndMillis();
      }
    }
    return new Interval(start,end);
  }
 else {
    return null;
  }
}
