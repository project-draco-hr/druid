{
  metadataSegmentManager.removeSegment(segment.getDataSource(),segment.getIdentifier());
  serverView.registerSegmentCallback(exec,new ServerView.BaseSegmentCallback(){
    @Override public ServerView.CallbackAction segmentRemoved(    DruidServerMetadata server,    DataSegment theSegment){
      if (theSegment.equals(segment)) {
        callback.execute();
      }
      return ServerView.CallbackAction.CONTINUE;
    }
  }
);
}
