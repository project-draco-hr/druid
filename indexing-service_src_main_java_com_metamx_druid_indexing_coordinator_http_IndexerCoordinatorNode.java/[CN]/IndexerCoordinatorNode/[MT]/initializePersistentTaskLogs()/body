{
  if (persistentTaskLogs == null) {
    final TaskLogConfig taskLogConfig=getConfigFactory().build(TaskLogConfig.class);
    if (taskLogConfig.getLogType().equalsIgnoreCase("s3")) {
      initializeS3Service();
      persistentTaskLogs=new S3TaskLogs(null,s3Service);
    }
 else     if (taskLogConfig.getLogType().equalsIgnoreCase("noop")) {
      persistentTaskLogs=new NoopTaskLogs();
    }
 else {
      throw new IAE("Unknown log type %s",taskLogConfig.getLogType());
    }
  }
}
