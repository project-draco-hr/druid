{
  if (taskStorage == null) {
    if (config.getStorageImpl().equals("local")) {
      taskStorage=new HeapMemoryTaskStorage();
    }
 else     if (config.getStorageImpl().equals("db")) {
      final IndexerDbConnectorConfig dbConnectorConfig=getConfigFactory().build(IndexerDbConnectorConfig.class);
      dbi.createTaskTables();
      taskStorage=new DbTaskStorage(getJsonMapper(),null,dbi.getDBI());
    }
 else {
      throw new ISE("Invalid storage implementation: %s",config.getStorageImpl());
    }
  }
}
