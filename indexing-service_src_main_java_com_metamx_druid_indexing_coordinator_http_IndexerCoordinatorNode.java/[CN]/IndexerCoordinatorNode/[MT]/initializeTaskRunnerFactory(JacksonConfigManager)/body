{
  if (taskRunnerFactory == null) {
    if (config.getRunnerImpl().equals("remote")) {
      taskRunnerFactory=new RemoteTaskRunnerFactory(getCuratorFramework(),getConfigFactory().build(RemoteTaskRunnerConfig.class),getZkPaths(),getJsonMapper(),DSuppliers.of(configManager.watch(WorkerSetupData.CONFIG_KEY,WorkerSetupData.class)),httpClient);
    }
 else     if (config.getRunnerImpl().equals("local")) {
      taskRunnerFactory=new ForkingTaskRunnerFactory(getConfigFactory().build(ForkingTaskRunnerConfig.class),getProps(),getJsonMapper(),persistentTaskLogs,null);
    }
 else {
      throw new ISE("Invalid runner implementation: %s",config.getRunnerImpl());
    }
  }
}
