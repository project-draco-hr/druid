{
synchronized (lock) {
    try {
      dbi.withHandle(new HandleCallback<Void>(){
        @Override public Void withHandle(        Handle handle) throws Exception {
          final String version=new DateTime().toString();
          handle.createStatement(String.format("INSERT INTO %s (id, dataSource, version, payload) VALUES (:id, :dataSource, :version, :payload)",getRulesTable())).bind("id",String.format("%s_%s",dataSource,version)).bind("dataSource",dataSource).bind("version",version).bind("payload",jsonMapper.writeValueAsBytes(newRules)).execute();
          return null;
        }
      }
);
    }
 catch (    Exception e) {
      log.error(e,String.format("Exception while overriding rule for %s",dataSource));
      return false;
    }
  }
  return true;
}
