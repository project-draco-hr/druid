{
synchronized (toAnnounce) {
    if (started) {
      return;
    }
    started=true;
    for (    Pair<String,byte[]> pair : toAnnounce) {
      announce(pair.lhs,pair.rhs);
    }
    toAnnounce.clear();
    for (    Pair<String,byte[]> pair : toUpdate) {
      update(pair.lhs,pair.rhs);
    }
    toUpdate.clear();
  }
}
