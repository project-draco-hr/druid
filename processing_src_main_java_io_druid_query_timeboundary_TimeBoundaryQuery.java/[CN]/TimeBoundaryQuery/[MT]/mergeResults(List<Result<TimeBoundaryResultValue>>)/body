{
  if (results == null || results.isEmpty()) {
    return Lists.newArrayList();
  }
  DateTime min=new DateTime(Long.MAX_VALUE);
  DateTime max=new DateTime(Long.MIN_VALUE);
  for (  Result<TimeBoundaryResultValue> result : results) {
    TimeBoundaryResultValue val=result.getValue();
    DateTime currMinTime=val.getMinTime();
    if (currMinTime != null && currMinTime.isBefore(min)) {
      min=currMinTime;
    }
    DateTime currMaxTime=val.getMaxTime();
    if (currMaxTime != null && currMaxTime.isAfter(max)) {
      max=currMaxTime;
    }
  }
  final ImmutableMap.Builder<String,Object> builder=new ImmutableMap.Builder<>();
  final DateTime ts;
  if (bound.equalsIgnoreCase(MIN_TIME)) {
    ts=min;
    builder.put(MIN_TIME,max);
  }
 else   if (bound.equalsIgnoreCase(MAX_TIME)) {
    ts=max;
    builder.put(MAX_TIME,min);
  }
 else {
    ts=min;
    builder.put(MIN_TIME,min);
    builder.put(MAX_TIME,max);
  }
  return Arrays.asList(new Result<>(ts,new TimeBoundaryResultValue(builder.build())));
}
