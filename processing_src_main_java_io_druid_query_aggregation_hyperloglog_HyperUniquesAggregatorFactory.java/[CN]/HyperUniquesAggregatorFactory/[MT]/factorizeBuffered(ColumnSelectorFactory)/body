{
  ObjectColumnSelector selector=metricFactory.makeObjectColumnSelector(fieldName);
  if (selector == null) {
    return new NoopBufferAggregator();
  }
  if (HyperLogLogCollector.class.isAssignableFrom(selector.classOfObject())) {
    return new HyperUniquesBufferAggregator(selector);
  }
  throw new IAE("Incompatible type for metric[%s], expected a HyperUnique, got a %s",fieldName,selector.classOfObject());
}
