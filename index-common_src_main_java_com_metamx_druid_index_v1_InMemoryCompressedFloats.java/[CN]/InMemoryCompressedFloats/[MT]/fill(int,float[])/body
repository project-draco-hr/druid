{
  if (size() - index < toFill.length) {
    throw new IndexOutOfBoundsException(String.format("Cannot fill array of size[%,d] at index[%,d].  Max size[%,d]",toFill.length,index,size()));
  }
  int bufferNum=index / sizePer;
  int bufferIndex=index % sizePer;
  int leftToFill=toFill.length;
  while (leftToFill > 0) {
    if (bufferNum == compressedBuffers.size()) {
      endBuffer.mark();
      endBuffer.position(bufferIndex);
      endBuffer.get(toFill,toFill.length - leftToFill,leftToFill);
      endBuffer.rewind();
      return;
    }
    if (bufferNum != loadBufferIndex) {
      loadBuffer(bufferNum);
    }
    loadBuffer.mark();
    loadBuffer.position(loadBuffer.position() + bufferIndex);
    final int numToGet=Math.min(loadBuffer.remaining(),leftToFill);
    loadBuffer.get(toFill,toFill.length - leftToFill,numToGet);
    loadBuffer.rewind();
    leftToFill-=numToGet;
    ++bufferNum;
    bufferIndex=0;
  }
}
