{
  try {
    log.info("Loading segment %s",segment.getIdentifier());
    if (loadSegment(segment,callback)) {
      try {
        announcer.announceSegment(segment);
      }
 catch (      IOException e) {
        throw new SegmentLoadingException(e,"Failed to announce segment[%s]",segment.getIdentifier());
      }
    }
  }
 catch (  SegmentLoadingException e) {
    log.makeAlert(e,"Failed to load segment for dataSource").addData("segment",segment).emit();
  }
 finally {
    callback.execute();
  }
}
