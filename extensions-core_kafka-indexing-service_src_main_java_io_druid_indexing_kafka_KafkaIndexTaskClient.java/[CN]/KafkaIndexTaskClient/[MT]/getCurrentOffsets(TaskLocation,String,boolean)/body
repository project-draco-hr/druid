{
  try {
    final URI serviceUri=new URI("http",null,location.getHost(),location.getPort(),String.format("%s/%s/%s",BASE_PATH,id,"offsets/current"),null,null);
    final StatusResponseHolder response=submitRequest(new Request(HttpMethod.GET,serviceUri.toURL()),retry);
    return jsonMapper.readValue(response.getContent(),new TypeReference<Map<Integer,Long>>(){
    }
);
  }
 catch (  Exception e) {
    throw Throwables.propagate(e);
  }
}
