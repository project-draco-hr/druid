{
  final File taskWorkDir=config.getTaskWorkDir(task.getId());
  return new TaskToolbox(config,task,taskActionClientFactory,emitter,segmentPusher,dataSegmentKiller,dataSegmentMover,dataSegmentArchiver,segmentAnnouncer,newSegmentServerView,queryRunnerFactoryConglomerate,queryExecutorService,monitorScheduler,segmentLoaderFactory.manufacturate(taskWorkDir),objectMapper,taskWorkDir,indexMerger,indexIO,cache,cacheConfig);
}
