{
  boolean zpathValidateFailed;
  String propertyZpath=props.getProperty("druid.zk.paths.base");
  zpathValidateFailed=zpathBaseCheck(propertyZpath,"property druid.zk.paths.base");
  String zpathEffective=DEFAULT_ZPATH;
  if (propertyZpath != null) {
    zpathEffective=propertyZpath;
  }
  final String propertiesZpathOverride=props.getProperty("druid.zk.paths.propertiesPath");
  if (!zpathValidateFailed)   System.out.println("Effective zpath prefix=" + zpathEffective);
  int zpathOverrideCount=0;
  boolean zpathOverridesNotAbs=false;
  StringBuilder sbErrors=new StringBuilder(100);
  for (int i=0; i < SUB_PATH_PROPS.length; i++) {
    String val=props.getProperty(SUB_PATH_PROPS[i]);
    if (val != null) {
      zpathOverrideCount++;
      if (!val.startsWith("/")) {
        zpathOverridesNotAbs=true;
        sbErrors.append(SUB_PATH_PROPS[i]).append("=").append(val).append("\n");
        zpathValidateFailed=true;
      }
    }
  }
  if (propertiesZpathOverride != null) {
    zpathOverrideCount++;
    if (!propertiesZpathOverride.startsWith("/")) {
      zpathOverridesNotAbs=true;
      sbErrors.append("druid.zk.paths.propertiesPath").append("=").append(propertiesZpathOverride).append("\n");
      zpathValidateFailed=true;
    }
  }
  if (zpathOverridesNotAbs) {
    System.err.println("When overriding zk zpaths, with properties like druid.zk.paths.*Path " + "the znode path must start with '/' (slash) ; problem overrides:");
    System.err.print(sbErrors.toString());
  }
  if (zpathOverrideCount > 0) {
    if (zpathOverrideCount < SUB_PATH_PROPS.length + 1) {
      zpathValidateFailed=true;
      System.err.println("When overriding zk zpaths, with properties of form druid.zk.paths.*Path " + "all must be overridden together; missing overrides:");
      for (int i=0; i < SUB_PATH_PROPS.length; i++) {
        String val=props.getProperty(SUB_PATH_PROPS[i]);
        if (val == null) {
          System.err.println("  " + SUB_PATH_PROPS[i]);
        }
      }
      if (propertiesZpathOverride == null)       System.err.println("  " + "druid.zk.paths.propertiesPath");
    }
 else {
      ;
    }
  }
 else {
    if (propertyZpath == null) {
      props.setProperty("druid.zk.paths.base",zpathEffective);
    }
    for (int i=0; i < SUB_PATH_PROPS.length; i++) {
      props.setProperty(SUB_PATH_PROPS[i],zpathEffective + "/" + SUB_PATHS[i]);
    }
    props.setProperty("druid.zk.paths.propertiesPath",zpathEffective + "/properties");
  }
  return !zpathValidateFailed;
}
