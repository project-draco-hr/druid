{
  final List<Task> retVal=Lists.newArrayList();
  for (  final Interval interval : granularitySpec.bucketIntervals()) {
    if (targetPartitionSize > 0) {
      retVal.add(new IndexDeterminePartitionsTask(null,getGroupId(),interval,firehoseFactory,new Schema(getDataSource(),spatialDimensions,aggregators,indexGranularity,new NoneShardSpec()),targetPartitionSize,rowFlushBoundary));
    }
 else {
      retVal.add(new IndexGeneratorTask(null,getGroupId(),interval,firehoseFactory,new Schema(getDataSource(),spatialDimensions,aggregators,indexGranularity,new NoneShardSpec()),rowFlushBoundary));
    }
  }
  return retVal;
}
