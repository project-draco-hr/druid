{
  this.dataSegmentPuller=dataSegmentPuller;
  this.factory=factory;
  final ImmutableList.Builder<StorageLocation> locBuilder=ImmutableList.builder();
  for (  String dirSpec : config.getLocations().split(",")) {
    String[] dirSplit=dirSpec.split("\\|");
    if (dirSplit.length == 1) {
      locBuilder.add(new StorageLocation(new File(dirSplit[0]),Integer.MAX_VALUE));
    }
 else     if (dirSplit.length == 2) {
      final Long maxSize=Longs.tryParse(dirSplit[1]);
      if (maxSize == null) {
        throw new IAE("Size of a local segment storage location must be an integral number, got[%s]",dirSplit[1]);
      }
      locBuilder.add(new StorageLocation(new File(dirSplit[0]),maxSize));
    }
 else {
      throw new ISE("Unknown segment storage location[%s]=>[%s], config[%s].",dirSplit.length,dirSpec,config.getLocations());
    }
  }
  locations=locBuilder.build();
  Preconditions.checkArgument(locations.size() > 0,"Must have at least one segment cache directory.");
  log.info("Using storage locations[%s]",locations);
}
