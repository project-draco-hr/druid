{
  final CuratorConfig config=configFactory.build(CuratorConfig.class);
  if (serviceDiscovery == null) {
    final CuratorFramework serviceDiscoveryCuratorFramework=Initialization.makeCuratorFramework(config,lifecycle);
    CuratorDiscoveryConfig discoveryConfig=getJsonConfigurator().configurate(getProps(),"druid.discovery.curator",CuratorDiscoveryConfig.class);
    this.serviceDiscovery=Initialization.makeServiceDiscoveryClient(serviceDiscoveryCuratorFramework,discoveryConfig,lifecycle);
  }
  if (serviceAnnouncer == null) {
    this.serviceAnnouncer=new CuratorServiceAnnouncer(serviceDiscovery);
  }
  if (coordinatorServiceProvider == null) {
    this.coordinatorServiceProvider=Initialization.makeServiceProvider(workerConfig.getOverlordService(),serviceDiscovery,lifecycle);
  }
}
