{
  if (taskToolboxFactory == null) {
    final DataSegmentKiller dataSegmentKiller=new S3DataSegmentKiller(s3Service);
    taskToolboxFactory=new TaskToolboxFactory(taskConfig,new RemoteTaskActionClientFactory(httpClient,coordinatorServiceProvider,new RetryPolicyFactory(configFactory.buildWithReplacements(RetryPolicyConfig.class,ImmutableMap.of("base_path","druid.worker.taskActionClient"))),getJsonMapper()),getEmitter(),s3Service,segmentPusher,dataSegmentKiller,getAnnouncer(),getServerView(),getConglomerate(),getQueryExecutorService(),monitorScheduler,getJsonMapper());
  }
}
