{
  if (chatHandlerProvider == null) {
    final ChatHandlerProviderConfig config=configFactory.build(ChatHandlerProviderConfig.class);
    if (config.isPublishDiscovery()) {
      this.chatHandlerProvider=new EventReceivingChatHandlerProvider(config,serviceAnnouncer);
    }
 else {
      log.info("ChatHandlerProvider: Using NoopServiceAnnouncer. Good luck finding your firehoses!");
      this.chatHandlerProvider=new NoopChatHandlerProvider();
    }
  }
}
