{
  if (chatHandlerProvider == null) {
    final ChatHandlerProviderConfig config=configFactory.build(ChatHandlerProviderConfig.class);
    final ServiceAnnouncer myServiceAnnouncer;
    if (config.isPublishDiscovery()) {
      myServiceAnnouncer=serviceAnnouncer;
    }
 else {
      log.info("ChatHandlerProvider: Using NoopServiceAnnouncer. Good luck finding your firehoses!");
      myServiceAnnouncer=new NoopServiceAnnouncer();
    }
    this.chatHandlerProvider=new ChatHandlerProvider(config,myServiceAnnouncer);
  }
}
