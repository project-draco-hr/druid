{
  final Task indexTask=new IndexTask(null,"foo",new UniformGranularitySpec(Granularity.DAY,ImmutableList.of(new Interval("2010-01-01/P1D"))),null,new AggregatorFactory[]{new DoubleSumAggregatorFactory("met","met")},QueryGranularity.NONE,10000,newMockExceptionalFirehoseFactory(),-1);
  final TaskStatus mergedStatus=runTask(indexTask);
  final TaskStatus status=ts.getStatus(indexTask.getId()).get();
  Assert.assertEquals("statusCode",TaskStatus.Status.SUCCESS,status.getStatusCode());
  Assert.assertEquals("merged statusCode",TaskStatus.Status.FAILED,mergedStatus.getStatusCode());
  Assert.assertEquals("num segments published",0,mdc.getPublished().size());
  Assert.assertEquals("num segments nuked",0,mdc.getNuked().size());
}
