{
  verifyState();
  final RejectionPolicy rejectionPolicy=rejectionPolicyFactory.create(windowPeriod);
  log.info("Creating plumber using rejectionPolicy[%s]",rejectionPolicy);
  return new RealtimePlumber(windowPeriod,basePersistDirectory,segmentGranularity,schema,metrics,rejectionPolicy,emitter,conglomerate,segmentAnnouncer,queryExecutorService,versioningPolicy,dataSegmentPusher,segmentPublisher,serverView,maxPendingPersists);
}
