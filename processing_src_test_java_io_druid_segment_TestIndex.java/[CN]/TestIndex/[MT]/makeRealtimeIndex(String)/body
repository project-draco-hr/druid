{
  final URL resource=TestIndex.class.getClassLoader().getResource(resourceFilename);
  log.info("Realtime loading index file[%s]",resource);
  final IncrementalIndex retVal=new IncrementalIndex(new DateTime("2011-01-12T00:00:00.000Z").getMillis(),QueryGranularity.NONE,METRIC_AGGS);
  final AtomicLong startTime=new AtomicLong();
  int lineCount;
  try {
    lineCount=CharStreams.readLines(CharStreams.newReaderSupplier(new InputSupplier<InputStream>(){
      @Override public InputStream getInput() throws IOException {
        return resource.openStream();
      }
    }
,Charsets.UTF_8),new LineProcessor<Integer>(){
      StringInputRowParser parser=new StringInputRowParser(new DelimitedParseSpec(new TimestampSpec("ts","iso"),new DimensionsSpec(Arrays.asList(COLUMNS),Arrays.asList(DIMENSIONS),null),"\t",Arrays.<String>asList()),null,null,null,null);
      boolean runOnce=false;
      int lineCount=0;
      @Override public boolean processLine(      String line) throws IOException {
        if (!runOnce) {
          startTime.set(System.currentTimeMillis());
          runOnce=true;
        }
        retVal.add(parser.parse(line));
        ++lineCount;
        return true;
      }
      @Override public Integer getResult(){
        return lineCount;
      }
    }
);
  }
 catch (  IOException e) {
    realtimeIndex=null;
    throw Throwables.propagate(e);
  }
  log.info("Loaded %,d lines in %,d millis.",lineCount,System.currentTimeMillis() - startTime.get());
  return retVal;
}
