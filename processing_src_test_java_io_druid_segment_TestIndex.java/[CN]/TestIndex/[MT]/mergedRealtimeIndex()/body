{
synchronized (log) {
    if (mergedRealtime != null) {
      return mergedRealtime;
    }
    try {
      IncrementalIndex top=makeRealtimeIndex("druid.sample.tsv.top",false);
      IncrementalIndex bottom=makeRealtimeIndex("druid.sample.tsv.bottom",false);
      File tmpFile=File.createTempFile("yay","who");
      tmpFile.delete();
      File topFile=new File(tmpFile,"top");
      File bottomFile=new File(tmpFile,"bottom");
      File mergedFile=new File(tmpFile,"merged");
      topFile.mkdirs();
      topFile.deleteOnExit();
      bottomFile.mkdirs();
      bottomFile.deleteOnExit();
      mergedFile.mkdirs();
      mergedFile.deleteOnExit();
      IndexMerger.persist(top,DATA_INTERVAL,topFile,indexSpec);
      IndexMerger.persist(bottom,DATA_INTERVAL,bottomFile,indexSpec);
      mergedRealtime=IndexIO.loadIndex(IndexMerger.mergeQueryableIndex(Arrays.asList(IndexIO.loadIndex(topFile),IndexIO.loadIndex(bottomFile)),METRIC_AGGS,mergedFile,indexSpec));
      return mergedRealtime;
    }
 catch (    IOException e) {
      throw Throwables.propagate(e);
    }
  }
}
