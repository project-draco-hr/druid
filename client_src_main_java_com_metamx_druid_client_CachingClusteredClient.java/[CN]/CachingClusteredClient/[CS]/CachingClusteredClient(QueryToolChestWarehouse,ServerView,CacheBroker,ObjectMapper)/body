{
  this.warehouse=warehouse;
  this.serverView=serverView;
  this.cacheBroker=cacheBroker;
  this.objectMapper=objectMapper;
  serverView.registerSegmentCallback(Executors.newFixedThreadPool(1,new ThreadFactoryBuilder().setDaemon(true).setNameFormat("CCClient-ServerView-CB-%d").build()),new ServerView.BaseSegmentCallback(){
    @Override public ServerView.CallbackAction segmentRemoved(    DruidServer server,    DataSegment segment){
      CachingClusteredClient.this.cacheBroker.provideCache(segment.getIdentifier()).close();
      return ServerView.CallbackAction.CONTINUE;
    }
  }
);
}
