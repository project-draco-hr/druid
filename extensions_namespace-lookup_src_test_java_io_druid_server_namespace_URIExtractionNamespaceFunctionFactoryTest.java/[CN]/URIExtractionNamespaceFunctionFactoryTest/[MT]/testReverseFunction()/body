{
  Assert.assertNull(reverseFnCache.get(namespace.getNamespace()));
  NamespaceExtractionCacheManagersTest.waitFor(manager.schedule(namespace));
  Function<String,List<String>> reverseFn=reverseFnCache.get(namespace.getNamespace());
  Assert.assertNotNull(reverseFn);
  Assert.assertEquals(Sets.newHashSet("boo","foo"),Sets.newHashSet(reverseFn.apply("bar")));
  Assert.assertEquals(Sets.newHashSet(""),Sets.newHashSet(reverseFn.apply("MissingValue")));
  Assert.assertEquals(Sets.newHashSet("emptyString"),Sets.newHashSet(reverseFn.apply("")));
  Assert.assertEquals(Sets.newHashSet("emptyString"),Sets.newHashSet(reverseFn.apply(null)));
  Assert.assertEquals(Collections.EMPTY_LIST,reverseFn.apply("baz"));
}
