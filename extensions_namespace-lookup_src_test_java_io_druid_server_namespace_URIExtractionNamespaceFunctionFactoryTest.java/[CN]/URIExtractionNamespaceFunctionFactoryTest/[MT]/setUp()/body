{
  lifecycle.start();
  fnCache.clear();
  tmpFileParent=temporaryFolder.newFolder();
  tmpFile=Files.createTempFile(tmpFileParent.toPath(),"druidTestURIExtractionNS",suffix).toFile();
  final ObjectMapper mapper=new DefaultObjectMapper();
  try (OutputStream ostream=outStreamSupplier.apply(tmpFile)){
    try (OutputStreamWriter out=new OutputStreamWriter(ostream)){
      out.write(mapper.writeValueAsString(ImmutableMap.<String,String>of("boo","bar","foo","bar","","MissingValue","emptyString","")));
    }
   }
   factory=new URIExtractionNamespaceFunctionFactory(ImmutableMap.<String,SearchableVersionedDataFinder>of("file",new LocalFileTimestampVersionFinder()));
  namespace=new URIExtractionNamespace("ns",tmpFile.toURI(),new URIExtractionNamespace.ObjectMapperFlatDataParser(URIExtractionNamespaceTest.registerTypes(new ObjectMapper())),new Period(0),Pattern.quote(tmpFile.getName()));
}
