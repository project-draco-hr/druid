{
  final Interval bucketInterval=getGranularitySpec().bucketInterval(bucket.time).get();
  if (fileSystem instanceof DistributedFileSystem) {
    return new Path(String.format("%s/%s/%s_%s/%s/%s",getSegmentOutputPath(),getDataSource(),bucketInterval.getStart().toString(ISODateTimeFormat.basicDateTime()),bucketInterval.getEnd().toString(ISODateTimeFormat.basicDateTime()),getVersion().replace(":","_"),bucket.partitionNum));
  }
  return new Path(String.format("%s/%s/%s_%s/%s/%s",getSegmentOutputPath(),getDataSource(),bucketInterval.getStart().toString(),bucketInterval.getEnd().toString(),getVersion(),bucket.partitionNum));
}
