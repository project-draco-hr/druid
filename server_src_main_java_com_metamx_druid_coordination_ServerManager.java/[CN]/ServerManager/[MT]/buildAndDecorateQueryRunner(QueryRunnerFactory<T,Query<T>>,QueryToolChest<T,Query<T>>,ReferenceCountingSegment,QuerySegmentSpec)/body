{
  adapter.increment();
  return new SpecificSegmentQueryRunner<T>(new MetricsEmittingQueryRunner<T>(emitter,new Function<Query<T>,ServiceMetricEvent.Builder>(){
    @Override public ServiceMetricEvent.Builder apply(    @Nullable final Query<T> input){
      return toolChest.makeMetricBuilder(input);
    }
  }
,new BySegmentQueryRunner<T>(adapter.getIdentifier(),adapter.getDataInterval().getStart(),new QueryRunner<T>(){
    @Override public Sequence<T> run(    final Query<T> query){
      return new ReferenceCountingSequence<T>(factory.createRunner(adapter).run(query),adapter);
    }
  }
)).withWaitMeasuredFromNow(),segmentSpec);
}
