{
  return new SpecificSegmentQueryRunner<T>(new MetricsEmittingQueryRunner<T>(emitter,new Function<Query<T>,ServiceMetricEvent.Builder>(){
    @Override public ServiceMetricEvent.Builder apply(    @Nullable Query<T> input){
      return toolChest.makeMetricBuilder(input);
    }
  }
,new BySegmentQueryRunner<T>(adapter.getIdentifier(),adapter.getDataInterval().getStart(),factory.createRunner(adapter))).withWaitMeasuredFromNow(),segmentSpec);
}
