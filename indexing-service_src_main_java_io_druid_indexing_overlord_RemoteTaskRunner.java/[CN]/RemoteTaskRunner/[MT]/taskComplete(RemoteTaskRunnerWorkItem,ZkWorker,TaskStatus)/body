{
  Preconditions.checkNotNull(taskRunnerWorkItem,"taskRunnerWorkItem");
  Preconditions.checkNotNull(taskStatus,"taskStatus");
  if (zkWorker != null) {
    log.info("Worker[%s] completed task[%s] with status[%s]",zkWorker.getWorker().getHost(),taskStatus.getId(),taskStatus.getStatusCode());
    zkWorker.setLastCompletedTaskTime(new DateTime());
  }
 else {
    log.info("No worker run task[%s] with status[%s]",taskStatus.getId(),taskStatus.getStatusCode());
  }
  completeTasks.put(taskStatus.getId(),taskRunnerWorkItem);
  runningTasks.remove(taskStatus.getId());
  final ListenableFuture<TaskStatus> result=taskRunnerWorkItem.getResult();
  if (result != null) {
    ((SettableFuture<TaskStatus>)result).set(taskStatus);
  }
}
