{
  final HyperLogLogCollector rolling=HyperLogLogCollector.makeLatestCollector();
  int count;
  long start=System.currentTimeMillis();
  for (count=0; count < 5000000; ++count) {
    HyperLogLogCollector theCollector=HyperLogLogCollector.makeLatestCollector();
    theCollector.add(fn.hashLong(count).asBytes());
    rolling.fold(theCollector);
  }
  System.out.printf("testHighCardinalityRollingFold2 took %d ms%n",System.currentTimeMillis() - start);
  int n=count;
  System.out.println("True cardinality " + n);
  System.out.println("Rolling buffer cardinality " + rolling.estimateCardinality());
  System.out.println(String.format("Rolling cardinality estimate off by %4.1f%%",100 * (1 - rolling.estimateCardinality() / n)));
  Assert.assertEquals(n,rolling.estimateCardinality(),n * 0.05);
}
