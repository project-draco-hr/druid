{
  IncrementalIndex<?> index=closer.closeLater(indexCreator.createIndex());
  index.add(new MapBasedInputRow(new DateTime().minus(1).getMillis(),Lists.newArrayList("string","float","long"),ImmutableMap.<String,Object>of("string",Arrays.asList("A",null,""),"float",Arrays.asList(Float.MAX_VALUE,null,""),"long",Arrays.asList(Long.MIN_VALUE,null,""))));
  Row row=index.iterator().next();
  Assert.assertArrayEquals(new String[]{"","","A"},(Object[])row.getRaw("string"));
  Assert.assertArrayEquals(new Float[]{null,null,Float.MAX_VALUE},(Object[])row.getRaw("float"));
  Assert.assertArrayEquals(new Long[]{null,null,Long.MIN_VALUE},(Object[])row.getRaw("long"));
}
