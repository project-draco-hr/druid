{
  Preconditions.checkArgument(version.compareTo(VERSION.COMPRESSED) <= 0,"Unsupported version[%s]",version);
  this.bitmapSerdeFactory=bitmapSerdeFactory;
  this.byteOrder=byteOrder;
  this.version=version;
  this.flags=flags;
  this.dictionary=dictionary;
  this.singleValuedColumn=singleValuedColumn;
  this.multiValuedColumn=multiValuedColumn;
  this.bitmaps=bitmaps;
  this.spatialIndex=spatialIndex;
  long size=dictionary.getSerializedSize();
  if (Feature.MULTI_VALUE.isSet(flags)) {
    size+=multiValuedColumn.getSerializedSize();
  }
 else {
    size+=singleValuedColumn.getSerializedSize();
  }
  size+=bitmaps.getSerializedSize();
  if (spatialIndex != null) {
    size+=spatialIndex.size() + Ints.BYTES;
  }
  this.size=size;
}
