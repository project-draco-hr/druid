{
  Stopwatch stopwatch=Stopwatch.createStarted();
  while (Iterables.isEmpty(batchServerInventoryView.getInventory()) || Iterables.get(batchServerInventoryView.getInventory(),0).getSegments().size() != testSegments.size()) {
    Thread.sleep(500);
    if (stopwatch.elapsed(TimeUnit.MILLISECONDS) > 2000) {
      throw new ISE("BatchServerInventoryView is not updating");
    }
  }
}
