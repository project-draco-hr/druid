{
  segmentAnnouncer.announceSegments(testSegments);
  waitForSync(filteredBatchServerInventoryView,testSegments);
  DruidServer server=Iterables.get(filteredBatchServerInventoryView.getInventory(),0);
  Set<DataSegment> segments=Sets.newHashSet(server.getSegments().values());
  Assert.assertEquals(testSegments,segments);
  DataSegment segment1=makeSegment(101);
  segmentAnnouncer.announceSegment(segment1);
  testSegments.add(segment1);
  exception.expect(ISE.class);
  waitForSync(filteredBatchServerInventoryView,testSegments);
}
