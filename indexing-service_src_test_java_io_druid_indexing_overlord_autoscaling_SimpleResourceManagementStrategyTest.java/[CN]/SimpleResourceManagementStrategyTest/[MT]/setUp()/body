{
  autoScaler=EasyMock.createMock(AutoScaler.class);
  testTask=new TestMergeTask("task1","dummyDs",Lists.<DataSegment>newArrayList(new DataSegment("dummyDs",new Interval("2012-01-01/2012-01-02"),new DateTime().toString(),null,null,null,null,0,0)),Lists.<AggregatorFactory>newArrayList());
  simpleResourceManagementConfig=new SimpleResourceManagementConfig().setWorkerIdleTimeout(new Period(0)).setMaxScalingDuration(new Period(1000)).setNumEventsToTrack(1).setPendingTaskTimeout(new Period(0)).setWorkerVersion("");
  workerConfig=new AtomicReference<>(new WorkerBehaviourConfig(null,autoScaler));
  simpleResourceManagementStrategy=new SimpleResourceManagementStrategy(simpleResourceManagementConfig,DSuppliers.of(workerConfig));
}
