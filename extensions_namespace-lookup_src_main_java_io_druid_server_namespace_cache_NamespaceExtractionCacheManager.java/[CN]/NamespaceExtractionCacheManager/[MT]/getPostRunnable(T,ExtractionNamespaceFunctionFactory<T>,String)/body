{
  return new Runnable(){
    @Override public void run(){
      final String nsName=namespace.getNamespace();
      final NamespaceImplData namespaceDatum=implData.get(nsName);
      if (namespaceDatum == null) {
        return;
      }
synchronized (namespaceDatum.enabled) {
        if (!namespaceDatum.enabled.get()) {
          return;
        }
        swapAndClearCache(nsName,cacheId);
        final Function<String,String> fn=factory.buildFn(namespace,getCacheMap(nsName));
        final Function<String,List<String>> reverseFn=factory.buildReverseFn(namespace,getCacheMap(nsName));
        final Function<String,String> priorFn=fnCache.put(nsName,fn);
        final Function<String,List<String>> priorReverseFn=reverseFnCache.put(nsName,reverseFn);
        if (priorFn != null && priorFn != namespaceDatum.fn.get()) {
          log.warn("Replaced prior function for namespace [%s]",nsName);
        }
        if (priorReverseFn != null && priorReverseFn != namespaceDatum.reverseFn.get()) {
          log.warn("Replaced prior reverse function for namespace [%s]",nsName);
        }
        namespaceDatum.fn.set(fn);
        namespaceDatum.reverseFn.set(reverseFn);
      }
    }
  }
;
}
