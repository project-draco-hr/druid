{
  TopNQuery query=new TopNQueryBuilder().dataSource(dataSource).granularity(allGran).filters(placementishDimension,"a","b").dimension(placementishDimension).metric(indexMetric).threshold(4).intervals(firstToThird).aggregators(commonAggregators).postAggregators(Arrays.<PostAggregator>asList(addRowsIndexConstant)).build();
  final ArrayList<Result<TopNResultValue>> expectedResults=Lists.newArrayList(new Result<TopNResultValue>(new DateTime("2011-04-01T00:00:00.000Z"),new TopNResultValue(Arrays.<Map<String,Object>>asList(ImmutableMap.<String,Object>of("placementish","preferred","rows",4L,"index",514.868408203125D,"addRowsIndexConstant",519.868408203125D),ImmutableMap.<String,Object>of("placementish","a","rows",2L,"index",283.31103515625D,"addRowsIndexConstant",286.31103515625D),ImmutableMap.<String,Object>of("placementish","b","rows",2L,"index",231.557373046875D,"addRowsIndexConstant",234.557373046875D)))));
  TestHelper.assertExpectedResults(expectedResults,runner.run(query));
}
