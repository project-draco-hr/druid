{
  TopNQuery query=new TopNQueryBuilder().dataSource(dataSource).granularity(allGran).dimension(providerDimension).metric(new LexicographicTopNMetricSpec("")).threshold(4).intervals(firstToThird).aggregators(commonAggregators).postAggregators(Arrays.<PostAggregator>asList(addRowsIndexConstant)).build();
  List<Result<TopNResultValue>> expectedResults=Arrays.asList(new Result<TopNResultValue>(new DateTime("2011-04-01T00:00:00.000Z"),new TopNResultValue(Arrays.<Map<String,Object>>asList(ImmutableMap.<String,Object>of("provider","spot","rows",18L,"index",2231.8768157958984D,"addRowsIndexConstant",2250.8768157958984D),ImmutableMap.<String,Object>of("provider","total_market","rows",4L,"index",5351.814697265625D,"addRowsIndexConstant",5356.814697265625D),ImmutableMap.<String,Object>of("provider","upfront","rows",4L,"index",4875.669677734375D,"addRowsIndexConstant",4880.669677734375D)))));
  TestHelper.assertExpectedResults(expectedResults,runner.run(query));
}
