{
  log.debug("Adding %,d events to firehose: %s",events.size(),firehoseId);
  try {
    for (    final Map<String,Object> event : events) {
      boolean added=false;
      while (!closed && !added) {
        added=buffer.offer(event,500,TimeUnit.MILLISECONDS);
      }
      if (!added) {
        throw new IllegalStateException("Cannot add events to closed firehose!");
      }
    }
  }
 catch (  InterruptedException e) {
    Thread.currentThread().interrupt();
    throw Throwables.propagate(e);
  }
}
