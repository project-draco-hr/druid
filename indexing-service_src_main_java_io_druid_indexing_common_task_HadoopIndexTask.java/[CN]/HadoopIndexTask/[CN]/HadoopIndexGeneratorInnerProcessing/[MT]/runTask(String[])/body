{
  final String schema=args[0];
  String version=args[1];
  final HadoopIngestionSpec theSchema=HadoopDruidIndexerConfig.jsonMapper.readValue(schema,HadoopIngestionSpec.class);
  final HadoopDruidIndexerConfig config=HadoopDruidIndexerConfig.fromSchema(theSchema.withTuningConfig(theSchema.getTuningConfig().withVersion(version)));
  HadoopDruidIndexerJob job=new HadoopDruidIndexerJob(config,injector.getInstance(MetadataStorageUpdaterJobHandler.class));
  log.info("Starting a hadoop index generator job...");
  if (job.run()) {
    return HadoopDruidIndexerConfig.jsonMapper.writeValueAsString(job.getPublishedSegments());
  }
  return null;
}
