{
  final String schema=args[0];
  final String version=args[1];
  final String workingPath=args[2];
  final String segmentOutputPath=args[3];
  final HadoopDruidIndexerSchema theSchema=HadoopDruidIndexerConfig.jsonMapper.readValue(schema,HadoopDruidIndexerSchema.class);
  final HadoopDruidIndexerConfig config=new HadoopDruidIndexerConfigBuilder().withSchema(theSchema).withVersion(version).withWorkingPath(workingPath).withSegmentOutputPath(segmentOutputPath).build();
  HadoopDruidIndexerJob job=new HadoopDruidIndexerJob(config);
  log.info("Starting a hadoop index generator job...");
  if (job.run()) {
    return HadoopDruidIndexerConfig.jsonMapper.writeValueAsString(job.getPublishedSegments());
  }
  return null;
}
