{
  super(id != null ? id : String.format("index_hadoop_%s_%s",schema.getDataSource(),new DateTime()),schema.getDataSource(),JodaUtils.umbrellaInterval(JodaUtils.condenseIntervals(schema.getGranularitySpec().bucketIntervals())));
  Preconditions.checkArgument(schema.getSegmentOutputPath() == null,"segmentOutputPath must be absent");
  Preconditions.checkArgument(schema.getWorkingPath() == null,"workingPath must be absent");
  Preconditions.checkArgument(schema.getUpdaterJobSpec() == null,"updaterJobSpec must be absent");
  this.schema=schema;
  this.hadoopCoordinates=(hadoopCoordinates == null ? defaultHadoopCoordinates : hadoopCoordinates);
}
