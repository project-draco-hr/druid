{
  for (  int[] param : new int[][]{{3,3},{0,1},{5,5},{2,7},{3,0}}) {
    SelectQuery query=newTestQuery().intervals(I_0112_0114).filters(new SelectorDimFilter(QueryRunnerTestHelper.marketDimension,"spot",null)).granularity(QueryRunnerTestHelper.dayGran).dimensionSpecs(DefaultDimensionSpec.toSpec(QueryRunnerTestHelper.qualityDimension)).metrics(Lists.<String>newArrayList(QueryRunnerTestHelper.indexMetric)).pagingSpec(new PagingSpec(toPagingIdentifier(param[0],descending),param[1])).build();
    HashMap<String,Object> context=new HashMap<String,Object>();
    Iterable<Result<SelectResultValue>> results=Sequences.toList(runner.run(query,context),Lists.<Result<SelectResultValue>>newArrayList());
    final List<List<Map<String,Object>>> events=toEvents(new String[]{EventHolder.timestampKey + ":TIME",null,QueryRunnerTestHelper.qualityDimension + ":STRING",null,null,QueryRunnerTestHelper.indexMetric + ":FLOAT"},new String[]{"2011-01-12T00:00:00.000Z	spot	automotive	preferred	apreferred	100.000000","2011-01-12T00:00:00.000Z	spot	business	preferred	bpreferred	100.000000","2011-01-12T00:00:00.000Z	spot	entertainment	preferred	epreferred	100.000000","2011-01-12T00:00:00.000Z	spot	health	preferred	hpreferred	100.000000","2011-01-12T00:00:00.000Z	spot	mezzanine	preferred	mpreferred	100.000000","2011-01-12T00:00:00.000Z	spot	news	preferred	npreferred	100.000000","2011-01-12T00:00:00.000Z	spot	premium	preferred	ppreferred	100.000000","2011-01-12T00:00:00.000Z	spot	technology	preferred	tpreferred	100.000000","2011-01-12T00:00:00.000Z	spot	travel	preferred	tpreferred	100.000000"},new String[]{"2011-01-13T00:00:00.000Z	spot	automotive	preferred	apreferred	94.874713","2011-01-13T00:00:00.000Z	spot	business	preferred	bpreferred	103.629399","2011-01-13T00:00:00.000Z	spot	entertainment	preferred	epreferred	110.087299","2011-01-13T00:00:00.000Z	spot	health	preferred	hpreferred	114.947403","2011-01-13T00:00:00.000Z	spot	mezzanine	preferred	mpreferred	104.465767","2011-01-13T00:00:00.000Z	spot	news	preferred	npreferred	102.851683","2011-01-13T00:00:00.000Z	spot	premium	preferred	ppreferred	108.863011","2011-01-13T00:00:00.000Z	spot	technology	preferred	tpreferred	111.356672","2011-01-13T00:00:00.000Z	spot	travel	preferred	tpreferred	106.236928"});
    PagingOffset offset=query.getPagingOffset(QueryRunnerTestHelper.segmentId);
    List<Result<SelectResultValue>> expectedResults=toExpected(events,offset.startOffset(),offset.threshold());
    verify(expectedResults,results);
  }
}
