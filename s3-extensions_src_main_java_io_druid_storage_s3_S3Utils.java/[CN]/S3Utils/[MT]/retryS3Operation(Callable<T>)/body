{
  final Predicate<Throwable> shouldRetry=new Predicate<Throwable>(){
    @Override public boolean apply(    Throwable e){
      if (e instanceof IOException) {
        return true;
      }
 else       if (e instanceof S3ServiceException) {
        final boolean isIOException=e.getCause() instanceof IOException;
        final boolean isTimeout="RequestTimeout".equals(((S3ServiceException)e).getS3ErrorCode());
        return isIOException || isTimeout;
      }
 else {
        return false;
      }
    }
  }
;
  final int maxTries=10;
  return RetryUtils.retry(f,shouldRetry,maxTries);
}
