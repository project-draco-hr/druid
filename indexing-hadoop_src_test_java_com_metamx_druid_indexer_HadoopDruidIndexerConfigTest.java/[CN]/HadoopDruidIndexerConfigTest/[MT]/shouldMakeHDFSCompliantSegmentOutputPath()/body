{
  final HadoopDruidIndexerConfig cfg;
  try {
    cfg=jsonReadWriteRead("{" + "\"dataSource\": \"the:data:source\"," + " \"granularitySpec\":{"+ "   \"type\":\"uniform\","+ "   \"gran\":\"hour\","+ "   \"intervals\":[\"2012-07-10/P1D\"]"+ " },"+ "\"segmentOutputPath\": \"/tmp/dru:id/data:test\""+ "}",HadoopDruidIndexerConfig.class);
  }
 catch (  Exception e) {
    throw Throwables.propagate(e);
  }
  cfg.setVersion("some:brand:new:version");
  Bucket bucket=new Bucket(4711,new DateTime(2012,07,10,5,30),4712);
  Path path=cfg.makeSegmentOutputPath(new DistributedFileSystem(),bucket);
  Assert.assertEquals("/tmp/dru_id/data_test/the_data_source/20120710T050000.000Z_20120710T060000.000Z/some_brand_new_version/4712",path.toString());
}
