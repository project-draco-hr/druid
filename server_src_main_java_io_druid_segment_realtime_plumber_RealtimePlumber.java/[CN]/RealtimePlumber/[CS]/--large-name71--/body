{
  this.schema=schema;
  this.config=config;
  this.rejectionPolicy=config.getRejectionPolicyFactory().create(config.getWindowPeriod());
  this.metrics=metrics;
  this.emitter=emitter;
  this.conglomerate=conglomerate;
  this.segmentAnnouncer=segmentAnnouncer;
  this.queryExecutorService=queryExecutorService;
  this.dataSegmentPusher=dataSegmentPusher;
  this.segmentPublisher=segmentPublisher;
  this.handoffNotifier=handoffNotifier;
  this.indexMerger=Preconditions.checkNotNull(indexMerger,"Null IndexMerger");
  this.indexIO=Preconditions.checkNotNull(indexIO,"Null IndexIO");
  this.cache=cache;
  this.cacheConfig=cacheConfig;
  this.objectMapper=objectMapper;
  if (!cache.isLocal()) {
    log.error("Configured cache is not local, caching will not be enabled");
  }
  log.info("Creating plumber using rejectionPolicy[%s]",getRejectionPolicy());
}
