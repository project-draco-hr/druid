{
  return asLeaderWithSupervisorManager(new Function<SupervisorManager,Response>(){
    @Override public Response apply(    SupervisorManager manager){
      if (manager.hasSupervisor(spec.getId())) {
        return Response.status(Response.Status.CONFLICT).entity(ImmutableMap.of("error",String.format("Supervisor already exists for [%s]",spec.getId()))).build();
      }
      manager.createAndStartSupervisor(spec);
      return Response.ok(ImmutableMap.of("id",spec.getId())).build();
    }
  }
);
}
