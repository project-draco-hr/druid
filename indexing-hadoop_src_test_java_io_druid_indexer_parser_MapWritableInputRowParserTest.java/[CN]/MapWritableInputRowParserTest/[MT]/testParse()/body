{
  MapWritableInputRowParser parser=new MapWritableInputRowParser(new JSONParseSpec(new TimestampSpec("time","YYYY"),new DimensionsSpec(null,null,null)));
  MapWritable mapWritable=new MapWritable();
  mapWritable.put(new Text("time"),new Text("2015"));
  mapWritable.put(new Text("int"),new IntWritable(1));
  mapWritable.put(new Text("long"),new LongWritable(1));
  mapWritable.put(new Text("float"),new FloatWritable(1.0f));
  mapWritable.put(new Text("double"),new DoubleWritable(1.0));
  mapWritable.put(new Text("text"),new Text("a"));
  mapWritable.put(new Text("list"),new ArrayWritable(Text.class,new Text[]{new Text("v1"),new Text("v2")}));
  byte[] bytes="a".getBytes();
  mapWritable.put(new Text("bytes"),new BytesWritable(bytes));
  InputRow inputRow=parser.parse(mapWritable);
  Assert.assertEquals(DateTime.parse("2015"),inputRow.getTimestamp());
  Assert.assertEquals(1,inputRow.getLongMetric("int"));
  Assert.assertEquals(1,inputRow.getLongMetric("long"));
  Assert.assertEquals(1.0,inputRow.getFloatMetric("float"),0.0001);
  Assert.assertEquals(1.0,inputRow.getFloatMetric("double"),0.0001);
  Assert.assertEquals(ImmutableList.of("a"),inputRow.getDimension("text"));
  Assert.assertEquals(ImmutableList.of("v1","v2"),inputRow.getDimension("list"));
  Assert.assertEquals(bytes,inputRow.getRaw("bytes"));
}
