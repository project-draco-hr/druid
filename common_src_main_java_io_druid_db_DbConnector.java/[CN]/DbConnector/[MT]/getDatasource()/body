{
  DbConnectorConfig connectorConfig=config.get();
  BasicDataSource dataSource=new BasicDataSource();
  dataSource.setUsername(connectorConfig.getUser());
  dataSource.setPassword(connectorConfig.getPassword());
  String uri=connectorConfig.getConnectURI();
  isPostgreSQL=uri.startsWith("jdbc:postgresql");
  dataSource.setUrl(uri);
  if (connectorConfig.isUseValidationQuery()) {
    dataSource.setValidationQuery(connectorConfig.getValidationQuery());
    dataSource.setTestOnBorrow(true);
  }
  return dataSource;
}
