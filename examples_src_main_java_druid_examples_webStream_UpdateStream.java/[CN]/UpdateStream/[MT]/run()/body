{
  try {
    BufferedReader reader=supplier.getInput();
    String line;
    while ((line=reader.readLine()) != null) {
      if (isValid(line)) {
        HashMap<String,Object> map=mapper.readValue(line,typeRef);
        queue.offer(map,queueWaitTime,TimeUnit.SECONDS);
        log.info("Successfully added to queue");
      }
    }
  }
 catch (  Exception e) {
    throw Throwables.propagate(e);
  }
}
