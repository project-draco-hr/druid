{
  try {
    BufferedReader reader=supplier.getInput();
    String line;
    while ((line=reader.readLine()) != null) {
      if (isValid(line)) {
        HashMap<String,Object> map=mapper.readValue(line,typeRef);
        if (map.get(timeDimension) != null) {
          Map<String,Object> renamedMap=renameKeys(map);
          queue.offer(renamedMap,queueWaitTime,TimeUnit.SECONDS);
          log.debug("Successfully added to queue");
        }
 else {
          log.debug("missing timestamp");
        }
      }
    }
  }
 catch (  Exception e) {
    throw Throwables.propagate(e);
  }
}
