{
  try {
    BufferedReader reader=(BufferedReader)supplier.getInput();
    String line;
    while ((line=reader.readLine()) != null) {
      if (isValid(line)) {
        try {
          HashMap<String,Object> map=mapper.readValue(line,typeRef);
          queue.offer(map,15L,TimeUnit.SECONDS);
          log.info("Successfully added to queue");
        }
 catch (        JsonParseException e) {
          log.info("Invalid JSON Stream. Please check if the url returns a proper JSON stream.");
          Throwables.propagate(e);
        }
catch (        Exception e) {
          Throwables.propagate(e);
        }
      }
    }
  }
 catch (  Exception e) {
    e.printStackTrace();
    Throwables.propagate(e);
  }
}
