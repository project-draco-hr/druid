{
  if (taskToolbox == null) {
    final DataSegmentPusher dataSegmentPusher=new S3DataSegmentPusher(s3Service,configFactory.build(S3DataSegmentPusherConfig.class),jsonMapper);
    final SegmentKiller segmentKiller=new S3SegmentKiller(s3Service);
    taskToolbox=new TaskToolbox(taskConfig,new RemoteTaskActionClient(httpClient,jsonMapper),emitter,s3Service,dataSegmentPusher,segmentKiller,jsonMapper);
  }
}
