{
  WorkerCuratorCoordinator workerCuratorCoordinator=new WorkerCuratorCoordinator(jsonMapper,new IndexerZkConfig(){
    @Override public String getAnnouncementPath(){
      return announcementsPath;
    }
    @Override public String getTaskPath(){
      return tasksPath;
    }
    @Override public String getStatusPath(){
      return statusPath;
    }
    @Override public long getMaxNumBytes(){
      return 1000;
    }
  }
,cf,worker1);
  workerCuratorCoordinator.start();
  taskMonitor=new TaskMonitor(new PathChildrenCache(cf,String.format("%s/worker1",tasksPath),true),cf,workerCuratorCoordinator,new TaskToolbox(new TaskConfig(){
    @Override public File getBaseTaskDir(){
      try {
        return File.createTempFile("billy","yay");
      }
 catch (      Exception e) {
        throw Throwables.propagate(e);
      }
    }
    @Override public int getDefaultRowFlushBoundary(){
      return 0;
    }
    @Override public String getHadoopWorkingPath(){
      return null;
    }
  }
,null,null,null,null,null,jsonMapper),Executors.newSingleThreadExecutor());
  jsonMapper.registerSubtypes(new NamedType(TestTask.class,"test"));
  taskMonitor.start();
}
