{
  scheduledExec=EasyMock.createMock(ScheduledExecutorService.class);
  remoteTaskRunner=new RemoteTaskRunner(jsonMapper,new TestRemoteTaskRunnerConfig(),cf,pathChildrenCache,scheduledExec,new RetryPolicyFactory(new TestRetryPolicyConfig()),new TestScalingStrategy());
  task1=new TestTask("task1","dummyDs",Lists.<DataSegment>newArrayList(new DataSegment("dummyDs",new Interval(new DateTime(),new DateTime()),new DateTime().toString(),null,null,null,null,0)),Lists.<AggregatorFactory>newArrayList());
  remoteTaskRunner.start();
  cf.create().creatingParentsIfNeeded().withMode(CreateMode.EPHEMERAL).forPath(String.format("%s/worker1",announcementsPath),jsonMapper.writeValueAsBytes(worker1));
  while (remoteTaskRunner.getNumWorkers() == 0) {
    Thread.sleep(500);
  }
}
