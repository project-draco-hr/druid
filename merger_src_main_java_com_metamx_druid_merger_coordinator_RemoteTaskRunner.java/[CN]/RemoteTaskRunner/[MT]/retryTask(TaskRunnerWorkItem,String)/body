{
  final String taskId=taskRunnerWorkItem.getTask().getId();
  if (!taskRunnerWorkItem.getRetryPolicy().hasExceededRetryThreshold()) {
    log.info("Retry scheduled in %s for %s",taskRunnerWorkItem.getRetryPolicy().getRetryDelay(),taskId);
    scheduledExec.schedule(new Runnable(){
      @Override public void run(){
        cleanup(workerId,taskId);
        addPendingTask(taskRunnerWorkItem);
      }
    }
,taskRunnerWorkItem.getRetryPolicy().getAndIncrementRetryDelay().getMillis(),TimeUnit.MILLISECONDS);
  }
 else {
    log.makeAlert("Task exceeded retry threshold").addData("task",taskId).emit();
  }
}
