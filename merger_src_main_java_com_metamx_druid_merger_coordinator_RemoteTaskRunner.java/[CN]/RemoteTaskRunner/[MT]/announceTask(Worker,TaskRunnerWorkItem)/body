{
  final Task task=taskRunnerWorkItem.getTask();
  final TaskContext taskContext=taskRunnerWorkItem.getTaskContext();
  log.info("Coordinator asking Worker[%s] to add task[%s]",theWorker.getHost(),task.getId());
  byte[] rawBytes=jsonMapper.writeValueAsBytes(new TaskHolder(task,taskContext));
  if (rawBytes.length > config.getMaxNumBytes()) {
    throw new ISE("Length of raw bytes for task too large[%,d > %,d]",rawBytes.length,config.getMaxNumBytes());
  }
  cf.create().withMode(CreateMode.EPHEMERAL).forPath(JOINER.join(config.getTaskPath(),theWorker.getHost(),task.getId()),jsonMapper.writeValueAsBytes(new TaskHolder(task,taskContext)));
  runningTasks.put(task.getId(),pendingTasks.remove(task.getId()));
  log.info("Task %s switched from pending to running",task.getId());
synchronized (statusLock) {
    while (findWorkerRunningTask(task.getId()) == null) {
      statusLock.wait(config.getTaskAssignmentTimeoutDuration().getMillis());
    }
  }
}
