{
  try {
    final String taskId=taskRunnerWorkItem.getTask().getId();
    ZkWorker zkWorker=findWorkerRunningTask(taskId);
    if (zkWorker != null) {
      final Worker worker=zkWorker.getWorker();
      log.info("Worker[%s] is already running task[%s].",worker.getHost(),taskId);
      runningTasks.put(taskId,pendingTasks.remove(taskId));
      log.info("Task %s switched from pending to running",taskId);
    }
 else {
      zkWorker=findWorkerForTask();
      if (zkWorker != null) {
        announceTask(zkWorker.getWorker(),taskRunnerWorkItem);
      }
    }
  }
 catch (  Exception e) {
    throw Throwables.propagate(e);
  }
}
