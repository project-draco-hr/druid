{
  currentlyTerminating.remove(workerId);
  WorkerWrapper workerWrapper=zkWorkers.get(workerId);
  if (workerWrapper != null) {
    for (    String taskId : workerWrapper.getRunningTasks()) {
      TaskWrapper taskWrapper=tasks.get(taskId);
      if (taskWrapper != null) {
        retryTask(new CleanupPaths(workerId,taskId),tasks.get(taskId));
      }
      workerWrapper.removeTask(taskId);
    }
    try {
      workerWrapper.getStatusCache().close();
    }
 catch (    IOException e) {
      log.error("Failed to close watcher associated with worker[%s]",workerWrapper.getWorker().getHost());
    }
  }
  zkWorkers.remove(workerId);
}
