{
  currentlyTerminating.remove(workerId);
  WorkerWrapper workerWrapper=zkWorkers.get(workerId);
  if (workerWrapper != null) {
    try {
      Set<String> tasksToRetry=Sets.newHashSet(workerWrapper.getRunningTasks());
      tasksToRetry.addAll(cf.getChildren().forPath(JOINER.join(config.getTaskPath(),workerId)));
      for (      String taskId : tasksToRetry) {
        TaskWrapper taskWrapper=tasks.get(taskId);
        if (taskWrapper != null) {
          retryTask(new CleanupPaths(workerId,taskId),tasks.get(taskId));
        }
      }
      workerWrapper.getStatusCache().close();
    }
 catch (    Exception e) {
      log.error(e,"Failed to cleanly remove worker[%s]");
    }
  }
  zkWorkers.remove(workerId);
}
