{
synchronized (statusLock) {
    final Task task=taskWrapper.getTask();
    final TaskContext taskContext=taskWrapper.getTaskContext();
    try {
      log.info("Coordinator asking Worker[%s] to add task[%s]",theWorker.getHost(),task.getId());
      tasks.put(task.getId(),taskWrapper);
      cf.create().withMode(CreateMode.EPHEMERAL).forPath(JOINER.join(config.getTaskPath(),theWorker.getHost(),task.getId()),jsonMapper.writeValueAsBytes(new TaskHolder(task,taskContext)));
      while (findWorkerRunningTask(taskWrapper) == null) {
        statusLock.wait();
      }
    }
 catch (    Exception e) {
      log.error(e,"Exception creating task[%s] for worker node[%s]",task.getId(),theWorker.getHost());
      throw Throwables.propagate(e);
    }
  }
}
