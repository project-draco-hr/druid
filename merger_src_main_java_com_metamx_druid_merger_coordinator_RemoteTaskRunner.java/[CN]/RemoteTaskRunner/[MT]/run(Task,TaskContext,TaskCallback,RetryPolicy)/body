{
  try {
    Map<String,Worker> allRunningTasks=Maps.newHashMap();
    for (    Worker worker : taskInventoryManager.getInventory()) {
      for (      String taskId : worker.getTasks().keySet()) {
        allRunningTasks.put(taskId,worker);
      }
    }
    Worker workerRunningThisTask=allRunningTasks.get(task.getId());
    if (workerRunningThisTask != null) {
      if (!verifyStatusComplete(jsonMapper,workerRunningThisTask,task,callback)) {
        monitorStatus(jsonMapper,workerRunningThisTask,task,taskContext,callback,retryPolicy);
      }
      return;
    }
    Worker theWorker=getLeastCapacityWorker();
    monitorStatus(jsonMapper,theWorker,task,taskContext,callback,retryPolicy);
    announceTask(theWorker,task,taskContext);
  }
 catch (  Exception e) {
    log.error(e,"Failed to dispatch task. Retrying");
    retryTask(task,taskContext,callback,retryPolicy);
  }
}
