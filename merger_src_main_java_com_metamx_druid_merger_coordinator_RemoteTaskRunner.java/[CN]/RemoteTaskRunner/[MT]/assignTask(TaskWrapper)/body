{
  try {
    WorkerWrapper workerWrapper=findWorkerRunningTask(taskWrapper);
    if (workerWrapper != null) {
      final Worker worker=workerWrapper.getWorker();
      log.info("Worker[%s] is already running task[%s].",worker.getHost(),taskWrapper.getTask().getId());
      runningTasks.put(taskWrapper.getTask().getId(),pendingTasks.remove(taskWrapper.getTask().getId()));
      final ChildData statusData=workerWrapper.getStatusCache().getCurrentData(JOINER.join(config.getStatusPath(),worker.getHost(),taskWrapper.getTask().getId()));
      final TaskStatus taskStatus=jsonMapper.readValue(statusData.getData(),TaskStatus.class);
      TaskCallback callback=taskWrapper.getCallback();
      if (callback != null) {
        callback.notify(taskStatus);
      }
      if (taskStatus.isComplete()) {
        cleanup(worker.getHost(),taskWrapper.getTask().getId());
      }
    }
 else {
      workerWrapper=findWorkerForTask();
      if (workerWrapper != null) {
        announceTask(workerWrapper.getWorker(),taskWrapper);
      }
    }
  }
 catch (  Exception e) {
    throw Throwables.propagate(e);
  }
}
