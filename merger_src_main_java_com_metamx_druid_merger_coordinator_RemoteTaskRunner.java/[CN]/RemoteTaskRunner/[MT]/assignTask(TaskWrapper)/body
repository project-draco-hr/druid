{
  try {
    WorkerWrapper workerWrapper;
    if ((workerWrapper=findWorkerRunningTask(taskWrapper)) != null) {
      final Worker worker=workerWrapper.getWorker();
      TaskStatus taskStatus=jsonMapper.readValue(cf.getData().forPath(JOINER.join(config.getStatusPath(),worker.getHost(),taskWrapper.getTask().getId())),TaskStatus.class);
      if (taskStatus.isComplete()) {
        TaskCallback callback=taskWrapper.getCallback();
        if (callback != null) {
          callback.notify(taskStatus);
        }
        new CleanupPaths(worker.getHost(),taskWrapper.getTask().getId()).run();
      }
 else {
        tasks.put(taskWrapper.getTask().getId(),taskWrapper);
      }
      return true;
    }
  }
 catch (  Exception e) {
    throw Throwables.propagate(e);
  }
  WorkerWrapper workerWrapper=getWorkerForTask();
  if (workerWrapper != null) {
    announceTask(workerWrapper.getWorker(),taskWrapper);
    return true;
  }
  return false;
}
