{
  WorkerWrapper workerWrapper=findWorkerRunningTask(taskWrapper);
  if (workerWrapper != null) {
    final Worker worker=workerWrapper.getWorker();
    try {
      log.info("Worker[%s] is already running task[%s].",worker.getHost(),taskWrapper.getTask().getId());
      TaskStatus taskStatus=jsonMapper.readValue(workerWrapper.getStatusCache().getCurrentData(JOINER.join(config.getStatusPath(),worker.getHost(),taskWrapper.getTask().getId())).getData(),TaskStatus.class);
      if (taskStatus.isComplete()) {
        TaskCallback callback=taskWrapper.getCallback();
        if (callback != null) {
          callback.notify(taskStatus);
        }
        new CleanupPaths(worker.getHost(),taskWrapper.getTask().getId()).run();
      }
    }
 catch (    Exception e) {
      log.error(e,"Task exists, but hit exception!");
      retryTask(new CleanupPaths(worker.getHost(),taskWrapper.getTask().getId()),taskWrapper);
    }
  }
 else {
    workerWrapper=findWorkerForTask();
    if (workerWrapper != null) {
      announceTask(workerWrapper.getWorker(),taskWrapper);
    }
 else {
      retryTask(null,taskWrapper);
    }
  }
}
