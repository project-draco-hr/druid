{
  try {
    WorkerWrapper workerWrapper=findWorkerRunningTask(taskWrapper);
    if (workerWrapper != null) {
      final Worker worker=workerWrapper.getWorker();
      log.info("Worker[%s] is already running task[%s].",worker.getHost(),taskWrapper.getTask().getId());
      TaskStatus taskStatus=jsonMapper.readValue(workerWrapper.getStatusCache().getCurrentData(JOINER.join(config.getStatusPath(),worker.getHost(),taskWrapper.getTask().getId())).getData(),TaskStatus.class);
      if (taskStatus.isComplete()) {
        TaskCallback callback=taskWrapper.getCallback();
        if (callback != null) {
          callback.notify(taskStatus);
        }
        new CleanupPaths(worker.getHost(),taskWrapper.getTask().getId()).run();
      }
 else {
        tasks.putIfAbsent(taskWrapper.getTask().getId(),taskWrapper);
      }
      return true;
    }
  }
 catch (  Exception e) {
    throw Throwables.propagate(e);
  }
  WorkerWrapper workerWrapper=getWorkerForTask();
  if (workerWrapper != null) {
    announceTask(workerWrapper.getWorker(),taskWrapper);
    return true;
  }
  return false;
}
