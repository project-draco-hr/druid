{
  final LookupExtractor lookupExtractor=Strings.isNullOrEmpty(name) ? this.lookup : Preconditions.checkNotNull(this.lookupReferencesManager.get(name).get(),"can not find lookup with name [%s]",name);
  return new LookupExtractionFn(lookupExtractor,retainMissingValue,replaceMissingValueWith,lookupExtractor.isOneToOne(),optimize);
}
