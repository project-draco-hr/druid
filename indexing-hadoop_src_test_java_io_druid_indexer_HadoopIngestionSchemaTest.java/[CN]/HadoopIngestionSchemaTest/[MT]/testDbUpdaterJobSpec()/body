{
  final HadoopIngestionSchema schema;
  schema=jsonReadWriteRead("{" + "\"updaterJobSpec\":{\n" + "    \"type\" : \"db\",\n"+ "    \"connectURI\" : \"jdbc:mysql://localhost/druid\",\n"+ "    \"user\" : \"rofl\",\n"+ "    \"password\" : \"p4ssw0rd\",\n"+ "    \"segmentTable\" : \"segments\"\n"+ "  }"+ "}",HadoopIngestionSchema.class);
  final DbUpdaterJobSpec spec=schema.getIOConfig().getMetadataUpdateSpec();
  final DbConnectorConfig connectorConfig=spec.get();
  Assert.assertEquals("segments",spec.getSegmentTable());
  Assert.assertEquals("jdbc:mysql://localhost/druid",connectorConfig.getConnectURI());
  Assert.assertEquals("rofl",connectorConfig.getUser());
  Assert.assertEquals("p4ssw0rd",connectorConfig.getPassword());
  Assert.assertEquals(false,connectorConfig.isUseValidationQuery());
}
