{
  final HadoopIngestionSchema schema;
  try {
    schema=jsonReadWriteRead("{" + "\"segmentGranularity\":\"day\"," + "\"intervals\":[\"2012-02-01/P1D\"]"+ "}",HadoopIngestionSchema.class);
  }
 catch (  Exception e) {
    throw Throwables.propagate(e);
  }
  final UniformGranularitySpec granularitySpec=(UniformGranularitySpec)schema.getDataSchema().getGranularitySpec();
  Assert.assertEquals("getIntervals",Lists.newArrayList(new Interval("2012-02-01/P1D")),granularitySpec.getIntervals().get());
  Assert.assertEquals("getSegmentGranularity","DAY",granularitySpec.getSegmentGranularity().toString());
}
