{
  exec.submit(new Runnable(){
    @Override public void run(){
      final long startTime=System.currentTimeMillis();
      final File taskDir=toolbox.getConfig().getTaskDir(task);
      TaskStatus status;
      try {
        status=task.run(context,toolbox,callback);
      }
 catch (      InterruptedException e) {
        log.error(e,"Interrupted while running task[%s]",task);
        throw Throwables.propagate(e);
      }
catch (      Exception e) {
        log.error(e,"Exception while running task[%s]",task);
        status=TaskStatus.failure(task.getId());
      }
catch (      Throwable t) {
        log.error(t,"Uncaught Throwable while running task[%s]",task);
        throw Throwables.propagate(t);
      }
      try {
        if (taskDir.exists()) {
          log.info("Removing task directory: %s",taskDir);
          FileUtils.deleteDirectory(taskDir);
        }
      }
 catch (      Exception e) {
        log.error(e,"Failed to delete task directory[%s]",taskDir.toString());
      }
      try {
        callback.notify(status.withDuration(System.currentTimeMillis() - startTime));
      }
 catch (      Exception e) {
        log.error(e,"Uncaught Exception during callback for task[%s]",task);
        throw Throwables.propagate(e);
      }
    }
  }
);
}
