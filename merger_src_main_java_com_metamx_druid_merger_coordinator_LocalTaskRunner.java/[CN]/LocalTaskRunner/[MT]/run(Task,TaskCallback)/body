{
  final TaskToolbox toolbox=toolboxFactory.build(task);
  exec.submit(new Runnable(){
    @Override public void run(){
      final long startTime=System.currentTimeMillis();
      TaskStatus status;
      try {
        log.info("Running task: %s",task.getId());
        status=task.run(toolbox);
      }
 catch (      InterruptedException e) {
        log.error(e,"Interrupted while running task[%s]",task);
        throw Throwables.propagate(e);
      }
catch (      Exception e) {
        log.error(e,"Exception while running task[%s]",task);
        status=TaskStatus.failure(task.getId());
      }
catch (      Throwable t) {
        log.error(t,"Uncaught Throwable while running task[%s]",task);
        throw Throwables.propagate(t);
      }
      try {
        final File taskDir=toolbox.getTaskDir();
        if (taskDir.exists()) {
          log.info("Removing task directory: %s",taskDir);
          FileUtils.deleteDirectory(taskDir);
        }
      }
 catch (      Exception e) {
        log.error(e,"Failed to delete task directory: %s",task.getId());
      }
      try {
        callback.notify(status.withDuration(System.currentTimeMillis() - startTime));
      }
 catch (      Exception e) {
        log.error(e,"Uncaught Exception during callback for task[%s]",task);
        throw Throwables.propagate(e);
      }
    }
  }
);
}
