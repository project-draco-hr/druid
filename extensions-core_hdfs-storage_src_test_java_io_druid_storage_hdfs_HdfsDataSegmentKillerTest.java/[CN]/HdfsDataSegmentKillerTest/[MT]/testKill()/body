{
  Configuration config=new Configuration();
  HdfsDataSegmentKiller killer=new HdfsDataSegmentKiller(config);
  FileSystem fs=FileSystem.get(config);
  Path dataSourceDir=new Path("/tmp/dataSource");
  Path interval1Dir=new Path(dataSourceDir,"interval1");
  Path version11Dir=new Path(interval1Dir,"v1");
  Path partition011Dir=new Path(version11Dir,"0");
  Path partition111Dir=new Path(version11Dir,"1");
  makePartitionDirWithIndex(fs,partition011Dir);
  makePartitionDirWithIndex(fs,partition111Dir);
  Path version21Dir=new Path(interval1Dir,"v2");
  Path partition021Dir=new Path(version21Dir,"0");
  makePartitionDirWithIndex(fs,partition021Dir);
  Path interval2Dir=new Path(dataSourceDir,"interval2");
  Path version12Dir=new Path(interval2Dir,"v1");
  Path partition012Dir=new Path(version12Dir,"0");
  makePartitionDirWithIndex(fs,partition012Dir);
  killer.kill(getSegmentWithPath(new Path(partition011Dir,"index.zip").toString()));
  Assert.assertFalse(fs.exists(partition011Dir));
  Assert.assertTrue(fs.exists(partition111Dir));
  Assert.assertTrue(fs.exists(partition021Dir));
  Assert.assertTrue(fs.exists(partition012Dir));
  killer.kill(getSegmentWithPath(new Path(partition111Dir,"index.zip").toString()));
  Assert.assertFalse(fs.exists(version11Dir));
  Assert.assertTrue(fs.exists(partition021Dir));
  Assert.assertTrue(fs.exists(partition012Dir));
  killer.kill(getSegmentWithPath(new Path(partition021Dir,"index.zip").toString()));
  Assert.assertFalse(fs.exists(interval1Dir));
  Assert.assertTrue(fs.exists(partition012Dir));
  killer.kill(getSegmentWithPath(new Path(partition012Dir,"index.zip").toString()));
  Assert.assertFalse(fs.exists(dataSourceDir));
}
