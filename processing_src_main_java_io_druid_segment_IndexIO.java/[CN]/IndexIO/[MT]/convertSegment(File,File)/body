{
  final int version=SegmentUtils.getVersionFromDir(toConvert);
switch (version) {
case 1:
case 2:
case 3:
    log.makeAlert("Attempt to load segment of version <= 3.").addData("version",version).emit();
  return false;
case 4:
case 5:
case 6:
case 7:
log.info("Old version, re-persisting.");
IndexMaker.append(Arrays.<IndexableAdapter>asList(new QueryableIndexIndexableAdapter(loadIndex(toConvert))),converted);
return true;
case 8:
DefaultIndexIOHandler.convertV8toV9(toConvert,converted);
return true;
default :
log.info("Version[%s], skipping.",version);
return false;
}
}
