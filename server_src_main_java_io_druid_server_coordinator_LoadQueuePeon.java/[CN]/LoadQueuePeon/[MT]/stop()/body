{
synchronized (lock) {
    if (currentlyProcessing != null) {
      currentlyProcessing.executeCallbacks();
      currentlyProcessing=null;
    }
    if (!segmentsToDrop.isEmpty()) {
      for (      SegmentHolder holder : segmentsToDrop.values()) {
        holder.executeCallbacks();
      }
    }
    segmentsToDrop.clear();
    if (!segmentsToLoad.isEmpty()) {
      for (      SegmentHolder holder : segmentsToLoad.values()) {
        holder.executeCallbacks();
      }
    }
    segmentsToLoad.clear();
    queuedSize.set(0L);
    failedAssignCount.set(0);
  }
}
