{
  try {
    serverManager.loadSegment(segment);
    File segmentInfoCacheFile=new File(config.getInfoDir(),segment.getIdentifier());
    try {
      jsonMapper.writeValue(segmentInfoCacheFile,segment);
    }
 catch (    IOException e) {
      removeSegment(segment);
      throw new SegmentLoadingException(e,"Failed to write to disk segment info cache file[%s]",segmentInfoCacheFile);
    }
    try {
      announcer.announceSegment(segment);
    }
 catch (    IOException e) {
      removeSegment(segment);
      throw new SegmentLoadingException(e,"Failed to announce segment[%s]",segment.getIdentifier());
    }
  }
 catch (  SegmentLoadingException e) {
    log.makeAlert(e,"Failed to load segment for dataSource").addData("segment",segment).emit();
  }
}
