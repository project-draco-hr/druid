{
  try {
    serverManager.loadSegment(segment);
    File segmentInfoCacheFile=new File(config.getSegmentInfoCacheDirectory(),segment.getIdentifier());
    try {
      jsonMapper.writeValue(segmentInfoCacheFile,segment);
    }
 catch (    IOException e) {
      removeSegment(segment);
      throw new SegmentLoadingException("Failed to write to disk segment info cache file[%s]",segmentInfoCacheFile);
    }
    announcer.announce(makeSegmentPath(segment),jsonMapper.writeValueAsBytes(segment));
  }
 catch (  SegmentLoadingException e) {
    log.makeAlert(e,"Failed to load segment for dataSource").addData("segment",segment).emit();
  }
catch (  JsonProcessingException e) {
    log.makeAlert(e,"WTF, exception writing into byte[]???").addData("segment",segment).emit();
  }
}
