{
  File baseDir=config.getSegmentInfoCacheDirectory();
  if (!baseDir.exists()) {
    return;
  }
  List<DataSegment> cachedSegments=Lists.newArrayList();
  for (  File file : baseDir.listFiles()) {
    log.info("Loading segment cache file [%s]",file);
    try {
      DataSegment segment=jsonMapper.readValue(file,DataSegment.class);
      if (serverManager.isSegmentCached(segment)) {
        cachedSegments.add(segment);
      }
 else {
        log.warn("Unable to find cache file for %s. Deleting lookup entry",segment.getIdentifier());
        File segmentInfoCacheFile=new File(config.getSegmentInfoCacheDirectory(),segment.getIdentifier());
        if (!segmentInfoCacheFile.delete()) {
          log.warn("Unable to delete segmentInfoCacheFile[%s]",segmentInfoCacheFile);
        }
      }
    }
 catch (    Exception e) {
      log.makeAlert(e,"Failed to load segment from segmentInfo file").addData("file",file).emit();
    }
  }
  addSegments(cachedSegments);
}
