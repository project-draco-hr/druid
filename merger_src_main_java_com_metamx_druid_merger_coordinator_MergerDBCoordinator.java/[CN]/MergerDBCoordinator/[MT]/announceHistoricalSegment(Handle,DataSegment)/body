{
  try {
    final List<Map<String,Object>> exists=handle.createQuery(String.format("SELECT id FROM %s WHERE id = :identifier",dbConnectorConfig.getSegmentTable())).bind("identifier",segment.getIdentifier()).list();
    if (!exists.isEmpty()) {
      log.info("Found [%s] in DB, not updating DB",segment.getIdentifier());
      return false;
    }
    handle.createStatement(String.format("INSERT INTO %s (id, dataSource, created_date, start, end, partitioned, version, used, payload) VALUES (:id, :dataSource, :created_date, :start, :end, :partitioned, :version, :used, :payload)",dbConnectorConfig.getSegmentTable())).bind("id",segment.getIdentifier()).bind("dataSource",segment.getDataSource()).bind("created_date",new DateTime().toString()).bind("start",segment.getInterval().getStart().toString()).bind("end",segment.getInterval().getEnd().toString()).bind("partitioned",segment.getShardSpec().getPartitionNum()).bind("version",segment.getVersion()).bind("used",true).bind("payload",jsonMapper.writeValueAsString(segment)).execute();
    log.info("Published segment [%s] to DB",segment.getIdentifier());
  }
 catch (  IOException e) {
    log.error(e,"Exception inserting into DB");
    throw e;
  }
  return true;
}
