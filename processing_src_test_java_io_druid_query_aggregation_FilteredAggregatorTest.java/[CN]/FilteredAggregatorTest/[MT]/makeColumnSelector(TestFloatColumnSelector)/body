{
  return new ColumnSelectorFactory(){
    @Override public DimensionSelector makeDimensionSelector(    String dimensionName,    ExtractionFn extractionFn){
      if (dimensionName.equals("dim")) {
        return new DimensionSelector(){
          @Override public IndexedInts getRow(){
            if (selector.getIndex() % 3 == 2) {
              return new ArrayBasedIndexedInts(new int[]{1});
            }
 else {
              return new ArrayBasedIndexedInts(new int[]{0});
            }
          }
          @Override public int getValueCardinality(){
            return 2;
          }
          @Override public String lookupName(          int id){
switch (id) {
case 0:
              return "a";
case 1:
            return "b";
default :
          throw new IllegalArgumentException();
      }
    }
    @Override public int lookupId(    String name){
switch (name) {
case "a":
        return 0;
case "b":
      return 1;
default :
    throw new IllegalArgumentException();
}
}
}
;
}
 else {
throw new UnsupportedOperationException();
}
}
@Override public LongColumnSelector makeLongColumnSelector(String columnName){
throw new UnsupportedOperationException();
}
@Override public FloatColumnSelector makeFloatColumnSelector(String columnName){
if (columnName.equals("value")) {
return selector;
}
 else {
throw new UnsupportedOperationException();
}
}
@Override public ObjectColumnSelector makeObjectColumnSelector(String columnName){
throw new UnsupportedOperationException();
}
}
;
}
