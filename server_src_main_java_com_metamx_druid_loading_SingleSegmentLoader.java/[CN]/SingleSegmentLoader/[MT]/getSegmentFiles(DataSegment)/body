{
  File cacheFile=getCacheFile(segment);
  if (cacheFile.exists()) {
    long localLastModified=cacheFile.lastModified();
    long remoteLastModified=dataSegmentPuller.getLastModified(segment);
    if (remoteLastModified > 0 && localLastModified >= remoteLastModified) {
      log.info("Found cacheFile[%s] with modified[%s], which is same or after remote[%s].  Using.",cacheFile,localLastModified,remoteLastModified);
      return cacheFile;
    }
  }
  dataSegmentPuller.getSegmentFiles(segment,cacheFile);
  if (!cacheFile.getParentFile().mkdirs()) {
    log.info("Unable to make parent file[%s]",cacheFile.getParentFile());
  }
  if (cacheFile.exists()) {
    cacheFile.delete();
  }
  return cacheFile;
}
