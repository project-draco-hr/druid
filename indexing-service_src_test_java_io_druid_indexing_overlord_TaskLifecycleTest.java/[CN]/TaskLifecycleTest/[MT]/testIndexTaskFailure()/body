{
  final Task indexTask=new IndexTask(null,null,"foo",new UniformGranularitySpec(Granularity.DAY,null,ImmutableList.of(new Interval("2010-01-01/P1D")),Granularity.DAY),new AggregatorFactory[]{new DoubleSumAggregatorFactory("met","met")},QueryGranularity.NONE,10000,newMockExceptionalFirehoseFactory(),-1,TestUtils.MAPPER);
  final TaskStatus status=runTask(indexTask);
  Assert.assertEquals("statusCode",TaskStatus.Status.FAILED,status.getStatusCode());
  Assert.assertEquals("num segments published",0,mdc.getPublished().size());
  Assert.assertEquals("num segments nuked",0,mdc.getNuked().size());
}
