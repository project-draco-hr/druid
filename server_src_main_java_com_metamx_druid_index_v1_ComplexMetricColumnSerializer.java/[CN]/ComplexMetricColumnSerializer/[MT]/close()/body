{
  writer.close();
  final File littleEndianFile=IndexIO.makeMetricFile(outDir,metricName,ByteOrder.LITTLE_ENDIAN);
  littleEndianFile.delete();
  MetricHolder.writeComplexMetric(Files.newOutputStreamSupplier(littleEndianFile,true),metricName,serde.getTypeName(),writer);
  IndexIO.checkFileSize(littleEndianFile);
  final File bigEndianFile=IndexIO.makeMetricFile(outDir,metricName,ByteOrder.BIG_ENDIAN);
  ByteStreams.copy(Files.newInputStreamSupplier(littleEndianFile),Files.newOutputStreamSupplier(bigEndianFile,false));
  writer=null;
}
