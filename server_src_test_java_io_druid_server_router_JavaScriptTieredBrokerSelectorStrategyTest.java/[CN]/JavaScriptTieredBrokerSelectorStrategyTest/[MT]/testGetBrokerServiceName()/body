{
  final LinkedHashMap<String,String> tierBrokerMap=new LinkedHashMap<>();
  tierBrokerMap.put("fast","druid/fastBroker");
  tierBrokerMap.put("slow","druid/broker");
  final TieredBrokerConfig tieredBrokerConfig=new TieredBrokerConfig(){
    @Override public String getDefaultBrokerServiceName(){
      return "druid/broker";
    }
    @Override public LinkedHashMap<String,String> getTierToBrokerMap(){
      return tierBrokerMap;
    }
  }
;
  final Druids.TimeseriesQueryBuilder queryBuilder=Druids.newTimeseriesQueryBuilder().dataSource("test").intervals("2014/2015").aggregators(ImmutableList.<AggregatorFactory>of(new CountAggregatorFactory("count")));
  Assert.assertEquals(Optional.of("druid/fastBroker"),jsStrategy.getBrokerServiceName(tieredBrokerConfig,queryBuilder.build()));
  Assert.assertEquals(Optional.of("druid/broker"),jsStrategy.getBrokerServiceName(tieredBrokerConfig,Druids.newTimeBoundaryQueryBuilder().dataSource("test").bound("maxTime").build()));
  Assert.assertEquals(Optional.of("druid/broker"),jsStrategy.getBrokerServiceName(tieredBrokerConfig,queryBuilder.aggregators(ImmutableList.of(new CountAggregatorFactory("count"),new LongSumAggregatorFactory("longSum","a"),new DoubleSumAggregatorFactory("doubleSum","b"))).build()));
}
