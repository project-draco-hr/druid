{
  List<DataSegment> segments=getSegmentsForDatasources().get(dataSourceName);
  if (interval == null) {
    DateTime now=new DateTime();
    interval=new Interval(now.minusMillis(SEGMENT_HISTORY_MILLIS),now);
  }
  Set<String> metrics=Sets.newHashSet();
  for (  DataSegment segment : segments) {
    if (interval.overlaps(segment.getInterval())) {
      metrics.addAll(segment.getMetrics());
    }
  }
  return metrics;
}
