{
  StringBuilder sb=new StringBuilder();
  sb.append("{\"paths\" : \"");
  sb.append(path);
  sb.append("\",");
  if (inputFormat != null) {
    sb.append("\"inputFormat\" : \"");
    sb.append(inputFormat.getName());
    sb.append("\",");
  }
  sb.append("\"type\" : \"static\"}");
  StaticPathSpec pathSpec=(StaticPathSpec)jsonMapper.readValue(sb.toString(),PathSpec.class);
  Assert.assertEquals(inputFormat,pathSpec.getInputFormat());
  Job job=Job.getInstance();
  pathSpec.addInputPaths(null,job);
  Assert.assertEquals("file:" + path,job.getConfiguration().get(FileInputFormat.INPUT_DIR));
}
