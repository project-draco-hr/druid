{
  if (!endBuffer.hasRemaining()) {
    endBuffer.rewind();
    compressedBuffers.add(strategy.toBytes(StupidResourceHolder.create(endBuffer)));
    endBuffer=LongBuffer.allocate(sizePer);
    endBuffer.mark();
    numCompressed+=sizePer;
  }
  int retVal=numCompressed + endBuffer.position();
  endBuffer.put(value);
  ++numInserted;
  return retVal;
}
