{
  if (includeCurrentServer || !server.isServingSegment(proposalSegment)) {
    final long proposalSegmentSize=proposalSegment.getSize();
    if (proposalSegmentSize > server.getAvailableSize() || server.isLoadingSegment(proposalSegment)) {
      return Pair.of(Double.POSITIVE_INFINITY,null);
    }
    double cost=0f;
    for (    DataSegment segment : server.getServer().getSegments().values()) {
      if (!proposalSegment.equals(segment)) {
        cost+=computeJointSegmentCosts(proposalSegment,segment);
      }
    }
    for (    DataSegment segment : server.getPeon().getSegmentsToLoad()) {
      cost+=computeJointSegmentCosts(proposalSegment,segment);
    }
    return Pair.of(cost,server);
  }
  return Pair.of(Double.POSITIVE_INFINITY,null);
}
