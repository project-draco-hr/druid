{
  if (!taskLockCoversSegments(task,segments,allowOlderVersions)) {
    throw new ISE("Segments not covered by locks for task: %s",task.getId());
  }
  if (!segmentsAreFromSamePartitionSet(segments)) {
    throw new ISE("Segments are not in the same partition set: %s",segments);
  }
}
