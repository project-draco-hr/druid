{
  LogLevelAdjuster.register();
  Injector injector=Initialization.makeInjector(new LifecycleModule(Key.get(MonitorScheduler.class),Key.get(DruidMaster.class)),EmitterModule.class,HttpClientModule.class,CuratorModule.class,new MetricsModule(),DiscoveryModule.class,ServerModule.class,new JettyServerModule(new MasterJettyServerInitializer()),MasterModule.class);
  final Lifecycle lifecycle=injector.getInstance(Lifecycle.class);
  final DruidNodeConfig nodeConfig=injector.getInstance(DruidNodeConfig.class);
  final ServiceAnnouncer serviceAnnouncer=injector.getInstance(ServiceAnnouncer.class);
  try {
    lifecycle.start();
    Initialization.announceDefaultService(nodeConfig,serviceAnnouncer,lifecycle);
  }
 catch (  Throwable t) {
    log.error(t,"Error when starting up.  Failing.");
    System.exit(1);
  }
  lifecycle.join();
}
