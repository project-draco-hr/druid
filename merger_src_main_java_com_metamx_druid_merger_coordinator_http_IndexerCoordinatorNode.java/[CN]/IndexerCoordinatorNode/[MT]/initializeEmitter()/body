{
  if (emitter == null) {
    final HttpClient httpClient=HttpClientInit.createClient(HttpClientConfig.builder().withNumConnections(1).withReadTimeout(new Duration(PropUtils.getProperty(props,"druid.emitter.timeOut"))).build(),lifecycle);
    emitter=new ServiceEmitter(PropUtils.getProperty(props,"druid.service"),PropUtils.getProperty(props,"druid.host"),Emitters.create(props,httpClient,getJsonMapper(),lifecycle));
  }
  EmittingLogger.registerEmitter(emitter);
}
