{
  if (taskStorage == null) {
    if (config.getStorageImpl().equals("local")) {
      taskStorage=new HeapMemoryTaskStorage();
    }
 else     if (config.getStorageImpl().equals("db")) {
      final IndexerDbConnectorConfig dbConnectorConfig=configFactory.build(IndexerDbConnectorConfig.class);
      taskStorage=new DbTaskStorage(jsonMapper,dbConnectorConfig,new DbConnector(dbConnectorConfig).getDBI());
    }
 else {
      throw new ISE("Invalid storage implementation: %s",config.getStorageImpl());
    }
  }
}
