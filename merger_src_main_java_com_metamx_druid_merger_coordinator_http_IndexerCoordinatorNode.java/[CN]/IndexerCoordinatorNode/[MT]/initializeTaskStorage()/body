{
  if (taskStorage == null) {
    if (config.getStorageImpl().equals("local")) {
      taskStorage=new LocalTaskStorage();
    }
 else     if (config.getStorageImpl().equals("db")) {
      final IndexerDbConnectorConfig dbConnectorConfig=configFactory.build(IndexerDbConnectorConfig.class);
      taskStorage=new DbTaskStorage(jsonMapper,dbConnectorConfig,new DbConnector(dbConnectorConfig).getDBI());
    }
 else {
      throw new IllegalStateException(String.format("Invalid storage implementation: %s",config.getStorageImpl()));
    }
  }
}
