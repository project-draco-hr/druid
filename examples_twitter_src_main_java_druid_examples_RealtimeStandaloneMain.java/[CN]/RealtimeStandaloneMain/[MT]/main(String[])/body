{
  LogLevelAdjuster.register();
  final Lifecycle lifecycle=new Lifecycle();
  RealtimeNode rn=RealtimeNode.builder().build();
  lifecycle.addManagedInstance(rn);
  rn.registerJacksonSubtype(new NamedType(TwitterSpritzerFirehoseFactory.class,"twitzer"));
  final SegmentAnnouncer dummySegmentAnnouncer=new SegmentAnnouncer(){
    @Override public void announceSegment(    DataSegment segment) throws IOException {
    }
    @Override public void unannounceSegment(    DataSegment segment) throws IOException {
    }
  }
;
  SegmentPublisher dummySegmentPublisher=new SegmentPublisher(){
    @Override public void publishSegment(    DataSegment segment) throws IOException {
    }
  }
;
  rn.setSegmentAnnouncer(dummySegmentAnnouncer);
  rn.setSegmentPublisher(dummySegmentPublisher);
  rn.setDataSegmentPusher(new DataSegmentPusher(){
    @Override public DataSegment push(    File file,    DataSegment segment) throws IOException {
      return segment;
    }
  }
);
  Runtime.getRuntime().addShutdownHook(new Thread(new Runnable(){
    @Override public void run(){
      log.info("Running shutdown hook");
      lifecycle.stop();
    }
  }
));
  try {
    lifecycle.start();
  }
 catch (  Throwable t) {
    log.info(t,"Throwable caught at startup, committing seppuku");
    t.printStackTrace();
    System.exit(2);
  }
  lifecycle.join();
}
