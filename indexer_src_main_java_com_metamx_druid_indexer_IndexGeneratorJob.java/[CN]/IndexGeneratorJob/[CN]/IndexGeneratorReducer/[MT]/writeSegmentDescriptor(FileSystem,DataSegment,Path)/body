{
  if (outputFS.exists(descriptorPath)) {
    outputFS.delete(descriptorPath,false);
  }
  final FSDataOutputStream descriptorOut=outputFS.create(descriptorPath);
  try {
    HadoopDruidIndexerConfig.jsonMapper.writeValue(descriptorOut,segment);
  }
  finally {
    descriptorOut.close();
  }
}
