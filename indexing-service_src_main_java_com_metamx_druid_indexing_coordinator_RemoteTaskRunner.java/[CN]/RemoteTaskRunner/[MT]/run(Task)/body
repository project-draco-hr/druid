{
  RemoteTaskRunnerWorkItem runningTask=runningTasks.get(task.getId());
  if (runningTask != null) {
    log.info("Assigned a task[%s] that is already running, not doing anything",task.getId());
    return runningTask.getResult();
  }
  RemoteTaskRunnerWorkItem pendingTask=pendingTasks.get(task.getId());
  if (pendingTask != null) {
    log.info("Assigned a task[%s] that is already pending, not doing anything",task.getId());
    return pendingTask.getResult();
  }
  RemoteTaskRunnerWorkItem taskRunnerWorkItem=new RemoteTaskRunnerWorkItem(task,SettableFuture.<TaskStatus>create());
  addPendingTask(taskRunnerWorkItem);
  return taskRunnerWorkItem.getResult();
}
