{
  if (pendingTasks.containsKey(taskId)) {
    pendingTasks.remove(taskId);
    return;
  }
  final ZkWorker zkWorker=findWorkerRunningTask(taskId);
  if (zkWorker == null) {
    log.info("Can't shutdown! No worker running task %s",taskId);
    return;
  }
  try {
    final URL url=makeWorkerURL(zkWorker.getWorker(),String.format("/task/%s/shutdown",taskId));
    final StatusResponseHolder response=httpClient.post(url).go(RESPONSE_HANDLER).get();
    log.info("Sent shutdown message to worker: %s, status %s, response: %s",zkWorker.getWorker().getHost(),response.getStatus(),response.getContent());
    if (!response.getStatus().equals(HttpResponseStatus.ACCEPTED)) {
      throw new ISE("Shutdown failed");
    }
  }
 catch (  Exception e) {
    throw Throwables.propagate(e);
  }
}
