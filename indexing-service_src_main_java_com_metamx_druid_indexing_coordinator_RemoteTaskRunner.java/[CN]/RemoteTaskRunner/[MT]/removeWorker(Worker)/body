{
  ZkWorker zkWorker=zkWorkers.get(worker.getHost());
  if (zkWorker != null) {
    try {
      Set<String> tasksToRetry=Sets.newHashSet(cf.getChildren().forPath(JOINER.join(config.getIndexerTaskPath(),worker.getHost())));
      tasksToRetry.addAll(cf.getChildren().forPath(JOINER.join(config.getIndexerStatusPath(),worker.getHost())));
      log.info("%s has %d tasks to retry",worker.getHost(),tasksToRetry.size());
      for (      String taskId : tasksToRetry) {
        TaskRunnerWorkItem taskRunnerWorkItem=runningTasks.get(taskId);
        if (taskRunnerWorkItem != null) {
          String taskPath=JOINER.join(config.getIndexerTaskPath(),worker.getHost(),taskId);
          if (cf.checkExists().forPath(taskPath) != null) {
            cf.delete().guaranteed().forPath(taskPath);
          }
          retryTask(taskRunnerWorkItem);
        }
 else {
          log.warn("RemoteTaskRunner has no knowledge of task %s",taskId);
        }
      }
      zkWorker.close();
    }
 catch (    Exception e) {
      throw Throwables.propagate(e);
    }
 finally {
      zkWorkers.remove(worker.getHost());
    }
  }
}
