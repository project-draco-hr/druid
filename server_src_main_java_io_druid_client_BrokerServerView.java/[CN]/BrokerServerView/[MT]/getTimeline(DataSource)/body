{
  final List<String> tables=dataSource.getNames();
synchronized (lock) {
    if (tables.size() == 1) {
      return timelines.get(tables.get(0));
    }
 else {
      return new UnionTimeLineLookup<>(Iterables.transform(tables,new Function<String,TimelineLookup<String,ServerSelector>>(){
        @Override public TimelineLookup<String,ServerSelector> apply(        String input){
          return timelines.get(input);
        }
      }
));
    }
  }
}
