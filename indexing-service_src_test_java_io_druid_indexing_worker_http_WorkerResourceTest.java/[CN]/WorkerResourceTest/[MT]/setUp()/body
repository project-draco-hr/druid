{
  testingCluster=new TestingCluster(1);
  testingCluster.start();
  cf=CuratorFrameworkFactory.builder().connectString(testingCluster.getConnectString()).retryPolicy(new ExponentialBackoffRetry(1,10)).compressionProvider(new PotentiallyGzippedCompressionProvider(false)).build();
  cf.start();
  cf.create().creatingParentsIfNeeded().forPath(basePath);
  worker=new Worker("host","ip",3,"v1");
  curatorCoordinator=new WorkerCuratorCoordinator(jsonMapper,new IndexerZkConfig().setZkPathsConfig(new ZkPathsConfig(){
    @Override public String getBase(){
      return basePath;
    }
  }
),new RemoteTaskRunnerConfig(),cf,worker);
  curatorCoordinator.start();
  workerResource=new WorkerResource(worker,curatorCoordinator,null);
}
