{
  final List<List<DataSegment>> retVal=Lists.newArrayList();
  final MergerClient mergerClient=new MergerClient(){
    @Override public void runRequest(    String dataSource,    List<DataSegment> segmentsToMerge){
      retVal.add(segmentsToMerge);
    }
  }
;
  final DruidMasterSegmentMerger merger=new DruidMasterSegmentMerger(mergerClient);
  final DruidMasterRuntimeParams params=DruidMasterRuntimeParams.newBuilder().withAvailableSegments(ImmutableSet.copyOf(segments)).withMergeThreshold(mergeThreshold).build();
  merger.run(params);
  return retVal;
}
