{
synchronized (lock) {
    try {
      if (!started) {
        throw new ISE("Must start WorkerSetupManager first!");
      }
      dbi.withHandle(new HandleCallback<Void>(){
        @Override public Void withHandle(        Handle handle) throws Exception {
          handle.createStatement(String.format("DELETE FROM %s",config.getWorkerSetupTable())).execute();
          handle.createStatement(String.format("INSERT INTO %s (config) VALUES (:config)",config.getWorkerSetupTable())).bind("config",jsonMapper.writeValueAsString(value)).execute();
          return null;
        }
      }
);
      workerSetupData.set(value);
    }
 catch (    Exception e) {
      log.error(e,"Exception updating worker config");
      return false;
    }
  }
  return true;
}
