{
  try {
    List<WorkerSetupData> setupDataList=dbi.withHandle(new HandleCallback<List<WorkerSetupData>>(){
      @Override public List<WorkerSetupData> withHandle(      Handle handle) throws Exception {
        return handle.createQuery(String.format("SELECT payload FROM %s WHERE name = :name",config.getConfigTable())).bind("name",config.getWorkerSetupConfigName()).fold(Lists.<WorkerSetupData>newArrayList(),new Folder3<ArrayList<WorkerSetupData>,Map<String,Object>>(){
          @Override public ArrayList<WorkerSetupData> fold(          ArrayList<WorkerSetupData> workerNodeConfigurations,          Map<String,Object> stringObjectMap,          FoldController foldController,          StatementContext statementContext) throws SQLException {
            try {
              workerNodeConfigurations.add(jsonMapper.readValue(MapUtils.getString(stringObjectMap,"payload"),WorkerSetupData.class));
              return workerNodeConfigurations;
            }
 catch (            Exception e) {
              throw Throwables.propagate(e);
            }
          }
        }
);
      }
    }
);
    if (setupDataList.isEmpty()) {
      throw new ISE("WTF?! No configuration found for worker nodes!");
    }
 else     if (setupDataList.size() != 1) {
      throw new ISE("WTF?! Found more than one configuration for worker nodes");
    }
    workerSetupData.set(setupDataList.get(0));
  }
 catch (  Exception e) {
    log.error(e,"Exception while polling for worker setup data!");
  }
}
