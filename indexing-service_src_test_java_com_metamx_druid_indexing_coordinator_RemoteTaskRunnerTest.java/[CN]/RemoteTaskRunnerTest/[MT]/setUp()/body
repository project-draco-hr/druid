{
  testingCluster=new TestingCluster(1);
  testingCluster.start();
  cf=CuratorFrameworkFactory.builder().connectString(testingCluster.getConnectString()).retryPolicy(new ExponentialBackoffRetry(1,10)).compressionProvider(new PotentiallyGzippedCompressionProvider(false)).build();
  cf.start();
  cf.create().creatingParentsIfNeeded().forPath(announcementsPath);
  cf.create().forPath(tasksPath);
  cf.create().forPath(String.format("%s/worker1",tasksPath));
  cf.create().forPath(statusPath);
  cf.create().forPath(String.format("%s/worker1",statusPath));
  pathChildrenCache=new PathChildrenCache(cf,announcementsPath,true);
  worker1=new Worker("worker1","localhost",3,"0");
  task1=new TestTask("task1","dummyDs",Lists.<DataSegment>newArrayList(new DataSegment("dummyDs",new Interval(new DateTime(),new DateTime()),new DateTime().toString(),null,null,null,null,0,0)),Lists.<AggregatorFactory>newArrayList(),TaskStatus.success("task1"));
  makeRemoteTaskRunner();
  makeTaskMonitor();
}
