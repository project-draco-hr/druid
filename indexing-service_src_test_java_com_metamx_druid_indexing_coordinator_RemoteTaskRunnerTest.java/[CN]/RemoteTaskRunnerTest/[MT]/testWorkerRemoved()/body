{
  doSetup();
  remoteTaskRunner.bootstrap(Lists.<Task>newArrayList());
  Future<TaskStatus> future=remoteTaskRunner.run(makeTask(TaskStatus.running("task")));
  Stopwatch stopwatch=new Stopwatch();
  stopwatch.start();
  while (cf.checkExists().forPath(joiner.join(statusPath,"task")) == null) {
    Thread.sleep(100);
    if (stopwatch.elapsed(TimeUnit.MILLISECONDS) > 1000) {
      throw new ISE("Cannot find running task");
    }
  }
  workerCuratorCoordinator.stop();
  TaskStatus status=future.get();
  Assert.assertEquals(TaskStatus.Status.FAILED,status.getStatusCode());
}
