{
  workerCuratorCoordinator=new WorkerCuratorCoordinator(jsonMapper,new IndexerZkConfig(){
    @Override public String getZkBasePath(){
      return basePath;
    }
    @Override public long getMaxNumBytes(){
      return 1000;
    }
  }
,cf,worker);
  workerCuratorCoordinator.start();
  workerTaskMonitor=new WorkerTaskMonitor(jsonMapper,new PathChildrenCache(cf,tasksPath,true),cf,workerCuratorCoordinator,new ThreadPoolTaskRunner(new TaskToolboxFactory(new TaskConfig(){
    @Override public String getBaseDir(){
      File tmp=Files.createTempDir();
      tmp.deleteOnExit();
      return tmp.toString();
    }
    @Override public int getDefaultRowFlushBoundary(){
      return 0;
    }
    @Override public String getHadoopWorkingPath(){
      return null;
    }
  }
,null,null,null,null,null,null,null,null,null,jsonMapper),Executors.newSingleThreadExecutor()),Executors.newSingleThreadExecutor());
  jsonMapper.registerSubtypes(new NamedType(TestTask.class,"test"));
  jsonMapper.registerSubtypes(new NamedType(TestRealtimeTask.class,"test_realtime"));
  workerTaskMonitor.start();
}
