{
  final List<List<DataSegment>> retVal=Lists.newArrayList();
  final IndexingServiceClient indexingServiceClient=new IndexingServiceClient(null,null,null){
    @Override public void mergeSegments(    List<DataSegment> segmentsToMerge){
      retVal.add(segmentsToMerge);
    }
  }
;
  final AtomicReference<DatasourceWhitelist> whitelistRef=new AtomicReference<DatasourceWhitelist>(null);
  final DruidCoordinatorSegmentMerger merger=new DruidCoordinatorSegmentMerger(indexingServiceClient,whitelistRef);
  final DruidCoordinatorRuntimeParams params=DruidCoordinatorRuntimeParams.newBuilder().withAvailableSegments(ImmutableSet.copyOf(segments)).withDynamicConfigs(new CoordinatorDynamicConfig.Builder().withMergeBytesLimit(mergeBytesLimit).withMergeSegmentsLimit(mergeSegmentsLimit).build()).build();
  merger.run(params);
  return retVal;
}
