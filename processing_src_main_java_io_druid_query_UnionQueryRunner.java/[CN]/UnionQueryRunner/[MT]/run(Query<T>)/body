{
  DataSource dataSource=query.getDataSource();
  if (dataSource instanceof UnionDataSource) {
    System.out.println("Breaking into Single Source" + dataSource.getMetricName());
    return Sequences.concat(Iterables.transform(((UnionDataSource)dataSource).getDataSources(),new Function<DataSource,Sequence<T>>(){
      @Override public Sequence<T> apply(      DataSource singleSource){
        System.out.println("Running with Single Source" + singleSource.getNames());
        return baseRunner.run(query.withDataSource(singleSource));
      }
    }
));
  }
 else {
    return baseRunner.run(query);
  }
}
