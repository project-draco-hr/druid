{
  return new UnionQueryRunner<>(Iterables.transform(query.getDataSource().getNames(),new Function<String,QueryRunner>(){
    @Override public QueryRunner apply(    String queryDataSource){
      QueryRunner<T> queryRunner=null;
      for (      final ThreadPoolTaskRunnerWorkItem taskRunnerWorkItem : ImmutableList.copyOf(runningItems)) {
        final Task task=taskRunnerWorkItem.getTask();
        if (task.getDataSource().equals(queryDataSource)) {
          final QueryRunner<T> taskQueryRunner=task.getQueryRunner(query);
          if (taskQueryRunner != null) {
            if (queryRunner == null) {
              queryRunner=taskQueryRunner;
            }
 else {
              log.makeAlert("Found too many query runners for datasource").addData("dataSource",queryDataSource).emit();
            }
          }
        }
      }
      if (queryRunner != null) {
        return queryRunner;
      }
 else {
        return new NoopQueryRunner();
      }
    }
  }
),conglomerate.findFactory(query).getToolchest());
}
