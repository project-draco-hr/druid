{
  final List<String> dataSources=query.getDataSource().getNames();
  List<QueryRunner> runners=Lists.newArrayList();
  for (  String queryDataSource : dataSources) {
    QueryRunner<T> queryRunner=null;
    for (    final ThreadPoolTaskRunnerWorkItem taskRunnerWorkItem : ImmutableList.copyOf(runningItems)) {
      final Task task=taskRunnerWorkItem.getTask();
      if (task.getDataSource().equals(queryDataSource)) {
        final QueryRunner<T> taskQueryRunner=task.getQueryRunner(query);
        if (taskQueryRunner != null) {
          if (queryRunner == null) {
            queryRunner=taskQueryRunner;
          }
 else {
            log.makeAlert("Found too many query runners for datasource").addData("dataSource",queryDataSource).emit();
          }
        }
      }
    }
    if (queryRunner != null) {
      runners.add(queryRunner);
    }
  }
  if (runners.size() == 0) {
    return new NoopQueryRunner();
  }
 else   if (runners.size() == 1) {
    return runners.get(0);
  }
 else {
    return new UnionQueryRunner<>(runners,conglomerate.findFactory(query).getToolchest());
  }
}
