{
  final String service=serviceName(key);
  log.info("Registering Eventhandler: %s",key);
  if (handlers.putIfAbsent(key,handler) != null) {
    throw new ISE("handler already registered for key: %s",key);
  }
  try {
    serviceAnnouncer.announce(service);
  }
 catch (  Exception e) {
    log.warn(e,"Failed to register service: %s",service);
    handlers.remove(key,handler);
  }
}
