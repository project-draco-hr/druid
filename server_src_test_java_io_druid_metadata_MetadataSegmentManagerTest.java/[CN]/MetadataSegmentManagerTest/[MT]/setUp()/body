{
  dbi=EasyMock.createMock(DBI.class);
  final Supplier<MetadataStorageTablesConfig> dbTables=Suppliers.ofInstance(MetadataStorageTablesConfig.fromBase("test"));
  manager=new SQLMetadataSegmentManager(new DefaultObjectMapper(),Suppliers.ofInstance(new MetadataSegmentManagerConfig()),dbTables,new SQLMetadataConnector(Suppliers.ofInstance(new MetadataStorageConnectorConfig()),dbTables){
    @Override protected String getSerialType(){
      return null;
    }
    @Override protected boolean tableExists(    Handle handle,    String tableName){
      return false;
    }
    @Override public DBI getDBI(){
      return dbi;
    }
  }
);
  DataSegment segment1=jsonMapper.readValue("{\"dataSource\":\"wikipedia_editstream\",\"interval\":" + "\"2012-03-15T00:00:00.000/2012-03-16T00:00:00.000\",\"version\":\"2012-03-16T00:36:30.848Z\"" + ",\"loadSpec\":{\"type\":\"s3_zip\",\"bucket\":\"metamx-kafka-data\",\"key\":"+ "\"wikipedia-editstream/v3/beta-index/y=2012/m=03/d=15/2012-03-16T00:36:30.848Z/0/index"+ ".zip\"},\"dimensions\":\"page,namespace,language,user,anonymous,robot,newPage,unpatrolled,"+ "geo,continent_code,country_name,city,region_lookup,dma_code,area_code,network,postal_code\""+ ",\"metrics\":\"count,delta,variation,added,deleted\",\"shardSpec\":{\"type\":\"none\"},"+ "\"size\":26355195,\"identifier\":\"wikipedia_editstream_2012-03-15T00:00:00.000Z_2012-03-16"+ "T00:00:00.000Z_2012-03-16T00:36:30.848Z\"}",DataSegment.class);
  DataSegment segment2=jsonMapper.readValue("{\"dataSource\":\"twitterstream\",\"interval\":\"2012-01-05T00:00:00.000/2012-01-06T00:00:00.000\"," + "\"version\":\"2012-01-06T22:19:12.565Z\",\"loadSpec\":{\"type\":\"s3_zip\",\"bucket\":" + "\"metamx-twitterstream\",\"key\":\"index/y=2012/m=01/d=05/2012-01-06T22:19:12.565Z/0/index.zip\"}"+ ",\"dimensions\":\"user_name,user_lang,user_time_zone,user_location,"+ "user_mention_name,has_mention,reply_to_name,first_hashtag,rt_name,url_domain,has_links,"+ "has_geo,is_retweet,is_viral\",\"metrics\":\"count,tweet_length,num_followers,num_links,"+ "num_mentions,num_hashtags,num_favorites,user_total_tweets\",\"shardSpec\":{\"type\":\"none\"},"+ "\"size\":511804455,\"identifier\":"+ "\"twitterstream_2012-01-05T00:00:00.000Z_2012-01-06T00:00:00.000Z_2012-01-06T22:19:12.565Z\"}",DataSegment.class);
  testRows=Arrays.<DataSegment>asList(segment1,segment2);
}
