{
  final MetricHolder metricHolder=index.getMetricHolder(columnName);
  if (metricHolder == null) {
    final VSizeIndexed dimColumn=index.getDimColumn(columnName);
    if (dimColumn == null) {
      return null;
    }
    return new StringMultiValueColumn(index.getDimValueLookup(columnName),dimColumn,index.getInvertedIndexes().get(columnName));
  }
 else   if (metricHolder.getType() == MetricHolder.MetricType.FLOAT) {
    return new FloatColumn(metricHolder.floatType);
  }
 else {
    return new ComplexColumnImpl(metricHolder.getComplexType());
  }
}
