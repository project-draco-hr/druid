{
  for (  final FireDepartment fireDepartment : fireDepartments) {
    DataSchema schema=fireDepartment.getDataSchema();
    final FireChief chief=new FireChief(fireDepartment);
    Map<Integer,FireChief> chiefs=this.chiefs.get(schema.getDataSource());
    if (chiefs == null) {
      chiefs=new HashMap<Integer,FireChief>();
      this.chiefs.put(schema.getDataSource(),chiefs);
    }
    chiefs.put(fireDepartment.getTuningConfig().getShardSpec().getPartitionNum(),chief);
    chief.setName(String.format("chief-%s[%s]",schema.getDataSource(),fireDepartment.getTuningConfig().getShardSpec().getPartitionNum()));
    chief.setDaemon(true);
    chief.start();
  }
}
