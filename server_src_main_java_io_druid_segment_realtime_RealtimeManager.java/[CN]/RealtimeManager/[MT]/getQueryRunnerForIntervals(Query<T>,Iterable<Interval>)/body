{
  final QueryRunnerFactory<T,Query<T>> factory=conglomerate.findFactory(query);
  final Iterable<QueryRunner> runners;
  final List<String> names=query.getDataSource().getNames();
  runners=Iterables.transform(names,new Function<String,QueryRunner>(){
    @Override public QueryRunner<T> apply(    String input){
      Map<Integer,FireChief> chiefsOfDataSource=chiefs.get(input);
      return chiefsOfDataSource == null ? new NoopQueryRunner() : factory.getToolchest().mergeResults(factory.mergeRunners(MoreExecutors.sameThreadExecutor(),Iterables.transform(chiefsOfDataSource.values(),new Function<FireChief,QueryRunner<T>>(){
        @Override public QueryRunner<T> apply(        FireChief input){
          return input.getQueryRunner(query);
        }
      }
)));
    }
  }
);
  return new UnionQueryRunner<>(runners,conglomerate.findFactory(query).getToolchest());
}
