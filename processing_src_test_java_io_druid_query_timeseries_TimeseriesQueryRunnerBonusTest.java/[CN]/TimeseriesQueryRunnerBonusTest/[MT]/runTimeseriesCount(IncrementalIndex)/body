{
  final QueryRunnerFactory factory=TimeseriesQueryRunnerFactory.create();
  final QueryRunner<Result<TimeseriesResultValue>> runner=makeQueryRunner(factory,new IncrementalIndexSegment(index));
  TimeseriesQuery query=Druids.newTimeseriesQueryBuilder().dataSource("xxx").granularity(QueryGranularity.ALL).intervals(ImmutableList.of(new Interval("2012-01-01T00:00:00Z/P1D"))).aggregators(ImmutableList.<AggregatorFactory>of(new CountAggregatorFactory("rows"))).build();
  return Sequences.toList(runner.run(query),Lists.<Result<TimeseriesResultValue>>newArrayList());
}
