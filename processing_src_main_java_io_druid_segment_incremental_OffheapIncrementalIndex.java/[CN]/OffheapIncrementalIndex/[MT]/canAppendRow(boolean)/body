{
  final int aggBufferSize=bufferHolder.get().limit();
  if ((size() + 1) * totalAggSize > aggBufferSize) {
    outOfRowsReason=String.format("Maximum aggregation buffer limit reached [%d bytes].",aggBufferSize);
    return false;
  }
  if (getCurrentSize() + totalAggSize + 2 * STORE_CHUNK_SIZE + (includeFudgeFactor ? STORE_CHUNK_SIZE : 0) > maxTotalBufferSize) {
    outOfRowsReason=String.format("Maximum time and dimension buffer limit reached [%d bytes].",maxTotalBufferSize - aggBufferSize);
    return false;
  }
  return true;
}
