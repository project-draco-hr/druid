{
  super(incrementalIndexSchema,deserializeComplexMetrics,reportParseExceptions,sortFacts);
  this.maxRowCount=maxRowCount;
  this.bufferPool=bufferPool;
  if (sortFacts) {
    this.facts=new ConcurrentSkipListMap<>(dimsComparator());
  }
 else {
    this.facts=new ConcurrentHashMap<>();
  }
  ResourceHolder<ByteBuffer> bb=bufferPool.take();
  if (bb.get().capacity() < aggsTotalSize) {
    bb.close();
    throw new IAE("bufferPool buffers capacity must be >= [%s]",aggsTotalSize);
  }
  aggBuffers.add(bb);
}
