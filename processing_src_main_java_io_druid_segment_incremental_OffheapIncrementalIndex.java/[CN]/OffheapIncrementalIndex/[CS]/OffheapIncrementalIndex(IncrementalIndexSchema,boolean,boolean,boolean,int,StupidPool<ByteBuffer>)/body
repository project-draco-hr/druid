{
  super(incrementalIndexSchema,deserializeComplexMetrics,reportParseExceptions,sortFacts);
  this.maxRowCount=maxRowCount;
  this.bufferPool=bufferPool;
  if (sortFacts) {
    this.facts=new ConcurrentSkipListMap<>(dimsComparator());
  }
 else {
    this.facts=new ConcurrentHashMap<>();
  }
  ResourceHolder<ByteBuffer> bb=bufferPool.take();
  if (bb.get().capacity() < aggsTotalSize) {
    RuntimeException ex=new IAE("bufferPool buffers capacity must be >= [%s]",aggsTotalSize);
    try {
      bb.close();
    }
 catch (    IOException ioe) {
      ex.addSuppressed(ioe);
    }
    throw ex;
  }
  aggBuffers.add(bb);
}
