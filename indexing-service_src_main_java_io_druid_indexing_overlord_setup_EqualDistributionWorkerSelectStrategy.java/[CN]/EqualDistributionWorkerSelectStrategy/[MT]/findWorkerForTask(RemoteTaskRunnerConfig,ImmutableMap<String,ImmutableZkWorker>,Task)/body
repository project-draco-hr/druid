{
  final TreeSet<ImmutableZkWorker> sortedWorkers=Sets.newTreeSet(new Comparator<ImmutableZkWorker>(){
    @Override public int compare(    ImmutableZkWorker zkWorker,    ImmutableZkWorker zkWorker2){
      return -Ints.compare(zkWorker2.getCurrCapacityUsed(),zkWorker.getCurrCapacityUsed());
    }
  }
);
  sortedWorkers.addAll(zkWorkers.values());
  final String minWorkerVer=config.getMinWorkerVersion();
  for (  ImmutableZkWorker zkWorker : sortedWorkers) {
    if (zkWorker.canRunTask(task) && zkWorker.isValidVersion(minWorkerVer)) {
      return Optional.of(zkWorker);
    }
  }
  return Optional.absent();
}
