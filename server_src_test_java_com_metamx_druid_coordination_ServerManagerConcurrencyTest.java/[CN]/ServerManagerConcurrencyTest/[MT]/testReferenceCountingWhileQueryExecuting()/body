{
  serverManager.loadQueryable("test","3",new Interval("2011-04-04/2011-04-05"));
  Future future=assertQueryable(QueryGranularity.DAY,"test",new Interval("2011-04-04/2011-04-06"),ImmutableList.<Pair<String,Interval>>of(new Pair<String,Interval>("3",new Interval("2011-04-04/2011-04-05"))));
  queryNotifyLatch.await();
  Assert.assertTrue(factory.getAdapters().size() == 1);
  for (  SegmentForTesting segmentForTesting : factory.getAdapters()) {
    Assert.assertFalse(segmentForTesting.isClosed());
  }
  serverManager.dropQueryable("test","3",new Interval("2011-04-04/2011-04-05"));
  for (  SegmentForTesting segmentForTesting : factory.getAdapters()) {
    Assert.assertFalse(segmentForTesting.isClosed());
  }
  queryWaitLatch.countDown();
  future.get();
  for (  SegmentForTesting segmentForTesting : factory.getAdapters()) {
    Assert.assertTrue(segmentForTesting.isClosed());
  }
}
