{
  log.info("Converting segment[%s]",segment);
  final Map<DataSegment,File> localSegments=toolbox.getSegments(Arrays.asList(segment));
  final File location=localSegments.get(segment);
  final File outLocation=new File(location,"v9_out");
  if (IndexIO.convertSegment(location,outLocation)) {
    final int outVersion=IndexIO.getVersionFromDir(outLocation);
    DataSegment updatedSegment=segment.withVersion(String.format("%s_v%s",segment.getVersion(),outVersion));
    updatedSegment=toolbox.getSegmentPusher().push(outLocation,updatedSegment);
    toolbox.getTaskActionClient().submit(new SegmentInsertAction(Sets.newHashSet(updatedSegment)).withAllowOlderVersions(true));
  }
 else {
    log.info("Conversion failed.");
  }
}
