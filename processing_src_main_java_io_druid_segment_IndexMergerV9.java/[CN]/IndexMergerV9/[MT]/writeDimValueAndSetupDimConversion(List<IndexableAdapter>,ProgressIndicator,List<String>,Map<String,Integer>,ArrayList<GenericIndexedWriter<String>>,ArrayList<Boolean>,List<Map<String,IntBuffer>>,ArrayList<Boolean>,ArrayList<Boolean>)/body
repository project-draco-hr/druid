{
  final String section="setup dimension conversions";
  progress.startSection(section);
  for (int i=0; i < indexes.size(); ++i) {
    dimConversions.add(Maps.<String,IntBuffer>newHashMap());
  }
  for (int dimIndex=0; dimIndex < mergedDimensions.size(); ++dimIndex) {
    long dimStartTime=System.currentTimeMillis();
    String dimension=mergedDimensions.get(dimIndex);
    boolean dimHasNull=false;
    boolean dimHasValues=false;
    boolean dimAbsentFromSomeIndex=false;
    int numMergeIndex=0;
    Indexed<String> dimValueLookup=null;
    Indexed<String>[] dimValueLookups=new Indexed[indexes.size() + 1];
    for (int i=0; i < indexes.size(); i++) {
      Indexed<String> dimValues=indexes.get(i).getDimValueLookup(dimension);
      if (!isNullColumn(dimValues)) {
        dimHasValues=true;
        dimHasNull|=dimValues.indexOf(null) >= 0;
        dimValueLookups[i]=dimValueLookup=dimValues;
        numMergeIndex++;
      }
 else {
        dimAbsentFromSomeIndex=true;
      }
    }
    boolean convertMissingDims=dimHasValues && dimAbsentFromSomeIndex;
    convertMissingDimsFlags.add(convertMissingDims);
    if (convertMissingDims && !dimHasNull) {
      dimHasNull=true;
      dimValueLookups[indexes.size()]=dimValueLookup=EMPTY_STR_DIM_VAL;
      numMergeIndex++;
    }
    GenericIndexedWriter<String> writer=dimValueWriters.get(dimIndex);
    int cardinality=0;
    if (numMergeIndex > 1) {
      DictionaryMergeIterator iterator=new DictionaryMergeIterator(dimValueLookups,true);
      while (iterator.hasNext()) {
        writer.write(iterator.next());
      }
      for (int i=0; i < indexes.size(); i++) {
        if (dimValueLookups[i] != null && iterator.needConversion(i)) {
          dimConversions.get(i).put(dimension,iterator.conversions[i]);
        }
      }
      cardinality=iterator.counter;
    }
 else     if (numMergeIndex == 1) {
      for (      String value : dimValueLookup) {
        writer.write(value);
      }
      cardinality=dimValueLookup.size();
    }
    dimHasNullFlags.add(dimHasNull);
    log.info("Completed dim[%s] conversions with cardinality[%,d] in %,d millis.",dimension,cardinality,System.currentTimeMillis() - dimStartTime);
    dimensionCardinalities.put(dimension,cardinality);
    writer.close();
    if (cardinality == 0) {
      log.info(String.format("Skipping [%s], it is empty!",dimension));
      dimensionSkipFlag.add(true);
      continue;
    }
    dimensionSkipFlag.add(false);
  }
  progress.stopSection(section);
}
