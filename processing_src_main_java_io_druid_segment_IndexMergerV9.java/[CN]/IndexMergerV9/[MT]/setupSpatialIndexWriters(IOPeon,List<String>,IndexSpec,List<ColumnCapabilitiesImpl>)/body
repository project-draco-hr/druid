{
  ArrayList<ByteBufferWriter<ImmutableRTree>> writers=Lists.newArrayListWithCapacity(mergedDimensions.size());
  final BitmapSerdeFactory bitmapSerdeFactory=indexSpec.getBitmapSerdeFactory();
  for (int dimIndex=0; dimIndex < mergedDimensions.size(); ++dimIndex) {
    if (dimCapabilities.get(dimIndex).hasSpatialIndexes()) {
      BitmapFactory bitmapFactory=bitmapSerdeFactory.getBitmapFactory();
      ByteBufferWriter<ImmutableRTree> writer=new ByteBufferWriter<>(ioPeon,String.format("%s.spatial",mergedDimensions.get(dimIndex)),new IndexedRTree.ImmutableRTreeObjectStrategy(bitmapFactory));
      writer.open();
      writers.add(writer);
    }
 else {
      writers.add(null);
    }
  }
  return writers;
}
