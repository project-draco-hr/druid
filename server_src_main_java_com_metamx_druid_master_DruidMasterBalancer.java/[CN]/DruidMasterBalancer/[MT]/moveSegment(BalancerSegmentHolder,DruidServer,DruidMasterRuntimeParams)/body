{
  final String toServerName=toServer.getName();
  final LoadQueuePeon toPeon=params.getLoadManagementPeons().get(toServerName);
  final String fromServerName=segment.getFromServer().getName();
  final DataSegment segmentToMove=segment.getSegment();
  final String segmentName=segmentToMove.getIdentifier();
  if (!toPeon.getSegmentsToLoad().contains(segmentToMove) && (toServer.getSegment(segmentName) == null) && new ServerHolder(toServer,toPeon).getAvailableSize() > segmentToMove.getSize()) {
    log.info("Moving [%s] from [%s] to [%s]",segmentName,fromServerName,toServerName);
    try {
      master.moveSegment(fromServerName,toServerName,segmentToMove.getIdentifier(),new LoadPeonCallback(){
        @Override protected void execute(){
          Map<String,BalancerSegmentHolder> movingSegments=currentlyMovingSegments.get(toServer.getTier());
          if (movingSegments != null) {
            movingSegments.remove(segmentName);
          }
        }
      }
);
      currentlyMovingSegments.get(toServer.getTier()).put(segmentName,segment);
    }
 catch (    Exception e) {
      log.makeAlert(e,String.format("[%s] : Moving exception",segmentName)).emit();
    }
  }
 else {
    currentlyMovingSegments.get(toServer.getTier()).remove(segment);
  }
}
