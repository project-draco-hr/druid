{
  Sequence<Row> seq=helper.createIndexAndRunQueryOnSegment(new File(this.getClass().getClassLoader().getResource("simple_test_data.tsv").getFile()),readFileFromClasspathAsString("simple_test_data_record_parser.json"),readFileFromClasspathAsString("simple_test_data_aggregators.json"),0,QueryGranularities.NONE,5,readFileFromClasspathAsString("simple_test_data_group_by_query.json"));
  List<Row> results=Sequences.toList(seq,Lists.<Row>newArrayList());
  Assert.assertEquals(5,results.size());
  Assert.assertEquals(ImmutableList.of(new MapBasedRow(DateTime.parse("2014-10-19T00:00:00.000Z"),ImmutableMap.<String,Object>builder().put("product","product_3").put("sketch_count",38.0).put("sketchEstimatePostAgg",38.0).put("sketchUnionPostAggEstimate",38.0).put("sketchIntersectionPostAggEstimate",38.0).put("sketchAnotBPostAggEstimate",0.0).put("non_existing_col_validation",0.0).build()),new MapBasedRow(DateTime.parse("2014-10-19T00:00:00.000Z"),ImmutableMap.<String,Object>builder().put("product","product_1").put("sketch_count",42.0).put("sketchEstimatePostAgg",42.0).put("sketchUnionPostAggEstimate",42.0).put("sketchIntersectionPostAggEstimate",42.0).put("sketchAnotBPostAggEstimate",0.0).put("non_existing_col_validation",0.0).build()),new MapBasedRow(DateTime.parse("2014-10-19T00:00:00.000Z"),ImmutableMap.<String,Object>builder().put("product","product_2").put("sketch_count",42.0).put("sketchEstimatePostAgg",42.0).put("sketchUnionPostAggEstimate",42.0).put("sketchIntersectionPostAggEstimate",42.0).put("sketchAnotBPostAggEstimate",0.0).put("non_existing_col_validation",0.0).build()),new MapBasedRow(DateTime.parse("2014-10-19T00:00:00.000Z"),ImmutableMap.<String,Object>builder().put("product","product_4").put("sketch_count",42.0).put("sketchEstimatePostAgg",42.0).put("sketchUnionPostAggEstimate",42.0).put("sketchIntersectionPostAggEstimate",42.0).put("sketchAnotBPostAggEstimate",0.0).put("non_existing_col_validation",0.0).build()),new MapBasedRow(DateTime.parse("2014-10-19T00:00:00.000Z"),ImmutableMap.<String,Object>builder().put("product","product_5").put("sketch_count",42.0).put("sketchEstimatePostAgg",42.0).put("sketchUnionPostAggEstimate",42.0).put("sketchIntersectionPostAggEstimate",42.0).put("sketchAnotBPostAggEstimate",0.0).put("non_existing_col_validation",0.0).build())),results);
}
