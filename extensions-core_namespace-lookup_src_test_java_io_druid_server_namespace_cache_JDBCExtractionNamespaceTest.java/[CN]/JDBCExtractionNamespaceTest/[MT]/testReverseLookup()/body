{
  final JDBCExtractionNamespace extractionNamespace=new JDBCExtractionNamespace(namespace,derbyConnectorRule.getMetadataConnectorConfig(),tableName,keyName,valName,tsColumn,new Period(0));
  NamespaceExtractionCacheManagersTest.waitFor(extractionCacheManager.schedule(extractionNamespace));
  Function<String,List<String>> reverseExtractionFn=reverseFnCache.get(extractionNamespace.getNamespace());
  Assert.assertEquals("reverse lookup should match",Sets.newHashSet("foo","bad"),Sets.newHashSet(reverseExtractionFn.apply("bar")));
  Assert.assertEquals("reverse lookup should match",Sets.newHashSet("how about that"),Sets.newHashSet(reverseExtractionFn.apply("foo")));
  Assert.assertEquals("reverse lookup should match",Sets.newHashSet("empty string"),Sets.newHashSet(reverseExtractionFn.apply("")));
  Assert.assertEquals("null is same as empty string",Sets.newHashSet("empty string"),Sets.newHashSet(reverseExtractionFn.apply(null)));
  Assert.assertEquals("reverse lookup of none existing value should be empty list",Collections.EMPTY_LIST,reverseExtractionFn.apply("does't exist"));
}
