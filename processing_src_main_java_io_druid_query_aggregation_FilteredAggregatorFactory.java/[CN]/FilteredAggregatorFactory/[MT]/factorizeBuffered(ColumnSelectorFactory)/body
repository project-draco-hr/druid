{
  final BufferAggregator aggregator=delegate.factorizeBuffered(metricFactory);
  final DimensionSelector dimSelector=metricFactory.makeDimensionSelector(((SelectorDimFilter)filter).getDimension());
  Predicate<Integer> predicate=Predicates.equalTo(dimSelector.lookupId(((SelectorDimFilter)filter).getValue()));
  return new FilteredBufferAggregator(dimSelector,predicate,aggregator);
}
