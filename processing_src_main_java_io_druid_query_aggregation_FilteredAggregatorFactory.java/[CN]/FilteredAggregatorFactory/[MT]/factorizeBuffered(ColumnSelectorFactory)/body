{
  final BufferAggregator aggregator=delegate.factorizeBuffered(metricFactory);
  final Pair<DimensionSelector,IntPredicate> selectorPredicatePair=makeFilterPredicate(filter,metricFactory);
  return new FilteredBufferAggregator(selectorPredicatePair.lhs,selectorPredicatePair.rhs,aggregator);
}
