{
  final S3SegmentGetterConfig getterConfig=new S3SegmentGetterConfig(){
    @Override public File getCacheDirectory(){
      return new File(config.getTaskDir(task),"fetched_segments");
    }
  }
;
  return ImmutableMap.<String,SegmentPuller>builder().put("s3",new S3SegmentPuller(s3Client,getterConfig)).put("s3_union",new S3SegmentPuller(s3Client,getterConfig)).put("s3_zip",new S3ZippedSegmentPuller(s3Client,getterConfig)).build();
}
