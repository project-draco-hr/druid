{
  final SingleSegmentLoader loader=new SingleSegmentLoader(new S3DataSegmentPuller(s3Client),new MMappedQueryableIndexFactory(),new File(config.getTaskDir(task),"fetched_segments"));
  Map<DataSegment,File> retVal=Maps.newLinkedHashMap();
  for (  DataSegment segment : segments) {
    retVal.put(segment,loader.getSegmentFiles(segment));
  }
  return retVal;
}
