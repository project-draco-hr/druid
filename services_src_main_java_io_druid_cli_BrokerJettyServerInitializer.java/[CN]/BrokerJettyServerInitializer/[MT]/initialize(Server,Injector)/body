{
  final ServletContextHandler resources=new ServletContextHandler(ServletContextHandler.SESSIONS);
  resources.addServlet(new ServletHolder(new DefaultServlet()),"/druid/v2/datasources/*");
  resources.addFilter(GuiceFilter.class,"/druid/v2/datasources/*",null);
  final ServletContextHandler queries=new ServletContextHandler(ServletContextHandler.SESSIONS);
  queries.setResourceBase("/");
  queries.addServlet(new ServletHolder(injector.getInstance(QueryServlet.class)),"/druid/v2/*");
  final ServletContextHandler root=new ServletContextHandler(ServletContextHandler.SESSIONS);
  root.addServlet(new ServletHolder(new DefaultServlet()),"/*");
  root.addFilter(GzipFilter.class,"/*",null);
  root.addFilter(GuiceFilter.class,"/*",null);
  final HandlerList handlerList=new HandlerList();
  handlerList.setHandlers(new Handler[]{resources,queries,root,new DefaultHandler()});
  server.setHandler(handlerList);
}
