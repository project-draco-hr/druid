{
  final Druids.SearchQueryBuilder builder=Druids.newSearchQueryBuilder().dataSource(DATA_SOURCE).filters(DIM_FILTER).granularity(GRANULARITY).limit(1000).intervals(SEG_SPEC).dimensions(Arrays.asList("a_dim")).query("how").context(CONTEXT);
  testQueryCaching(client,builder.build(),new Interval("2011-01-01/2011-01-02"),makeSearchResults(new DateTime("2011-01-01"),"how","howdy","howwwwww","howwy"),new Interval("2011-01-02/2011-01-03"),makeSearchResults(new DateTime("2011-01-02"),"how1","howdy1","howwwwww1","howwy1"),new Interval("2011-01-05/2011-01-10"),makeSearchResults(new DateTime("2011-01-05"),"how2","howdy2","howwwwww2","howww2",new DateTime("2011-01-06"),"how3","howdy3","howwwwww3","howww3",new DateTime("2011-01-07"),"how4","howdy4","howwwwww4","howww4",new DateTime("2011-01-08"),"how5","howdy5","howwwwww5","howww5",new DateTime("2011-01-09"),"how6","howdy6","howwwwww6","howww6"),new Interval("2011-01-05/2011-01-10"),makeSearchResults(new DateTime("2011-01-05T01"),"how2","howdy2","howwwwww2","howww2",new DateTime("2011-01-06T01"),"how3","howdy3","howwwwww3","howww3",new DateTime("2011-01-07T01"),"how4","howdy4","howwwwww4","howww4",new DateTime("2011-01-08T01"),"how5","howdy5","howwwwww5","howww5",new DateTime("2011-01-09T01"),"how6","howdy6","howwwwww6","howww6"));
  QueryRunner runner=new FinalizeResultsQueryRunner(client,new SearchQueryQueryToolChest(new SearchQueryConfig()));
  TestHelper.assertExpectedResults(makeSearchResults(new DateTime("2011-01-01"),"how","howdy","howwwwww","howwy",new DateTime("2011-01-02"),"how1","howdy1","howwwwww1","howwy1",new DateTime("2011-01-05"),"how2","howdy2","howwwwww2","howww2",new DateTime("2011-01-05T01"),"how2","howdy2","howwwwww2","howww2",new DateTime("2011-01-06"),"how3","howdy3","howwwwww3","howww3",new DateTime("2011-01-06T01"),"how3","howdy3","howwwwww3","howww3",new DateTime("2011-01-07"),"how4","howdy4","howwwwww4","howww4",new DateTime("2011-01-07T01"),"how4","howdy4","howwwwww4","howww4",new DateTime("2011-01-08"),"how5","howdy5","howwwwww5","howww5",new DateTime("2011-01-08T01"),"how5","howdy5","howwwwww5","howww5",new DateTime("2011-01-09"),"how6","howdy6","howwwwww6","howww6",new DateTime("2011-01-09T01"),"how6","howdy6","howwwwww6","howww6"),runner.run(builder.intervals("2011-01-01/2011-01-10").build()));
}
