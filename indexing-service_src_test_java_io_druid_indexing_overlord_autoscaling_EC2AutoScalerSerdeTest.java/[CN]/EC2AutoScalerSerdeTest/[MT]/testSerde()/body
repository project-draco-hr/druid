{
  final ObjectMapper objectMapper=new DefaultObjectMapper();
  objectMapper.setInjectableValues(new InjectableValues(){
    @Override public Object findInjectableValue(    Object o,    DeserializationContext deserializationContext,    BeanProperty beanProperty,    Object o1){
      return null;
    }
  }
);
  final EC2AutoScaler autoScaler=objectMapper.readValue(json,EC2AutoScaler.class);
  Assert.assertEquals(3,autoScaler.getMaxNumWorkers());
  Assert.assertEquals(2,autoScaler.getMinNumWorkers());
  Assert.assertEquals("westeros-east-1a",autoScaler.getEnvConfig().getAvailabilityZone());
  Assert.assertEquals("ami-abc",autoScaler.getEnvConfig().getNodeData().getAmiId());
  Assert.assertEquals("t1.micro",autoScaler.getEnvConfig().getNodeData().getInstanceType());
  Assert.assertEquals("iron",autoScaler.getEnvConfig().getNodeData().getKeyName());
  Assert.assertEquals(1,autoScaler.getEnvConfig().getNodeData().getMaxInstances());
  Assert.assertEquals(1,autoScaler.getEnvConfig().getNodeData().getMinInstances());
  Assert.assertEquals(Lists.newArrayList("kingsguard"),autoScaler.getEnvConfig().getNodeData().getSecurityGroupIds());
  Assert.assertEquals("redkeep",autoScaler.getEnvConfig().getNodeData().getSubnetId());
  Assert.assertEquals("VERSION=1234\n",new String(BaseEncoding.base64().decode(autoScaler.getEnvConfig().getUserData().withVersion("1234").getUserDataBase64()),Charsets.UTF_8));
  Assert.assertEquals("Round trip",autoScaler,objectMapper.readValue(objectMapper.writeValueAsBytes(autoScaler),EC2AutoScaler.class));
}
