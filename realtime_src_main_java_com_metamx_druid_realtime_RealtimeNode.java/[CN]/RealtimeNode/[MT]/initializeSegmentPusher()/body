{
  if (segmentPusher == null) {
    final RestS3Service s3Client=new RestS3Service(new AWSCredentials(PropUtils.getProperty(props,"com.metamx.aws.accessKey"),PropUtils.getProperty(props,"com.metamx.aws.secretKey")));
    segmentPusher=new S3SegmentPusher(s3Client,configFactory.build(S3SegmentPusherConfig.class),jsonMapper);
  }
}
