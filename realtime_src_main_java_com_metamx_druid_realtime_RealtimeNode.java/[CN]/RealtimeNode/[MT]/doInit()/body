{
  initializeView();
  initializeMetadataUpdater();
  initializeSegmentPusher();
  initializeJacksonInjectables();
  initializeFireDepartments();
  final Lifecycle lifecycle=getLifecycle();
  final ServiceEmitter emitter=getEmitter();
  final QueryRunnerFactoryConglomerate conglomerate=getConglomerate();
  final List<Monitor> monitors=getMonitors();
  monitors.add(new RealtimeMetricsMonitor(fireDepartments));
  final RealtimeManager realtimeManager=new RealtimeManager(fireDepartments,conglomerate);
  lifecycle.addManagedInstance(realtimeManager);
  startMonitoring(monitors);
  final Context v2Druid=new Context(getServer(),"/druid/v2",Context.SESSIONS);
  v2Druid.addServlet(new ServletHolder(new StatusServlet()),"/status");
  v2Druid.addServlet(new ServletHolder(new QueryServlet(getJsonMapper(),getSmileMapper(),realtimeManager,emitter,getRequestLogger())),"/*");
  initialized=true;
}
