{
  IncrementalIndex.DimensionDesc dimensionDesc=index.getDimension(dimension);
  if (dimensionDesc == null) {
    return new BooleanValueMatcher(isComparableNullOrEmpty(value));
  }
  final int dimIndex=dimensionDesc.getIndex();
  final IncrementalIndex.DimDim dimDim=dimensionDesc.getValues();
  final Integer id=dimDim.getId(value);
  if (id == null) {
    if (isComparableNullOrEmpty(value)) {
      return new ValueMatcher(){
        @Override public boolean matches(){
          int[][] dims=holder.getKey().getDims();
          if (dimIndex >= dims.length || dims[dimIndex] == null) {
            return true;
          }
          return false;
        }
      }
;
    }
    return new BooleanValueMatcher(false);
  }
  return new ValueMatcher(){
    @Override public boolean matches(){
      int[][] dims=holder.getKey().getDims();
      if (dimIndex >= dims.length || dims[dimIndex] == null) {
        return isComparableNullOrEmpty(value);
      }
      return Ints.indexOf(dims[dimIndex],id) >= 0;
    }
  }
;
}
