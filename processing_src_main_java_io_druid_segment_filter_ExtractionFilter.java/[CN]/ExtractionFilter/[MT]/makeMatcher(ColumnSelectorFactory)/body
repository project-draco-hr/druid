{
  final DimensionSelector dimensionSelector=columnSelectorFactory.makeDimensionSelector(dimension,null);
  if (dimensionSelector == null) {
    return new BooleanValueMatcher(value.equals(Strings.nullToEmpty(fn.apply(null))));
  }
 else {
    return new ValueMatcher(){
      @Override public boolean matches(){
        final IndexedInts row=dimensionSelector.getRow();
        final int size=row.size();
        for (int i=0; i < size; ++i) {
          if (value.equals(Strings.nullToEmpty(fn.apply(dimensionSelector.lookupName(row.get(i)))))) {
            return true;
          }
        }
        return false;
      }
    }
;
  }
}
