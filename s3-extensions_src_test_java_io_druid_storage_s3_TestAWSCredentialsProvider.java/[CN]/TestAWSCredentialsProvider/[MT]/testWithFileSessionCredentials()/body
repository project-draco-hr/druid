{
  S3StorageDruidModule module=new S3StorageDruidModule();
  AWSCredentialsConfig config=mock(AWSCredentialsConfig.class);
  doReturn("").when(config).getAccessKey();
  doReturn("").when(config).getSecretKey();
  File file=folder.newFile();
  PrintWriter out=new PrintWriter(file.getAbsolutePath());
  out.println("sessionToken=sessionTokenSample\nsecretKey=secretKeySample\naccessKey=accessKeySample");
  out.close();
  doReturn(file.getAbsolutePath()).when(config).getFileSessionCredentials();
  AWSCredentialsProvider provider=module.getAWSCredentialsProvider(config);
  AWSCredentials credentials=provider.getCredentials();
  assertTrue(credentials instanceof AWSSessionCredentials);
  AWSSessionCredentials sessionCredentials=(AWSSessionCredentials)credentials;
  assertEquals(sessionCredentials.getAWSAccessKeyId(),"accessKeySample");
  assertEquals(sessionCredentials.getAWSSecretKey(),"secretKeySample");
  assertEquals(sessionCredentials.getSessionToken(),"sessionTokenSample");
  module.getRestS3Service(provider);
}
