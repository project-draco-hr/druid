{
  initializeHttpClient();
  initializeEmitter();
  initializeMonitors();
  initializeMergerConfig();
  initializeServiceDiscovery();
  initializeJacksonInjections();
  initializeJacksonSubtypes();
  initializeCuratorCoordinator();
  initializePersistentTaskLogs();
  initializeTaskRunner();
  initializeWorkerTaskMonitor();
  initializeServer();
  final ScheduledExecutorFactory scheduledExecutorFactory=ScheduledExecutors.createFactory(getLifecycle());
  final ScheduledExecutorService globalScheduledExec=scheduledExecutorFactory.create(1,"Global--%d");
  final MonitorScheduler monitorScheduler=new MonitorScheduler(getConfigFactory().build(MonitorSchedulerConfig.class),globalScheduledExec,emitter,monitors);
  getLifecycle().addManagedInstance(monitorScheduler);
  final Injector injector=Guice.createInjector(new WorkerServletModule(getJsonMapper(),emitter,forkingTaskRunner));
  final ServletContextHandler root=new ServletContextHandler(server,"/",ServletContextHandler.SESSIONS);
  root.addServlet(new ServletHolder(new DefaultServlet()),"/*");
  root.addEventListener(new GuiceServletConfig(injector));
  root.addFilter(GuiceFilter.class,"/status",null);
  root.addFilter(GuiceFilter.class,"/druid/worker/v1/*",null);
}
