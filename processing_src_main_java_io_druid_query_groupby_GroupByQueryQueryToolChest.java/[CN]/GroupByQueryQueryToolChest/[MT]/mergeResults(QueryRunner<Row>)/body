{
  return new QueryRunner<Row>(){
    @Override public Sequence<Row> run(    Query<Row> input,    Map<String,Object> responseContext){
      if (input.getContextBySegment(false)) {
        return runner.run(input,responseContext);
      }
      if (Boolean.valueOf(input.getContextValue(GROUP_BY_MERGE_KEY,"true"))) {
        return mergeGroupByResults(((GroupByQuery)input).withOverriddenContext(NO_MERGE_CONTEXT),runner,responseContext);
      }
      return runner.run(input,responseContext);
    }
  }
;
}
