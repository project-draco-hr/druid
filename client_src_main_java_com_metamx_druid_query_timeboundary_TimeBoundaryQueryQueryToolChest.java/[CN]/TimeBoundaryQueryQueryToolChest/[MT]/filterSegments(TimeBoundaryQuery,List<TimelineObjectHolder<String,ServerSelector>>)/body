{
  long minMillis=Long.MAX_VALUE;
  long maxMillis=Long.MIN_VALUE;
  TimelineObjectHolder<String,ServerSelector> min=null;
  TimelineObjectHolder<String,ServerSelector> max=null;
  Map<String,Set<TimelineObjectHolder<String,ServerSelector>>> segmentGroups=Maps.newHashMap();
  for (  TimelineObjectHolder<String,ServerSelector> e : input) {
    final long start=e.getInterval().getStartMillis();
    final long end=e.getInterval().getEndMillis();
    final String version=e.getVersion();
    if (segmentGroups.containsKey(version)) {
      segmentGroups.get(version).add(e);
    }
 else {
      segmentGroups.put(version,Sets.newHashSet(e));
    }
    if (min == null || start < minMillis) {
      min=e;
      minMillis=start;
    }
    if (max == null || end > maxMillis) {
      max=e;
      maxMillis=end;
    }
  }
  return Lists.newArrayList(Sets.union(segmentGroups.get(min.getVersion()),segmentGroups.get(max.getVersion())));
}
