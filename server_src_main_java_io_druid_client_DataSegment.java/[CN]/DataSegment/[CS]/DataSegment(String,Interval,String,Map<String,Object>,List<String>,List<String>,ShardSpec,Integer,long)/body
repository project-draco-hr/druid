{
  final Predicate<String> nonEmpty=new Predicate<String>(){
    @Override public boolean apply(    @Nullable String input){
      return input != null && !input.isEmpty();
    }
  }
;
  this.dataSource=dataSource.toLowerCase();
  this.interval=interval;
  this.loadSpec=loadSpec;
  this.version=version;
  this.dimensions=dimensions == null ? ImmutableList.<String>of() : ImmutableList.copyOf(Iterables.filter(dimensions,nonEmpty));
  this.metrics=metrics == null ? ImmutableList.<String>of() : ImmutableList.copyOf(Iterables.filter(metrics,nonEmpty));
  this.shardSpec=(shardSpec == null) ? new NoneShardSpec() : shardSpec;
  this.binaryVersion=binaryVersion;
  this.size=size;
  this.identifier=makeDataSegmentIdentifier(this.dataSource,this.interval.getStart(),this.interval.getEnd(),this.version,this.shardSpec);
}
