{
  final LimitSpec theLimitSpec;
  if (limitSpec == null) {
    theLimitSpec=new DefaultLimitSpec(orderByColumnSpecs,limit);
  }
 else {
    theLimitSpec=limitSpec;
  }
  return new GroupByQuery(dataSource,querySegmentSpec,dimFilter,granularity,dimensions,aggregatorSpecs,postAggregatorSpecs,havingSpec,null,theLimitSpec,context);
}
