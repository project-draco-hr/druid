{
  final ConsumerConnector connector=Consumer.createJavaConsumerConnector(new ConsumerConfig(consumerProps));
  final Map<String,List<KafkaStream<Message>>> streams=connector.createMessageStreams(ImmutableMap.of(feed,1));
  final List<KafkaStream<Message>> streamList=streams.get(feed);
  if (streamList == null || streamList.size() != 1) {
    return null;
  }
  final KafkaStream<Message> stream=streamList.get(0);
  return new DefaultFirehose(connector,stream,parser);
}
