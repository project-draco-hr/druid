{
  if (lhs == null) {
    return rhs;
  }
  if (rhs == null) {
    return lhs;
  }
  Object[] metrics=new Object[metricAggs.length];
  Object[] lhsMetrics=lhs.getMetrics();
  Object[] rhsMetrics=rhs.getMetrics();
  for (int i=0; i < metrics.length; ++i) {
    metrics[i]=metricAggs[i].combine(lhsMetrics[i],rhsMetrics[i]);
  }
  final Rowboat retVal=new Rowboat(lhs.getTimestamp(),lhs.getDims(),metrics,lhs.getRowNum());
  for (  Rowboat rowboat : Arrays.asList(lhs,rhs)) {
    for (    Map.Entry<Integer,TreeSet<Integer>> entry : rowboat.getComprisedRows().entrySet()) {
      for (      Integer rowNum : entry.getValue()) {
        retVal.addRow(entry.getKey(),rowNum);
      }
    }
  }
  return retVal;
}
