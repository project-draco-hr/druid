{
  GroupByQueryConfig config=new GroupByQueryConfig();
  config.setMaxIntermediateRows(10000);
  final Supplier<GroupByQueryConfig> configSupplier=Suppliers.ofInstance(config);
  final GroupByQueryEngine engine=new GroupByQueryEngine(configSupplier,new StupidPool<ByteBuffer>(new Supplier<ByteBuffer>(){
    @Override public ByteBuffer get(){
      return ByteBuffer.allocate(1024 * 1024);
    }
  }
));
  final GroupByQueryRunnerFactory factory=new GroupByQueryRunnerFactory(engine,configSupplier,new GroupByQueryQueryToolChest(configSupplier,engine));
  return Lists.newArrayList(Iterables.transform(QueryRunnerTestHelper.makeQueryRunners(factory),new Function<Object,Object>(){
    @Override public Object apply(    @Nullable Object input){
      return new Object[]{factory,((Object[])input)[0]};
    }
  }
));
}
