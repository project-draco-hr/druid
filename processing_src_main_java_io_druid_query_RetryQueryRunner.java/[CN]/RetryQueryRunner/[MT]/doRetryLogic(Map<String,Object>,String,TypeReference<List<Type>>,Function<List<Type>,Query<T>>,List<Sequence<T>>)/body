{
  final List<Type> missingItems=getMissingItems(responseContext,key,typeReference);
  if (!missingItems.isEmpty()) {
    for (int i=0; i < config.getNumTries(); i++) {
      log.info("[%,d] missing items found. Retry attempt [%,d]",missingItems.size(),i);
      responseContext.put(Result.MISSING_SEGMENTS_KEY,Lists.newArrayList());
      final Query<T> retryQuery=function.apply(missingItems);
      Sequence<T> retrySequence=baseRunner.run(retryQuery,responseContext);
      listOfSequences.add(retrySequence);
      if (getMissingItems(responseContext,key,typeReference).isEmpty()) {
        break;
      }
    }
    final List<Type> finalMissingItems=getMissingItems(responseContext,key,typeReference);
    if (!config.isReturnPartialResults() && !finalMissingItems.isEmpty()) {
      throw new SegmentMissingException("No results found for items[%s]",finalMissingItems);
    }
  }
}
