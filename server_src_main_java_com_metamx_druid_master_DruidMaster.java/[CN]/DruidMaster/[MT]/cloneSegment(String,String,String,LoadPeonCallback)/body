{
  final DruidServer fromServer=serverInventoryView.getInventoryValue(from);
  if (fromServer == null) {
    throw new IllegalArgumentException(String.format("Unable to find server [%s]",from));
  }
  final DruidServer toServer=serverInventoryView.getInventoryValue(to);
  if (toServer == null) {
    throw new IllegalArgumentException(String.format("Unable to find server [%s]",to));
  }
  final DataSegment segment=fromServer.getSegment(segmentName);
  if (segment == null) {
    throw new IllegalArgumentException(String.format("Unable to find segment [%s] on server [%s]",segmentName,from));
  }
  final LoadQueuePeon loadPeon=loadManagementPeons.get(to);
  if (loadPeon == null) {
    throw new IllegalArgumentException(String.format("LoadQueuePeon hasn't been created yet for path [%s]",to));
  }
  final ServerHolder toHolder=new ServerHolder(toServer,loadPeon);
  if (toHolder.getAvailableSize() < segment.getSize()) {
    throw new IllegalArgumentException(String.format("Not enough capacity on server [%s] for segment [%s]. Required: %,d, available: %,d.",to,segment,segment.getSize(),toHolder.getAvailableSize()));
  }
  if (!loadPeon.getSegmentsToLoad().contains(segment)) {
    loadPeon.loadSegment(segment,callback);
  }
}
