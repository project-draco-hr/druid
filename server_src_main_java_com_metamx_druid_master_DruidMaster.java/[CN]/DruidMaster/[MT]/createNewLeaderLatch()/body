{
  final LeaderLatch newLeaderLatch=new LeaderLatch(curator,ZKPaths.makePath(zkPaths.getMasterPath(),MASTER_OWNER_NODE),config.getHost());
  newLeaderLatch.attachListener(new LeaderLatchListener(){
    @Override public void becomeMaster(){
      DruidMaster.this.becomeMaster();
    }
    @Override public void stopBeingMaster(){
      DruidMaster.this.stopBeingMaster();
    }
  }
,Execs.singleThreaded("MasterLeader-%s"));
  return leaderLatch.getAndSet(newLeaderLatch);
}
