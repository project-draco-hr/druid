{
  DelegatingSegmentLoader delegateLoader=new DelegatingSegmentLoader();
  final S3DataSegmentPuller segmentGetter=new S3DataSegmentPuller(s3Client);
  final QueryableIndexFactory factory=new MMappedQueryableIndexFactory();
  SingleSegmentLoader s3segmentLoader=new SingleSegmentLoader(segmentGetter,factory,config);
  delegateLoader.setLoaderTypes(ImmutableMap.<String,SegmentLoader>builder().put("s3",s3segmentLoader).put("s3_zip",s3segmentLoader).put("local",new SingleSegmentLoader(new LocalDataSegmentPuller(),factory,config)).put("hdfs",new SingleSegmentLoader(new HdfsDataSegmentPuller(new Configuration()),factory,config)).build());
  return delegateLoader;
}
