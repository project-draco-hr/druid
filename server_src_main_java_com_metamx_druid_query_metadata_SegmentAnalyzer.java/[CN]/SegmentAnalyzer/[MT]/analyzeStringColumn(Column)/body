{
  final ColumnCapabilities capabilities=column.getCapabilities();
  if (capabilities.hasBitmapIndexes()) {
    final BitmapIndex bitmapIndex=column.getBitmapIndex();
    int cardinality=bitmapIndex.getCardinality();
    long size=0;
    for (int i=0; i < cardinality; ++i) {
      String value=bitmapIndex.getValue(i);
      if (value != null) {
        size+=value.getBytes(Charsets.UTF_8).length * bitmapIndex.getConciseSet(value).size();
      }
    }
    return new ColumnAnalysis(capabilities.getType(),size,cardinality);
  }
  return ColumnAnalysis.error("string_no_bitmap");
}
