{
  final EqualDistributionWorkerSelectStrategy strategy=new EqualDistributionWorkerSelectStrategy();
  Optional<ImmutableZkWorker> optional=strategy.findWorkerForTask(new RemoteTaskRunnerConfig(),ImmutableMap.of("lhost",new ImmutableZkWorker(new Worker("lhost","lhost",1,"v1",DateTime.now()),0,Sets.<String>newHashSet()),"localhost",new ImmutableZkWorker(new Worker("localhost","localhost",1,"v1",DateTime.now()),1,Sets.<String>newHashSet())),new NoopTask(null,1,0,null,null,null){
    @Override public String getDataSource(){
      return "foo";
    }
  }
);
  ImmutableZkWorker worker=optional.get();
  Assert.assertEquals("lhost",worker.getWorker().getHost());
}
