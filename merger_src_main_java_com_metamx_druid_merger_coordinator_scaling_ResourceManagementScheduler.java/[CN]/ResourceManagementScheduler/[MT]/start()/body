{
synchronized (lock) {
    if (started) {
      return;
    }
    log.info("Started Resource Management Scheduler");
    ScheduledExecutors.scheduleAtFixedRate(exec,config.getProvisionResourcesDuration(),new Runnable(){
      @Override public void run(){
        log.info("Running resource management strategy");
        resourceManagementStrategy.doProvision(taskRunner.getPendingTasks(),taskRunner.getWorkers());
      }
    }
);
    Period period=new Period(config.getTerminateResourcesDuration());
    PeriodGranularity granularity=new PeriodGranularity(period,config.getTerminateResourcesOriginDateTime(),null);
    final long startTime=granularity.next(granularity.truncate(new DateTime().getMillis()));
    ScheduledExecutors.scheduleAtFixedRate(exec,new Duration(System.currentTimeMillis(),startTime),config.getTerminateResourcesDuration(),new Runnable(){
      @Override public void run(){
        resourceManagementStrategy.doTerminate(taskRunner.getPendingTasks(),taskRunner.getWorkers());
      }
    }
);
    started=true;
  }
}
