{
synchronized (lock) {
    Object announcementMap=announcements.remove(serviceName,nodeName);
    Map<String,Object> storedProperties=lookup(combineParts(Arrays.asList(serviceName,nodeName)),Map.class);
    if (announcementMap == null || storedProperties == null) {
      return;
    }
    boolean areEqual=false;
    try {
      areEqual=storedProperties.equals(jsonMapper.readValue(jsonMapper.writeValueAsString(announcementMap),Map.class));
    }
 catch (    IOException e) {
      throw new RuntimeException(e);
    }
    log.debug("equal?[%s]: announcementMap[%s], storedProperties[%s].",areEqual,announcementMap,storedProperties);
    if (areEqual) {
      zkClient.delete(getPath(serviceName,nodeName));
    }
  }
}
