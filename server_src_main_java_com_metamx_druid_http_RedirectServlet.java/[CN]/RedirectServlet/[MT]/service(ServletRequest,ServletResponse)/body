{
  HttpServletRequest request;
  HttpServletResponse response;
  try {
    request=(HttpServletRequest)req;
    response=(HttpServletResponse)res;
  }
 catch (  ClassCastException e) {
    throw new ServletException("non-HTTP request or response");
  }
  if (redirectInfo.doLocal()) {
    super.service(request,response);
  }
 else {
    final URL redirectURL=redirectInfo.getRedirectURL(request.getQueryString(),request.getRequestURI());
    if (redirectURL == null) {
      response.setStatus(HttpServletResponse.SC_SERVICE_UNAVAILABLE);
    }
 else {
      log.info("Forwarding request to [%s]",redirectURL);
      response.setStatus(HttpServletResponse.SC_MOVED_TEMPORARILY);
      response.setHeader("Location",redirectURL.toString());
    }
  }
}
