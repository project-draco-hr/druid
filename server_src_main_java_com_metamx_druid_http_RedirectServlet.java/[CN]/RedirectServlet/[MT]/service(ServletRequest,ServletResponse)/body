{
  HttpServletRequest request;
  HttpServletResponse response;
  try {
    request=(HttpServletRequest)req;
    response=(HttpServletResponse)res;
  }
 catch (  ClassCastException e) {
    throw new ServletException("non-HTTP request or response");
  }
  if (redirectInfo.doLocal()) {
    super.service(request,response);
  }
 else {
    URL url=redirectInfo.getRedirectURL(request.getQueryString(),request.getRequestURI());
    log.info("Forwarding request to [%s]",url);
    response.setStatus(HttpServletResponse.SC_MOVED_TEMPORARILY);
    response.setHeader("Location",url.toString());
  }
}
