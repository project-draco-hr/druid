{
  final MutableBoolean committed=new MutableBoolean(false);
  plumber.startJob();
  plumber.persist(new Runnable(){
    @Override public void run(){
      committed.setValue(true);
    }
  }
);
  Stopwatch stopwatch=Stopwatch.createStarted();
  while (!committed.booleanValue()) {
    Thread.sleep(100);
    if (stopwatch.elapsed(TimeUnit.MILLISECONDS) > 1000) {
      throw new ISE("Taking too long to set perist value");
    }
  }
  plumber.finishJob();
}
