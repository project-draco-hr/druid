{
  final QueryToolChest<T,Query<T>> toolChest=warehouse.getToolChest(query);
  final FinalizeResultsQueryRunner<T> baseRunner=new FinalizeResultsQueryRunner<T>(toolChest.postMergeQueryDecoration(toolChest.mergeResults(toolChest.preMergeQueryDecoration(new RetryQueryRunner<T>(baseClient,toolChest,retryConfig,objectMapper)))),toolChest);
  final Map<String,Object> context=query.getContext();
  PostProcessingOperator<T> postProcessing=null;
  if (context != null) {
    postProcessing=objectMapper.convertValue(context.get("postProcessing"),new TypeReference<PostProcessingOperator<T>>(){
    }
);
  }
  return postProcessing != null ? postProcessing.postProcess(baseRunner) : baseRunner;
}
