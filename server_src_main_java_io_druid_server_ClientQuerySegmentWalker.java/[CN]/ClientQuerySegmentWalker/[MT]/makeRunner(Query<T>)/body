{
  final QueryToolChest<T,Query<T>> toolChest=warehouse.getToolChest(query);
  return new FinalizeResultsQueryRunner<T>(toolChest.postMergeQueryDecoration(toolChest.mergeResults(new UnionQueryRunner<T>(new MetricsEmittingQueryRunner<T>(emitter,new Function<Query<T>,ServiceMetricEvent.Builder>(){
    @Override public ServiceMetricEvent.Builder apply(    @Nullable Query<T> input){
      return toolChest.makeMetricBuilder(query);
    }
  }
,toolChest.preMergeQueryDecoration(new RetryQueryRunner<T>(baseClient,toolChest))).withWaitMeasuredFromNow(),toolChest))),toolChest);
}
