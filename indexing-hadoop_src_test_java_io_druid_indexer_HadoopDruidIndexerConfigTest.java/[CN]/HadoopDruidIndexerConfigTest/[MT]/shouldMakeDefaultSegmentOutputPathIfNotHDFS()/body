{
  final HadoopIngestionSchema schema;
  try {
    schema=jsonReadWriteRead("{" + "\"dataSource\": \"the:data:source\"," + " \"granularitySpec\":{"+ "   \"type\":\"uniform\","+ "   \"gran\":\"hour\","+ "   \"intervals\":[\"2012-07-10/P1D\"]"+ " },"+ "\"segmentOutputPath\": \"/tmp/dru:id/data:test\""+ "}",HadoopIngestionSchema.class);
  }
 catch (  Exception e) {
    throw Throwables.propagate(e);
  }
  HadoopDruidIndexerConfig cfg=new HadoopDruidIndexerConfig(schema.withDriverConfig(schema.getDriverConfig().withVersion("some:brand:new:version")));
  Bucket bucket=new Bucket(4711,new DateTime(2012,07,10,5,30),4712);
  Path path=cfg.makeSegmentOutputPath(new LocalFileSystem(),bucket);
  Assert.assertEquals("/tmp/dru:id/data:test/the:data:source/2012-07-10T05:00:00.000Z_2012-07-10T06:00:00.000Z/some:brand:new:version/4712",path.toString());
}
