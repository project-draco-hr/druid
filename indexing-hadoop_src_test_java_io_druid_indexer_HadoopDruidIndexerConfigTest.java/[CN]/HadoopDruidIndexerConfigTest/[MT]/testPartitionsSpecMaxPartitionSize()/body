{
  final HadoopDruidIndexerConfig cfg;
  try {
    cfg=jsonReadWriteRead("{" + "\"partitionsSpec\":{" + "   \"targetPartitionSize\":100,"+ "   \"maxPartitionSize\":200,"+ "   \"partitionDimension\":\"foo\""+ " }"+ "}",HadoopDruidIndexerConfig.class);
  }
 catch (  Exception e) {
    throw Throwables.propagate(e);
  }
  final PartitionsSpec partitionsSpec=cfg.getPartitionsSpec();
  Assert.assertEquals("isDeterminingPartitions",partitionsSpec.isDeterminingPartitions(),true);
  Assert.assertEquals("getTargetPartitionSize",partitionsSpec.getTargetPartitionSize(),100);
  Assert.assertEquals("getMaxPartitionSize",partitionsSpec.getMaxPartitionSize(),200);
  Assert.assertTrue("partitionsSpec",partitionsSpec instanceof SingleDimensionPartitionsSpec);
  Assert.assertEquals("getPartitionDimension",((SingleDimensionPartitionsSpec)partitionsSpec).getPartitionDimension(),"foo");
}
