{
  try {
    lifecycle.addMaybeStartHandler(new Lifecycle.Handler(){
      @Override public void start() throws Exception {
        dbConnector.createRulesTable();
        SQLMetadataRuleManager.createDefaultRule(dbi,dbTables.get().getRulesTable(),config.get().getDefaultRule(),jsonMapper);
      }
      @Override public void stop(){
      }
    }
);
  }
 catch (  Exception e) {
    throw Throwables.propagate(e);
  }
  return new DerbyMetadataRuleManager(jsonMapper,config,dbTables,dbi);
}
