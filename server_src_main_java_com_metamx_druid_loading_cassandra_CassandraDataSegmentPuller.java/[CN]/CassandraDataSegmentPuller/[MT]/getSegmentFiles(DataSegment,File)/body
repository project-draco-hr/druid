{
  String key=(String)segment.getLoadSpec().get("key");
  log.info("Pulling index from C* at path[%s] to outDir[%s]",key,outDir);
  if (!outDir.exists()) {
    outDir.mkdirs();
  }
  if (!outDir.isDirectory()) {
    throw new ISE("outDir[%s] must be a directory.",outDir);
  }
  long startTime=System.currentTimeMillis();
  ObjectMetadata meta=null;
  try {
    final File outFile=new File(outDir,toFilename(key,".gz"));
    meta=ChunkedStorage.newReader(indexStorage,key,Files.newOutputStreamSupplier(outFile).getOutput()).withBatchSize(BATCH_SIZE).withConcurrencyLevel(CONCURRENCY).call();
  }
 catch (  Exception e) {
    log.error("Could not pull segment [" + key + "] from C*",e);
    try {
      FileUtils.deleteDirectory(outDir);
    }
 catch (    IOException ioe) {
      log.error("Couldn't delete directory [" + outDir + "] for cleanup.",ioe);
    }
  }
  log.info("Pull of file[%s] completed in %,d millis (%s chunks)",key,System.currentTimeMillis() - startTime,meta.getChunkSize());
}
