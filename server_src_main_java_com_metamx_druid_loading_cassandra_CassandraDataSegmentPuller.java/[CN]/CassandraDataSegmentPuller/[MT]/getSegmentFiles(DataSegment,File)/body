{
  String key=(String)segment.getLoadSpec().get("key");
  log.info("Pulling index from C* at path[%s] to outDir[%s]",key,outDir);
  if (!outDir.exists()) {
    outDir.mkdirs();
  }
  if (!outDir.isDirectory()) {
    throw new ISE("outDir[%s] must be a directory.",outDir);
  }
  long startTime=System.currentTimeMillis();
  ObjectMetadata meta=null;
  final File outFile=new File(outDir,"index.zip");
  try {
    try {
      log.info("Writing to [" + outFile.getAbsolutePath() + "]");
      OutputStream os=Files.newOutputStreamSupplier(outFile).getOutput();
      meta=ChunkedStorage.newReader(indexStorage,key,os).withBatchSize(BATCH_SIZE).withConcurrencyLevel(CONCURRENCY).call();
      os.close();
      CompressionUtils.unzip(outFile,outDir);
    }
 catch (    Exception e) {
      FileUtils.deleteDirectory(outDir);
    }
  }
 catch (  Exception e) {
    throw new SegmentLoadingException(e,e.getMessage());
  }
  log.info("Pull of file[%s] completed in %,d millis (%s bytes)",key,System.currentTimeMillis() - startTime,meta.getObjectSize());
}
