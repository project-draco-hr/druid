{
  final HadoopDruidIndexerConfig cfg;
  cfg=jsonReadWriteRead("{" + "\"updaterJobSpec\":{\n" + "    \"type\" : \"db\",\n"+ "    \"connectURI\" : \"jdbc:mysql://localhost/druid\",\n"+ "    \"user\" : \"rofl\",\n"+ "    \"password\" : \"p4ssw0rd\",\n"+ "    \"segmentTable\" : \"segments\"\n"+ "  }"+ "}",HadoopDruidIndexerConfig.class);
  final DbUpdaterJobSpec spec=(DbUpdaterJobSpec)cfg.getUpdaterJobSpec();
  Assert.assertEquals("segments",spec.getSegmentTable());
  Assert.assertEquals("jdbc:mysql://localhost/druid",spec.getDatabaseConnectURI());
  Assert.assertEquals("rofl",spec.getDatabaseUser());
  Assert.assertEquals("p4ssw0rd",spec.getDatabasePassword());
  Assert.assertEquals(false,spec.useValidationQuery());
}
