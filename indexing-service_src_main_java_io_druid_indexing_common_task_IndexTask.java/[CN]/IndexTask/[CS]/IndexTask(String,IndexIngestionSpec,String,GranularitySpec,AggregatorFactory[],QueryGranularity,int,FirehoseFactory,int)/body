{
  super(makeId(id,ingestionSchema,dataSource),makeDataSource(ingestionSchema,dataSource),makeInterval(ingestionSchema,granularitySpec));
  if (ingestionSchema != null) {
    this.ingestionSchema=ingestionSchema;
  }
 else {
    this.ingestionSchema=new IndexIngestionSpec(new DataSchema(dataSource,firehoseFactory.getParser(),aggregators,granularitySpec.withQueryGranularity(indexGranularity == null ? QueryGranularity.NONE : indexGranularity)),new IndexIOConfig(firehoseFactory),new IndexTuningConfig(targetPartitionSize,rowFlushBoundary));
  }
}
