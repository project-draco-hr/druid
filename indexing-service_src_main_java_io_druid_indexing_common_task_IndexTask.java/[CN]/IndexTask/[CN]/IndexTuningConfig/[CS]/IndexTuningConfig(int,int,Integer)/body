{
  this.targetPartitionSize=targetPartitionSize == 0 ? DEFAULT_TARGET_PARTITION_SIZE : targetPartitionSize;
  this.bufferSize=bufferSize == 0 ? DEFAULT_BUFFER_SIZE : bufferSize;
  this.numShards=numShards == null ? -1 : numShards;
  Preconditions.checkArgument(this.targetPartitionSize == -1 || this.numShards == -1,"targetPartitionsSize and shardCount both cannot be set");
}
