{
  if (announcer == null) {
    final Announcer announcer=new Announcer(getCuratorFramework(),Execs.singleThreaded("Announcer-%s"));
    lifecycle.addManagedInstance(announcer);
    setAnnouncer(new MultipleDataSegmentAnnouncerDataSegmentAnnouncer(getDruidServerMetadata(),getZkPaths(),announcer,getJsonMapper(),Arrays.<DataSegmentAnnouncer>asList(new BatchingCuratorDataSegmentAnnouncer(getDruidServerMetadata(),getZkPaths(),announcer,getJsonMapper(),new SegmentReader(curator,getJsonMapper())),new CuratorDataSegmentAnnouncer(getDruidServerMetadata(),getZkPaths(),announcer,getJsonMapper()))));
    lifecycle.addManagedInstance(getAnnouncer(),Lifecycle.Stage.LAST);
  }
}
