{
  LOG.info("Starting query tests for [%s]",filePath);
  List<QueryWithResults> queries=jsonMapper.readValue(FromFileTestQueryHelper.class.getResourceAsStream(filePath),new TypeReference<List<QueryWithResults>>(){
  }
);
  for (int i=0; i < timesToRun; i++) {
    LOG.info("Starting Iteration " + i);
    boolean failed=false;
    for (    QueryWithResults queryWithResult : queries) {
      LOG.info("Running Query " + queryWithResult.getQuery().getType());
      List<Map<String,Object>> result=queryClient.query(queryWithResult.getQuery());
      if (!QueryResultVerifier.compareResults(result,queryWithResult.getExpectedResults())) {
        LOG.error("Failed while executing %s actualResults : %s",queryWithResult,jsonMapper.writeValueAsString(result));
        failed=true;
      }
 else {
        LOG.info("Results Verified for Query " + queryWithResult.getQuery().getType());
      }
    }
    if (failed) {
      throw new ISE("one or more twitter  queries failed");
    }
  }
}
