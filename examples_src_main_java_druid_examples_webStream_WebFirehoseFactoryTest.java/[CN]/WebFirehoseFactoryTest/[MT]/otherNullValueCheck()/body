{
  Map<String,Object> expectedAnswer=new HashMap<String,Object>();
  expectedAnswer.put("a","Mozilla/5.0 (Windows NT 6.1; WOW64; rv:21.0) Gecko/20100101 Firefox/21.0");
  expectedAnswer.put("nk",1);
  expectedAnswer.put("tz","America/New_York");
  expectedAnswer.put("gr","NY");
  expectedAnswer.put("g","1Chgyj");
  expectedAnswer.put("h","15vMQjX");
  expectedAnswer.put("l","o_d63rn9enb");
  expectedAnswer.put("al","en-US,en;q=0.5");
  expectedAnswer.put("hh","1.usa.gov");
  expectedAnswer.put("r","http://forecast.weather.gov/MapClick.php?site=okx&FcstType=text&zmx=1&zmy=1&map.x=98&map.y=200&site=OKX");
  expectedAnswer.put("u","http://www.spc.ncep.noaa.gov/");
  expectedAnswer.put("t",1372121562);
  expectedAnswer.put("hc",1368193091);
  expectedAnswer.put("cy","New York");
  expectedAnswer.put("ll",Arrays.asList(40.862598,-73.921799));
  queue=new ArrayBlockingQueue<Map<String,Object>>(QUEUE_SIZE);
  testCaseSupplier=new TestCaseSupplier("{ \"a\": \"Mozilla\\/5.0 (Windows NT 6.1; WOW64; rv:21.0) Gecko\\/20100101 Firefox\\/21.0\", \"nk\": 1, \"tz\": \"America\\/New_York\", \"gr\": \"NY\", \"g\": \"1Chgyj\", \"h\": \"15vMQjX\", \"l\": \"o_d63rn9enb\", \"al\": \"en-US,en;q=0.5\", \"hh\": \"1.usa.gov\", \"r\": \"http:\\/\\/forecast.weather.gov\\/MapClick.php?site=okx&FcstType=text&zmx=1&zmy=1&map.x=98&map.y=200&site=OKX\", \"u\": \"http:\\/\\/www.spc.ncep.noaa.gov\\/\", \"t\": 1372121562, \"hc\": 1368193091, \"cy\": \"New York\", \"ll\": [ 40.862598, -73.921799 ] }");
  UpdateStream updateStream=new UpdateStream(testCaseSupplier,queue,mapper,null,timeDimension);
  updateStream.run();
  Map<String,Object> insertedRow=queue.poll(10,TimeUnit.SECONDS);
  Assert.assertEquals(expectedAnswer,insertedRow);
}
