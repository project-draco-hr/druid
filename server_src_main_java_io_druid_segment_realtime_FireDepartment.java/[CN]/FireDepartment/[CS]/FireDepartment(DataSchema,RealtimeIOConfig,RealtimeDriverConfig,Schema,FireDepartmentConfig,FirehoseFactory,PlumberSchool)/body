{
  if (dataSchema == null) {
    Preconditions.checkNotNull(schema,"schema");
    Preconditions.checkNotNull(config,"config");
    Preconditions.checkNotNull(firehoseFactory,"firehoseFactory");
    Preconditions.checkNotNull(plumberSchool,"plumberSchool");
    this.dataSchema=new DataSchema(schema.getDataSource(),firehoseFactory.getParser(),schema.getAggregators(),new UniformGranularitySpec(plumberSchool.getSegmentGranularity(),schema.getIndexGranularity(),Lists.<Interval>newArrayList(),plumberSchool.getSegmentGranularity()));
    this.ioConfig=new RealtimeIOConfig(firehoseFactory,plumberSchool);
    this.driverConfig=new RealtimeDriverConfig(config.getMaxRowsInMemory(),config.getIntermediatePersistPeriod(),schema.getShardSpec());
  }
 else {
    Preconditions.checkNotNull(dataSchema,"dataSchema");
    Preconditions.checkNotNull(ioConfig,"ioConfig");
    Preconditions.checkNotNull(driverConfig,"driverConfig");
    this.dataSchema=dataSchema;
    this.ioConfig=ioConfig;
    this.driverConfig=driverConfig;
  }
}
