{
  try {
    S3Utils.retryS3Operation(new Callable<Void>(){
      @Override public Void call() throws Exception {
        if (s3Client.isObjectInBucket(s3Bucket,s3Path)) {
          if (s3Bucket.equals(targetS3Bucket) && s3Path.equals(targetS3Path)) {
            log.info("No need to move file[s3://%s/%s] onto itself",s3Bucket,s3Path);
          }
 else           if (s3Client.getObjectDetails(s3Bucket,s3Path).getStorageClass().equals(S3Object.STORAGE_CLASS_GLACIER)) {
            log.warn("Cannot move file[s3://%s/%s] of storage class glacier.");
          }
 else {
            log.info("Moving file[s3://%s/%s] to [s3://%s/%s]",s3Bucket,s3Path,targetS3Bucket,targetS3Path);
            final S3Object target=new S3Object(targetS3Path);
            if (!config.getDisableAcl()) {
              target.setAcl(GSAccessControlList.REST_CANNED_BUCKET_OWNER_FULL_CONTROL);
            }
            s3Client.moveObject(s3Bucket,s3Path,targetS3Bucket,target,false);
          }
        }
 else {
          if (s3Client.isObjectInBucket(targetS3Bucket,targetS3Path)) {
            log.info("Not moving file [s3://%s/%s], already present in target location [s3://%s/%s]",s3Bucket,s3Path,targetS3Bucket,targetS3Path);
          }
 else {
            throw new SegmentLoadingException("Unable to move file [s3://%s/%s] to [s3://%s/%s], not present in either source or target location",s3Bucket,s3Path,targetS3Bucket,targetS3Path);
          }
        }
        return null;
      }
    }
);
  }
 catch (  Exception e) {
    Throwables.propagateIfInstanceOf(e,ServiceException.class);
    Throwables.propagateIfInstanceOf(e,SegmentLoadingException.class);
    throw Throwables.propagate(e);
  }
}
