{
  final ColumnCapabilities capabilities=column.getCapabilities();
  final ComplexColumn complexColumn=column.getComplexColumn();
  final String typeName=complexColumn.getTypeName();
  final ComplexMetricSerde serde=ComplexMetrics.getSerdeForType(typeName);
  if (serde == null) {
    return ColumnAnalysis.error(String.format("unknown_complex_%s",typeName));
  }
  final Function<Object,Long> inputSizeFn=serde.inputSizeFn();
  if (inputSizeFn == null) {
    return new ColumnAnalysis(typeName,0,null,null);
  }
  final int length=column.getLength();
  long size=0;
  if (analysisHasSize(analysisTypes)) {
    for (int i=0; i < length; ++i) {
      size+=inputSizeFn.apply(complexColumn.getRowValue(i));
    }
  }
  return new ColumnAnalysis(typeName,size,null,null);
}
