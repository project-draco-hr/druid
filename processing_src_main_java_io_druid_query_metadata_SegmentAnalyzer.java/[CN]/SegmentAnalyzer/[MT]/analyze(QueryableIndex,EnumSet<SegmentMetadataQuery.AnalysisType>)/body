{
  Preconditions.checkNotNull(index,"Index cannot be null");
  Map<String,ColumnAnalysis> columns=Maps.newTreeMap();
  for (  String columnName : index.getColumnNames()) {
    final Column column=index.getColumn(columnName);
    final ColumnCapabilities capabilities=column.getCapabilities();
    final ColumnAnalysis analysis;
    final ValueType type=capabilities.getType();
switch (type) {
case LONG:
      analysis=analyzeLongColumn(column,analysisTypes);
    break;
case FLOAT:
  analysis=analyzeFloatColumn(column,analysisTypes);
break;
case STRING:
analysis=analyzeStringColumn(column,analysisTypes);
break;
case COMPLEX:
analysis=analyzeComplexColumn(column,analysisTypes);
break;
default :
log.warn("Unknown column type[%s].",type);
analysis=ColumnAnalysis.error(String.format("unknown_type_%s",type));
}
columns.put(columnName,analysis);
}
columns.put(Column.TIME_COLUMN_NAME,lengthBasedAnalysis(index.getColumn(Column.TIME_COLUMN_NAME),NUM_BYTES_IN_TIMESTAMP,analysisTypes));
return columns;
}
