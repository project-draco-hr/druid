{
  final ColumnCapabilities capabilities=column.getCapabilities();
  if (capabilities.hasBitmapIndexes()) {
    final BitmapIndex bitmapIndex=column.getBitmapIndex();
    int cardinality=bitmapIndex.getCardinality();
    long size=0;
    if (analysisHasSize(analysisTypes)) {
      for (int i=0; i < cardinality; ++i) {
        String value=bitmapIndex.getValue(i);
        if (value != null) {
          size+=StringUtils.toUtf8(value).length * bitmapIndex.getBitmap(value).size();
        }
      }
    }
    return new ColumnAnalysis(capabilities.getType().name(),size,analysisHasCardinality(analysisTypes) ? cardinality : 0,null);
  }
  return ColumnAnalysis.error("string_no_bitmap");
}
