{
  long size=0;
  if (column != null && analyzingSize()) {
    if (!capabilities.hasBitmapIndexes()) {
      return ColumnAnalysis.error("string_no_bitmap");
    }
    final BitmapIndex bitmapIndex=column.getBitmapIndex();
    if (cardinality != bitmapIndex.getCardinality()) {
      return ColumnAnalysis.error("bitmap_wrong_cardinality");
    }
    for (int i=0; i < cardinality; ++i) {
      String value=bitmapIndex.getValue(i);
      if (value != null) {
        size+=StringUtils.toUtf8(value).length * bitmapIndex.getBitmap(value).size();
      }
    }
  }
  return new ColumnAnalysis(capabilities.getType().name(),capabilities.hasMultipleValues(),size,analyzingCardinality() ? cardinality : 0,null);
}
