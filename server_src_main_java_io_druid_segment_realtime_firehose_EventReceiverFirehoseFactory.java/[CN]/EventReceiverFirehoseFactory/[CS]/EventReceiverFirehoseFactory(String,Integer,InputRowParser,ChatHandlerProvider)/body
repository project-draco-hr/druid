{
  Preconditions.checkNotNull(parser,"parser");
  Preconditions.checkNotNull(serviceName,"serviceName");
  this.serviceName=serviceName;
  this.bufferSize=bufferSize == null || bufferSize <= 0 ? DEFAULT_BUFFER_SIZE : bufferSize;
  this.parser=new MapInputRowParser(parser.getParseSpec(),null,null,null,null);
  this.chatHandlerProvider=Optional.fromNullable(chatHandlerProvider);
}
