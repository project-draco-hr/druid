{
  addToQueueThread=new Thread(){
    public void run(){
      while (!isInterrupted()) {
        try {
          BufferedReader reader=supplier.getInput();
          String line;
          while ((line=reader.readLine()) != null) {
            if (isValid(line)) {
              HashMap<String,Object> map=mapper.readValue(line,typeRef);
              if (map.get(timeDimension) != null) {
                queue.offer(map,queueWaitTime,TimeUnit.SECONDS);
                log.debug("Successfully added to queue");
              }
 else {
                log.info("missing timestamp");
              }
            }
          }
        }
 catch (        InterruptedException e) {
          log.info(e,"Thread adding events to the queue interrupted");
          return;
        }
catch (        JsonMappingException e) {
          log.info(e,"Error in converting json to map");
        }
catch (        JsonParseException e) {
          log.info(e,"Error in parsing json");
        }
catch (        IOException e) {
          log.info(e,"Error in connecting to InputStream");
        }
      }
    }
  }
;
  addToQueueThread.setDaemon(true);
  this.supplier=supplier;
  this.typeRef=new TypeReference<HashMap<String,Object>>(){
  }
;
  this.timeDimension=timeDimension;
}
