{
  int nTry=0;
  final int maxTries=3;
  final long baseSleepMillis=1000;
  final double fuzziness=0.2;
  while (true) {
    try {
      nTry++;
      return f.call();
    }
 catch (    ServiceException e) {
      if (nTry <= maxTries && (e.getCause() instanceof IOException || (e.getErrorCode() != null && e.getErrorCode().equals("RequestTimeout")))) {
        final long sleepMillis=Math.max(baseSleepMillis,(long)(baseSleepMillis * Math.pow(2,nTry) * (1 + new Random().nextGaussian() * fuzziness)));
        log.info(e,"S3 fail on try %d/%d, retrying in %,dms.",nTry,maxTries,sleepMillis);
        Thread.sleep(sleepMillis);
      }
 else {
        throw e;
      }
    }
catch (    Exception e) {
      throw Throwables.propagate(e);
    }
  }
}
