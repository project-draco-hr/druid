{
  return dbi.withHandle(new HandleCallback<Map<Long,TaskLock>>(){
    @Override public Map<Long,TaskLock> withHandle(    Handle handle) throws Exception {
      final List<Map<String,Object>> dbTaskLocks=handle.createQuery(String.format("SELECT id, lock_payload FROM %s WHERE task_id = :task_id",dbConnectorConfig.getTaskLockTable())).bind("task_id",taskid).list();
      final Map<Long,TaskLock> retMap=Maps.newHashMap();
      for (      final Map<String,Object> row : dbTaskLocks) {
        retMap.put((Long)row.get("id"),jsonMapper.readValue(row.get("lock_payload").toString(),TaskLock.class));
      }
      return retMap;
    }
  }
);
}
