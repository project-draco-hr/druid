{
  return dbi.withHandle(new HandleCallback<List<Task>>(){
    @Override public List<Task> withHandle(    Handle handle) throws Exception {
      final List<Map<String,Object>> dbTasks=handle.createQuery(String.format("SELECT payload FROM %s WHERE status_code = :status_code",dbConnectorConfig.getTaskTable())).bind("status_code",TaskStatus.Status.RUNNING.toString()).list();
      return Lists.transform(dbTasks,new Function<Map<String,Object>,Task>(){
        @Override public Task apply(        Map<String,Object> row){
          try {
            return jsonMapper.readValue(row.get("payload").toString(),Task.class);
          }
 catch (          Exception e) {
            throw Throwables.propagate(e);
          }
        }
      }
);
    }
  }
);
}
