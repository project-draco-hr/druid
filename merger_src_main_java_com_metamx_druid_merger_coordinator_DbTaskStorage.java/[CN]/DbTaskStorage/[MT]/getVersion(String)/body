{
  return dbi.withHandle(new HandleCallback<Optional<String>>(){
    @Override public Optional<String> withHandle(    Handle handle) throws Exception {
      final List<Map<String,Object>> dbStatuses=handle.createQuery(String.format("SELECT version FROM %s WHERE id = :id",dbConnectorConfig.getTaskTable())).bind("id",taskid).list();
      if (dbStatuses.size() == 0) {
        return Optional.absent();
      }
 else {
        final Map<String,Object> dbStatus=Iterables.getOnlyElement(dbStatuses);
        return Optional.fromNullable((String)dbStatus.get("version"));
      }
    }
  }
);
}
