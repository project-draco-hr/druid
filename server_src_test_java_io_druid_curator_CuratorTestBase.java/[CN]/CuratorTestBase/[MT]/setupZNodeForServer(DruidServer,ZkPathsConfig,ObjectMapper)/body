{
  final String announcementsPath=zkPathsConfig.getAnnouncementsPath();
  final String inventoryPath=zkPathsConfig.getLiveSegmentsPath();
  final String zNodePathAnnounce=ZKPaths.makePath(announcementsPath,server.getHost());
  final String zNodePathSegment=ZKPaths.makePath(inventoryPath,server.getHost());
  if (curator.checkExists().forPath(zNodePathAnnounce) != null) {
    curator.delete().guaranteed().forPath(zNodePathAnnounce);
  }
  if (curator.checkExists().forPath(zNodePathSegment) != null) {
    curator.delete().guaranteed().forPath(zNodePathSegment);
  }
  curator.create().creatingParentsIfNeeded().forPath(ZKPaths.makePath(announcementsPath,server.getHost()),jsonMapper.writeValueAsBytes(server.getMetadata()));
  curator.create().creatingParentsIfNeeded().forPath(ZKPaths.makePath(inventoryPath,server.getHost()));
}
