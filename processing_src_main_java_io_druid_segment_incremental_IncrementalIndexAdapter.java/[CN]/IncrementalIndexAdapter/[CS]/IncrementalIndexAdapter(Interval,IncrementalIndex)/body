{
  this.dataInterval=dataInterval;
  this.index=index;
  this.invertedIndexes=Maps.newHashMap();
  for (  String dimension : index.getDimensions()) {
    invertedIndexes.put(dimension,Maps.<String,ConciseSet>newHashMap());
  }
  int rowNum=0;
  for (  IncrementalIndex.TimeAndDims timeAndDims : index.getFacts().keySet()) {
    final int[][] dims=timeAndDims.getDims();
    for (    String dimension : index.getDimensions()) {
      int dimIndex=index.getDimensionIndex(dimension);
      Map<String,ConciseSet> conciseSets=invertedIndexes.get(dimension);
      if (conciseSets == null || dims == null) {
        log.error("conciseSets and dims are null!");
        continue;
      }
      if (dimIndex >= dims.length || dims[dimIndex] == null) {
        continue;
      }
      final String[] dimValues=index.getDimValues(index.getDimension(dimension),dims[dimIndex]);
      for (      String dimValue : dimValues) {
        ConciseSet conciseSet=conciseSets.get(dimValue);
        if (conciseSet == null) {
          conciseSet=new ConciseSet();
          conciseSets.put(dimValue,conciseSet);
        }
        try {
          conciseSet.add(rowNum);
        }
 catch (        Exception e) {
          log.info(e.toString());
        }
      }
    }
    ++rowNum;
  }
}
