{
  this.dataInterval=dataInterval;
  this.index=index;
  this.invertedIndexes=Maps.newHashMap();
  this.hasNullValueDimensions=Sets.newHashSet();
  final List<IncrementalIndex.DimensionDesc> dimensions=index.getDimensions();
  for (  IncrementalIndex.DimensionDesc dimension : dimensions) {
    invertedIndexes.put(dimension.getName(),Maps.<String,MutableBitmap>newHashMap());
  }
  int rowNum=0;
  for (  IncrementalIndex.TimeAndDims timeAndDims : index.getFacts().keySet()) {
    final String[][] dims=timeAndDims.getDims();
    for (    IncrementalIndex.DimensionDesc dimension : dimensions) {
      final int dimIndex=dimension.getIndex();
      final Map<String,MutableBitmap> bitmapIndexes=invertedIndexes.get(dimension.getName());
      if (bitmapIndexes == null || dims == null) {
        log.error("bitmapIndexes and dims are null!");
        continue;
      }
      if (dimIndex >= dims.length || dims[dimIndex] == null) {
        hasNullValueDimensions.add(dimension.getName());
        continue;
      }
      if (hasNullValue(dims[dimIndex])) {
        hasNullValueDimensions.add(dimension.getName());
      }
      for (      String dimValue : dims[dimIndex]) {
        MutableBitmap mutableBitmap=bitmapIndexes.get(dimValue);
        if (mutableBitmap == null) {
          mutableBitmap=bitmapFactory.makeEmptyMutableBitmap();
          bitmapIndexes.put(dimValue,mutableBitmap);
        }
        try {
          mutableBitmap.add(rowNum);
        }
 catch (        Exception e) {
          log.info(e.toString());
        }
      }
    }
    ++rowNum;
  }
}
