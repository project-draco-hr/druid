{
  final TopNMetricSpecBuilder<int[]> arrayProvider=params.getArrayProvider();
  arrayProvider.ignoreFirstN(numProcessed);
  arrayProvider.keepOnlyN(numToProcess);
  return query.getTopNMetricSpec().configureOptimizer(arrayProvider).build();
}
