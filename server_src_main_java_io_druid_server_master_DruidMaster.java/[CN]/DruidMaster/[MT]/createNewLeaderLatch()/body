{
  final LeaderLatch newLeaderLatch=new LeaderLatch(curator,ZKPaths.makePath(zkPaths.getMasterPath(),MASTER_OWNER_NODE),config.getHost());
  newLeaderLatch.addListener(new LeaderLatchListener(){
    @Override public void isLeader(){
      DruidMaster.this.becomeMaster();
    }
    @Override public void notLeader(){
      DruidMaster.this.stopBeingMaster();
    }
  }
,Execs.singleThreaded("MasterLeader-%s"));
  return leaderLatch.getAndSet(newLeaderLatch);
}
