{
  Response.ResponseBuilder builder=Response.status(Response.Status.OK);
  if (includeDisabled != null) {
    return builder.entity(metadataSegmentManager.getAllDatasourceNames()).build();
  }
  if (full != null) {
    return builder.entity(metadataSegmentManager.getInventory()).build();
  }
  List<String> dataSourceNames=Lists.newArrayList(Iterables.transform(metadataSegmentManager.getInventory(),new Function<DruidDataSource,String>(){
    @Override public String apply(    DruidDataSource dataSource){
      return dataSource.getName();
    }
  }
));
  Collections.sort(dataSourceNames);
  return builder.entity(dataSourceNames).build();
}
