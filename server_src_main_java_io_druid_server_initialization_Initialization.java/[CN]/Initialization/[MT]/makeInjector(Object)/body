{
  final Injector baseInjector=Guice.createInjector(new DruidGuiceExtensions(),new JacksonModule(),new PropertiesModule("runtime.properties"),new ConfigModule(),new Module(){
    @Override public void configure(    Binder binder){
      binder.bind(DruidSecondaryModule.class);
      JsonConfigProvider.bind(binder,"druid.extensions",ExtensionsConfig.class);
      for (      Object module : modules) {
        if (module instanceof Class) {
          binder.bind((Class)module);
        }
      }
    }
  }
);
  ModuleList actualModules=new ModuleList(baseInjector);
  actualModules.addModule(DruidSecondaryModule.class);
  for (  Object module : modules) {
    actualModules.addModule(module);
  }
  addExtensionModules(baseInjector.getInstance(ExtensionsConfig.class),actualModules);
  return Guice.createInjector(actualModules.getModules());
}
