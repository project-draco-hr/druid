{
  final ServiceInstance<Void> instance;
synchronized (monitor) {
    instance=instanceMap.get(service);
    if (instance == null) {
      log.warn("Ignoring request to unannounce service[%s]",service);
      return;
    }
  }
  log.info("Unannouncing service[%s]",service);
  try {
    discovery.unregisterService(instance);
  }
 catch (  Exception e) {
    log.warn(e,"Failed to unannounce service[%s]",service);
  }
 finally {
synchronized (monitor) {
      instanceMap.remove(service);
    }
  }
}
