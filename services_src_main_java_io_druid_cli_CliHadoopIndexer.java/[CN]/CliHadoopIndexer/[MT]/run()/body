{
  try {
    final DefaultTeslaAether aetherClient=Initialization.getAetherClient(extensionsConfig);
    final ClassLoader hadoopLoader=Initialization.getClassLoaderForCoordinates(aetherClient,hadoopCoordinates);
    final List<URL> allURLs=com.google.common.collect.Lists.newArrayList();
    final List<URL> nonHadoopURLs=com.google.common.collect.Lists.newArrayList();
    for (    String coordinate : extensionsConfig.getCoordinates()) {
      final ClassLoader coordinateLoader=Initialization.getClassLoaderForCoordinates(aetherClient,coordinate);
      nonHadoopURLs.addAll(Arrays.asList(((URLClassLoader)coordinateLoader).getURLs()));
    }
    nonHadoopURLs.addAll(Arrays.asList(((URLClassLoader)CliHadoopIndexer.class.getClassLoader()).getURLs()));
    allURLs.addAll(nonHadoopURLs);
    allURLs.addAll(Arrays.asList(((URLClassLoader)hadoopLoader).getURLs()));
    final URLClassLoader loader=new URLClassLoader(allURLs.toArray(new URL[allURLs.size()]),null);
    Thread.currentThread().setContextClassLoader(loader);
    System.setProperty("druid.hadoop.internal.classpath",Joiner.on(File.pathSeparator).join(nonHadoopURLs));
    final Class<?> mainClass=loader.loadClass(Main.class.getName());
    final Method mainMethod=mainClass.getMethod("main",String[].class);
    String[] args=new String[]{"internal","hadoop-indexer",argumentSpec};
    mainMethod.invoke(null,new Object[]{args});
  }
 catch (  Exception e) {
    log.error(e,"failure!!!!");
    System.exit(1);
  }
}
