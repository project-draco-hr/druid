{
  this.flushDuration=flushDuration;
  this.windowPeriod=windowPeriod;
  this.basePersistDirectory=basePersistDirectory;
  this.segmentGranularity=segmentGranularity;
  this.versioningPolicy=new IntervalStartVersioningPolicy();
  this.rejectionPolicyFactory=new ServerTimeRejectionPolicyFactory();
  this.maxPendingPersists=maxPendingPersists;
  Preconditions.checkArgument(maxPendingPersists > 0,"FlushingPlumberSchool requires maxPendingPersists > 0");
  Preconditions.checkNotNull(flushDuration,"FlushingPlumberSchool requires a flushDuration.");
  Preconditions.checkNotNull(windowPeriod,"FlushingPlumberSchool requires a windowPeriod.");
  Preconditions.checkNotNull(basePersistDirectory,"FlushingPlumberSchool requires a basePersistDirectory.");
  Preconditions.checkNotNull(segmentGranularity,"FlushingPlumberSchool requires a segmentGranularity.");
}
