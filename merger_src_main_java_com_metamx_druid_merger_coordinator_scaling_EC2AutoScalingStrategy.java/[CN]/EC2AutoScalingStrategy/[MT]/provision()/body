{
  try {
    log.info("Creating new instance(s)...");
    RunInstancesResult result=amazonEC2Client.runInstances(new RunInstancesRequest(config.getAmiId(),config.getMinNumInstancesToProvision(),config.getMaxNumInstancesToProvision()).withInstanceType(InstanceType.fromValue(config.getInstanceType())));
    List<String> instanceIds=Lists.transform(result.getReservation().getInstances(),new Function<Instance,String>(){
      @Override public String apply(      @Nullable Instance input){
        return input.getInstanceId();
      }
    }
);
    log.info("Created instances: %s",instanceIds);
    return new AutoScalingData<Instance>(Lists.transform(result.getReservation().getInstances(),new Function<Instance,String>(){
      @Override public String apply(      @Nullable Instance input){
        return String.format("%s:%s",input.getPrivateIpAddress(),config.getWorkerPort());
      }
    }
),result.getReservation().getInstances());
  }
 catch (  Exception e) {
    log.error(e,"Unable to provision any EC2 instances.");
  }
  return null;
}
