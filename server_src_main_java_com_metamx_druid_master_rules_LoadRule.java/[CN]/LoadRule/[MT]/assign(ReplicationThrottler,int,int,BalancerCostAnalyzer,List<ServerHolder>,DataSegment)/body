{
  final MasterStats stats=new MasterStats();
  while (totalReplicants < expectedReplicants) {
    final ServerHolder holder=analyzer.findNewSegmentHomeAssign(segment,serverHolderList);
    if (holder == null) {
      log.warn("Not enough %s servers or node capacity to assign segment[%s]! Expected Replicants[%d]",getTier(),segment.getIdentifier(),expectedReplicants);
      break;
    }
    if (totalReplicants > 0) {
      if (!replicationManager.canAddReplicant(getTier()) || !replicationManager.registerReplicantCreation(getTier(),segment.getIdentifier(),holder.getServer().getHost())) {
        break;
      }
    }
    holder.getPeon().loadSegment(segment,new LoadPeonCallback(){
      @Override protected void execute(){
        replicationManager.unregisterReplicantCreation(getTier(),segment.getIdentifier(),holder.getServer().getHost());
      }
    }
);
    stats.addToTieredStat("assignedCount",getTier(),1);
    ++totalReplicants;
  }
  return stats;
}
