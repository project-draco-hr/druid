{
  this.appenderator=Preconditions.checkNotNull(appenderator,"appenderator");
  this.segmentAllocator=Preconditions.checkNotNull(segmentAllocator,"segmentAllocator");
  this.handoffNotifier=Preconditions.checkNotNull(handoffNotifierFactory,"handoffNotifierFactory").createSegmentHandoffNotifier(appenderator.getDataSource());
  this.usedSegmentChecker=Preconditions.checkNotNull(usedSegmentChecker,"usedSegmentChecker");
  this.objectMapper=Preconditions.checkNotNull(objectMapper,"objectMapper");
  this.maxRowsPerSegment=maxRowsPerSegment;
  this.handoffConditionTimeout=handoffConditionTimeout;
}
