{
  try {
    final InputRow inputRow=firehose.nextRow();
    if (inputRow == null) {
      if (reportParseExceptions) {
        throw new ParseException("null input row");
      }
 else {
        log.debug("Discarded null input row, considering unparseable.");
        metrics.incrementUnparseable();
        return;
      }
    }
    int numRows=plumber.add(inputRow,committerSupplier);
    if (numRows == -1) {
      metrics.incrementThrownAway();
      log.debug("Discarded row[%s], considering thrownAway.",inputRow);
      return;
    }
    metrics.incrementProcessed();
  }
 catch (  ParseException e) {
    if (reportParseExceptions) {
      throw e;
    }
 else {
      log.debug(e,"Discarded row due to exception, considering unparseable.");
      metrics.incrementUnparseable();
    }
  }
catch (  IndexSizeExceededException e) {
    throw new ISE(e,"WTF?! Index size exceeded, this shouldn't happen. Bad Plumber!");
  }
}
