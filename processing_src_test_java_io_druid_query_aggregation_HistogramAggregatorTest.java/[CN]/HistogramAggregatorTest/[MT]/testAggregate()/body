{
  final float[] values={0.55f,0.27f,-0.3f,-.1f,-0.8f,-.7f,-.5f,0.25f,0.1f,2f,-3f};
  final float[] breaks={-1f,-0.5f,0.0f,0.5f,1f};
  final TestFloatColumnSelector selector=new TestFloatColumnSelector(values);
  HistogramAggregator agg=new HistogramAggregator("billy",selector,breaks);
  Assert.assertEquals("billy",agg.getName());
  Assert.assertArrayEquals(new long[]{0,0,0,0,0,0},((Histogram)agg.get()).bins);
  Assert.assertArrayEquals(new long[]{0,0,0,0,0,0},((Histogram)agg.get()).bins);
  Assert.assertArrayEquals(new long[]{0,0,0,0,0,0},((Histogram)agg.get()).bins);
  aggregate(selector,agg);
  Assert.assertArrayEquals(new long[]{0,0,0,0,1,0},((Histogram)agg.get()).bins);
  Assert.assertArrayEquals(new long[]{0,0,0,0,1,0},((Histogram)agg.get()).bins);
  Assert.assertArrayEquals(new long[]{0,0,0,0,1,0},((Histogram)agg.get()).bins);
  aggregate(selector,agg);
  Assert.assertArrayEquals(new long[]{0,0,0,1,1,0},((Histogram)agg.get()).bins);
  Assert.assertArrayEquals(new long[]{0,0,0,1,1,0},((Histogram)agg.get()).bins);
  Assert.assertArrayEquals(new long[]{0,0,0,1,1,0},((Histogram)agg.get()).bins);
  aggregate(selector,agg);
  Assert.assertArrayEquals(new long[]{0,0,1,1,1,0},((Histogram)agg.get()).bins);
  aggregate(selector,agg);
  Assert.assertArrayEquals(new long[]{0,0,2,1,1,0},((Histogram)agg.get()).bins);
  aggregate(selector,agg);
  Assert.assertArrayEquals(new long[]{0,1,2,1,1,0},((Histogram)agg.get()).bins);
  aggregate(selector,agg);
  Assert.assertArrayEquals(new long[]{0,2,2,1,1,0},((Histogram)agg.get()).bins);
  aggregate(selector,agg);
  Assert.assertArrayEquals(new long[]{0,3,2,1,1,0},((Histogram)agg.get()).bins);
  aggregate(selector,agg);
  Assert.assertArrayEquals(new long[]{0,3,2,2,1,0},((Histogram)agg.get()).bins);
  aggregate(selector,agg);
  Assert.assertArrayEquals(new long[]{0,3,2,3,1,0},((Histogram)agg.get()).bins);
  aggregate(selector,agg);
  Assert.assertArrayEquals(new long[]{0,3,2,3,1,1},((Histogram)agg.get()).bins);
  aggregate(selector,agg);
  Assert.assertArrayEquals(new long[]{1,3,2,3,1,1},((Histogram)agg.get()).bins);
}
