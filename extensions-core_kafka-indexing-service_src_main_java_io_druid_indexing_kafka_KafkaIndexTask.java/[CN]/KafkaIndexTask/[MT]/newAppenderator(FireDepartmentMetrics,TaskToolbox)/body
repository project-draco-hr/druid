{
  return Appenderators.createRealtime(dataSchema,tuningConfig.withBasePersistDirectory(new File(toolbox.getTaskWorkDir(),"persist")),metrics,toolbox.getSegmentPusher(),toolbox.getObjectMapper(),toolbox.getIndexIO(),tuningConfig.getBuildV9Directly() ? toolbox.getIndexMergerV9() : toolbox.getIndexMerger(),toolbox.getQueryRunnerFactoryConglomerate(),toolbox.getSegmentAnnouncer(),toolbox.getEmitter(),toolbox.getQueryExecutorService(),toolbox.getCache(),toolbox.getCacheConfig());
}
