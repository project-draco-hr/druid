{
  Server server=findServer(query);
  if (server == null) {
    log.makeAlert("Catastrophic failure! No servers found for default broker [%s]!",tierConfig.getDefaultBrokerServiceName()).emit();
    return Sequences.empty();
  }
  QueryRunner<T> client=new DirectDruidClient<T>(warehouse,objectMapper,httpClient,server.getHost());
  return client.run(query);
}
