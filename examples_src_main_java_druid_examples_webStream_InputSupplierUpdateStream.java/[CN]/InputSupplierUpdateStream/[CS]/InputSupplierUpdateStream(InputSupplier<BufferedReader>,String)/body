{
  addToQueueThread=new Thread(){
    public void run(){
      while (!isInterrupted()) {
        try {
          BufferedReader reader=supplier.getInput();
          String line;
          while ((line=reader.readLine()) != null) {
            if (isValid(line)) {
              HashMap<String,Object> map=mapper.readValue(line,typeRef);
              if (map.get(timeDimension) != null) {
                queue.offer(map,queueWaitTime,TimeUnit.SECONDS);
                log.debug("Successfully added to queue");
              }
 else {
                log.error("missing timestamp");
              }
            }
          }
        }
 catch (        Exception e) {
          throw Throwables.propagate(e);
        }
      }
    }
  }
;
  addToQueueThread.setDaemon(true);
  this.supplier=supplier;
  this.typeRef=new TypeReference<HashMap<String,Object>>(){
  }
;
  this.timeDimension=timeDimension;
}
